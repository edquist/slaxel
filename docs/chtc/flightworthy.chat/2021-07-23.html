<!DOCTYPE html>
<html>
<head>
<title>Fri Jul 23, 2021 : #flightworthy (chtc)</title>
</head>
<body>
<h3>Fri Jul 23, 2021 : #flightworthy (chtc)</h3>
<span style="color: #99a949"><span style="font-size: small">(10:23:53)</span> <b>matyas:</b></span> @jfrey we're planning a Kubernetes network update that would cause our CEs to lose network for about an hour. Will running jobs be affected? Will it be able to pick up where it left off once network is back?<br/>
<span style="color: #4cc091"><span style="font-size: small">(10:25:21)</span> <b>blin:</b></span> ^^ these are Hosted CEs so they're using Bosco<br/>
<span style="color: #99a949"><span style="font-size: small">(10:26:33)</span> <b>matyas:</b></span> ah good point, so the ssh connections will die too<br/>
<span style="color: #9b3b45"><span style="font-size: small">(11:27:16)</span> <b>jfrey:</b></span> Condor should be able to recover once everything is back up. The grid universe jobs will go on hold if the gridmanager can’t establish a new ssh connection for restarting the blahp.<br/>
<span style="color: #684b6c"><span style="font-size: small">(11:30:12)</span> <b>bbockelman:</b></span> To be clear -- the network update will take about an hour.  The loss of network is expected to be a few seconds.<br/>
<span style="color: #3c989f"><span style="font-size: small">(14:15:22)</span> <b>wiscmoate:</b></span> Got five of these emails:<br/><pre>Date: Fri, 23 Jul 2021 12:58:41 -0500 (CDT)                                                                                                                                                      <br/>From: Condor User &lt;condor@cm3000.chtc.wisc.edu&gt;                                                                                                                                                  <br/>To: <a href="mailto:chtc-admin@cs.wisc.edu">chtc-admin@cs.wisc.edu</a>, <a href="mailto:tim@cs.wisc.edu">tim@cs.wisc.edu</a>, <a href="mailto:johnkn@cs.wisc.edu">johnkn@cs.wisc.edu</a>                                                                                                                                  <br/>Subject: [chtc-admin] [Condor] Problem <a href="http://cm3000.chtc.wisc.edu">cm3000.chtc.wisc.edu</a>: condor_negotiator died (11)                                                                                                         <br/><br/>This is an automated email from the Condor system<br/>on machine "<a href="http://cm3000.chtc.wisc.edu">cm3000.chtc.wisc.edu</a>".  Do not reply.<br/><br/>"/usr/sbin/condor_negotiator" on "<a href="http://cm3000.chtc.wisc.edu">cm3000.chtc.wisc.edu</a>" died due to signal 11 (Segmentation fault).<br/>Condor will automatically restart this process in 13 seconds.</pre><br/>
<span style="color: #3c989f"><span style="font-size: small">(14:16:43)</span> <b>wiscmoate:</b></span> Segfault on negotiator that's running 9.1.2-0.550476<br/>
<span style="color: #9b3b45"><span style="font-size: small">(14:40:39)</span> <b>jfrey:</b></span> Ugh. This is a bug in the our code to remove GSI proxy code.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(14:41:27)</span> <b>jfrey:</b></span> One of the the GSI functions that we still need to dlopen() isn’t being initialized.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(14:56:31)</span> <b>jfrey:</b></span> This happens on the client end of a GSI authentication attempt.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(14:56:49)</span> <b>jfrey:</b></span> It can be avoided by setting any of these parameters:<br/>
<span style="color: #9b3b45"><span style="font-size: small">(14:56:55)</span> <b>jfrey:</b></span> GSI_SKIP_HOST_CHECK=true<br/>
<span style="color: #9b3b45"><span style="font-size: small">(14:57:07)</span> <b>jfrey:</b></span> GSI_SKIP_HOST_CHECK_CERT_REGEX=&lt;regex matching server’s DN&gt;<br/>
<span style="color: #9b3b45"><span style="font-size: small">(14:57:19)</span> <b>jfrey:</b></span> GSI_DAEMON_NAME=list containing server’s DN<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:10:20)</span> <b>jfrey:</b></span> It’s a simple one-line fix.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:15:09)</span> <b>jfrey:</b></span> <b>@here</b> We have a major bug in 9.1.1/9.1.2.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:15:48)</span> <b>jfrey:</b></span> Writeup in HTCONDOR-610<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:16:59)</span> <b>johnkn:</b></span> easy fix?<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:17:06)</span> <b>jfrey:</b></span> Yes. One line.<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:17:40)</span> <b>johnkn:</b></span> I say go ahead and put it in to 9.1.1. branch<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:18:04)</span> <b>jfrey:</b></span> Do we include it in the security release?<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:18:14)</span> <b>johnkn:</b></span> is the bug in the security release?<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:18:25)</span> <b>jfrey:</b></span> Yes<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:18:33)</span> <b>jfrey:</b></span> Because it’s in 9.1.1.<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:18:43)</span> <b>johnkn:</b></span> I would say yes, but we should have Tim weigh in.<br/>
<span style="color: #bb86b7"><span style="font-size: small">(15:19:18)</span> <b>tim:</b></span> The security release is 9.1.0 based. Moate's 9.1.2 is our current 9.1.1 + security patches.<br/>
<span style="color: #bb86b7"><span style="font-size: small">(15:19:34)</span> <b>tim:</b></span> What node types are affected.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:19:56)</span> <b>jfrey:</b></span> Ah, my mistake. I thought the security release was base off of 9.1.1.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:21:17)</span> <b>jfrey:</b></span> Not as dire as I originally feared.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:21:40)</span> <b>jfrey:</b></span> I will commit to the 9.1.1 branch.<br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:21:56)</span> <b>jfrey:</b></span> All node types are affected.<br/>
<span style="color: #bb86b7"><span style="font-size: small">(15:23:14)</span> <b>tim:</b></span> I'll get the bug fix 9.1.2 to Moate on Monday.<br/>
<span style="color: #3c989f"><span style="font-size: small">(15:32:49)</span> <b>wiscmoate:</b></span> right-o<br/>
<span style="color: #235e5b"><span style="font-size: small">(17:13:12)</span> <b>johnkn:</b></span> Well this is interesting.   I grabbed the accountant log from <a href="http://ch.chtc.wisc.edu">ch.chtc.wisc.edu</a> and copied it to my desktop so I would have some realistic data for testing.   turns out this file has some bogus records like this<br/><pre>101 Customer."PathobiologicalSciences_Zamanian".mzamanian@chtc.wisc.edu * *<br/>103 Customer."PathobiologicalSciences_Zamanian".mzamanian@chtc.wisc.edu MyType "*"<br/>103 Customer."PathobiologicalSciences_Zamanian".mzamanian@chtc.wisc.edu PriorityFactor 1000.0<br/>103 Customer."PathobiologicalSciences_Zamanian".mzamanian@chtc.wisc.edu TargetType "*"<br/>103 Customer."PathobiologicalSciences_Zamanian".mzamanian@chtc.wisc.edu SubmitterLimit 0.0<br/>103 Customer."PathobiologicalSciences_Zamanian".mzamanian@chtc.wisc.edu UnchargedTime 0<br/>103 Customer."PathobiologicalSciences_Zamanian".mzamanian@chtc.wisc.edu WeightedUnchargedTime 0.0<br/>103 Customer."PathobiologicalSciences_Zamanian".mzamanian@chtc.wisc.edu SubmitterShare 0.0</pre><br/>
<span style="color: #235e5b"><span style="font-size: small">(17:13:31)</span> <b>johnkn:</b></span> It *also* has a non-bogus version of the same user<br/><pre>101 <a href="mailto:Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu">Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu</a> * *<br/>103 <a href="mailto:Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu">Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu</a> MyType "*"<br/>103 <a href="mailto:Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu">Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu</a> PriorityFactor 1000.0<br/>103 <a href="mailto:Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu">Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu</a> TargetType "*"<br/>103 <a href="mailto:Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu">Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu</a> AccumulatedUsage 783012.0<br/>103 <a href="mailto:Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu">Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu</a> WeightedResourcesUsed 0.0<br/>103 <a href="mailto:Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu">Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu</a> BeginUsageTime 1602706448<br/>103 <a href="mailto:Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu">Customer.PathobiologicalSciences_Zamanian.mzamanian@chtc.wisc.edu</a> WeightedUnchargedTime 0.0</pre><br/>
<span style="color: #9e3997"><span style="font-size: small">(17:14:12)</span> <b>tlmiller:</b></span> I wonder if that's somebody forgetting about the difference between <tt>+</tt> and non-<tt>+</tt> attributes?<br/>
<span style="color: #9e3997"><span style="font-size: small">(17:14:55)</span> <b>tlmiller:</b></span> (Also, did anyone else initially read that as "pathological sciences"?)<br/>
<span style="color: #16569E"><span style="font-size: small">(17:15:45)</span> <b>edquist:</b></span> pathological biosciences<br/>
<span style="color: #235e5b"><span style="font-size: small">(17:28:09)</span> <b>johnkn:</b></span> An other sort of interesting thing.  records in the accountant log can have  <tt>Priority</tt> and <tt>PriorityFactor</tt> attributes, but if they don't the attempt to fetch the value fills in a default  In effect the code behaves as if these attributes exist even when they don't.<br/><br/>But the <tt>Priority</tt> attribute sent to the Collector in the "Accounting" ads has value of <tt>Priority * ProrityFactor</tt><br/>
</body>
</html>
