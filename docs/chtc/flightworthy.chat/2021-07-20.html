<!DOCTYPE html>
<html>
<head>
<title>Tue Jul 20, 2021 : #flightworthy (chtc)</title>
</head>
<body>
<h3>Tue Jul 20, 2021 : #flightworthy (chtc)</h3>
<span style="color: #d58247"><span style="font-size: small">(08:44:14)</span> <b>gthain:</b></span> If I could go meta here for a bit, where should we document these things about debugging the open pool?<br/>
<span style="color: #4cc091"><span style="font-size: small">(08:54:07)</span> <b>blin:</b></span> ideally, they'd go under <a href="https://opensciencegrid.org/operations/">https://opensciencegrid.org/operations/</a> or if you want to keep it semi-private, then OSG Ops has a shared google drive<br/>
<span style="color: #684b6c"><span style="font-size: small">(09:46:14)</span> <b>bbockelman:</b></span> &gt; @blin Thanks.  For #2, who has ADMINISTRATOR authorization to the OSPool?  In HTCondor fetch_log requires ADMIN access, and by default, it would be anybody who can login to the central manager.  Do you know how it is setup in the OSPool ?<br/>You can't run <tt>fetch_log</tt> reliably.  Now, if someone would review and merge this -- <a href="https://github.com/htcondor/htcondor/pull/184">https://github.com/htcondor/htcondor/pull/184</a><br/>
<blockquote>
<span style="color: #5a4592"><span style="font-size: small">(12:42:59)</span> <b>tannenba:</b></span> @bbockelman @blin So PR #184 is wonderful new mechanism that simplifies the setup, but does that mean there is nothing configured today in the OSPool to to allow an operator or developer to contact a startd with admin (or read, or write) authorization?<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:43:13)</span> <b>tannenba:</b></span> How can I run fetch_log unreliably?<br/>
<span style="color: #4cc091"><span style="font-size: small">(12:48:24)</span> <b>blin:</b></span> i'd ask Mats in the OSG slack<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:48:42)</span> <b>tannenba:</b></span> Roger that....<br/>
<span style="color: #684b6c"><span style="font-size: small">(17:02:24)</span> <b>bbockelman:</b></span> (sorry, didn't see this earlier)<br/>&gt;  but does that mean there is nothing configured today in the OSPool to to allow an operator or developer to contact a startd with admin (or read, or write) authorization?<br/>In my understanding, <tt>GSI_DAEMON_NAME</tt> is set so if you have the correct proxy and correct client-side <tt>GSI_DAEMON_NAME</tt>, you can get something working.<br/>
</blockquote>
<span style="color: #9f69e7"><span style="font-size: small">(12:38:29)</span> <b>lmichael:</b></span> So I’ve got a user (close-ish collaborator who had brought us many users) asking what options there are for automating transfers to jobs from external file servers that are set up as Globus endpoints. They recently learned that Globus no longer supports http downloads from endpoints. What are our best options in that case, if trying to avoid the step of staging the data into <tt>/public</tt> (CVMFS)?<br/>
<blockquote>
<span style="color: #9f69e7"><span style="font-size: small">(14:42:17)</span> <b>lmichael:</b></span> Buehler? @tannenba @gthain @jcpatton @bbockelman?<br/>
<span style="color: #9f69e7"><span style="font-size: small">(2021-07-22 15:05:05)</span> <b>lmichael:</b></span> “The Globus CLI has no such functionality at this time. It is possible<br/>for you to construct your own client application to do HTTPS downloads<br/>from a GCSv5.4 collection. We discuss this issue in our doc here:<br/><br/><a href="https://docs.globus.org/globus-connect-server/v5.4/https-access-collections/">https://docs.globus.org/globus-connect-server/v5.4/https-access-collections/</a><br/><br/>Please let us know if you should require additional support on this matter.”<br/>
</blockquote>
<span style="color: #5a4592"><span style="font-size: small">(13:06:02)</span> <b>tannenba:</b></span> @tim @tlmiller So.... I have been unable to install the daily RPM release from yesterday onto a virgin Centos 7 container.  So first I tried using get_htcondor, but there is no option for it... Next I looked at the docs, but nothing about our daily repo....  Finally after poking around the repos I tried the following commands:<br/><pre>yum install -y <a href="https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm">https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</a><br/>yum-config-manager --add-repo <a href="https://research.cs.wisc.edu/htcondor/repo/9.1/el7/daily">https://research.cs.wisc.edu/htcondor/repo/9.1/el7/daily</a><br/>rpm --import <a href="https://research.cs.wisc.edu/htcondor/repo/keys/HTCondor-9.1-Daily-Key">https://research.cs.wisc.edu/htcondor/repo/keys/HTCondor-9.1-Daily-Key</a><br/>yum install -y minicondor</pre><br/>
<span style="color: #5a4592"><span style="font-size: small">(13:06:26)</span> <b>tannenba:</b></span> The above failed with the message <tt>Public key for condor-boinc-7.16.16-1.el7.x86_64.rpm is not installed</tt><br/>
<span style="color: #5a4592"><span style="font-size: small">(13:06:54)</span> <b>tannenba:</b></span> Any thoughts?<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:08:03)</span> <b>tlmiller:</b></span> (a) get_htcondor is specifically _not_ supposed to work with our daily repo.<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:08:26)</span> <b>tlmiller:</b></span> (b) the daily repo is specifically undocumented, since we don't want anyone using it<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:09:12)</span> <b>tlmiller:</b></span> (c) ask TimT if that's really the right key?<br/>
<span style="color: #5a4592"><span style="font-size: small">(13:13:59)</span> <b>tannenba:</b></span> Thanks @tlmiller.   After installing every key in htcondor/repo/keys, I was able to make it work.<br/>
<span style="color: #99a949"><span style="font-size: small">(13:14:01)</span> <b>matyas:</b></span> is there any secret documentation in case, say, OSG wants to use the daily repo for something?<br/>
<span style="color: #5a4592"><span style="font-size: small">(13:14:40)</span> <b>tannenba:</b></span> Which key was the "magic" key out of the five keys there, I have no idea.<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:14:43)</span> <b>tlmiller:</b></span> That probably means the automation needs fixing to make sure it uses the right key?  (I assume that <tt>condor-boinc</tt> is the first package it tried to install?)<br/>
<span style="color: #5a4592"><span style="font-size: small">(13:15:00)</span> <b>tannenba:</b></span> Yes, condor-boinc was the first one it tried....<br/>
<span style="color: #99a949"><span style="font-size: small">(13:17:23)</span> <b>matyas:</b></span> is there a daily build for condor-boinc?<br/>
<span style="color: #99a949"><span style="font-size: small">(13:18:29)</span> <b>matyas:</b></span> if we have a separate key for daily vs non-daily then we need to make sure that every condor RPM that has a non-daily build also has a daily build<br/>
<span style="color: #99a949"><span style="font-size: small">(13:19:07)</span> <b>matyas:</b></span> unless it's OK to require people to import both keys<br/>
<span style="color: #99a949"><span style="font-size: small">(13:20:19)</span> <b>matyas:</b></span> which is kinda annoying if you're fetching the key from http. Whatever happened to the "condor-release" RPM that contained all the condor .repo files and keys?<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:20:57)</span> <b>tlmiller:</b></span> Probably doesn't exist for the dailies?<br/>
<span style="color: #99a949"><span style="font-size: small">(13:21:34)</span> <b>matyas:</b></span> it doesn't need to, it just needs to contain the .repo file and the keys for all the repos<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:22:28)</span> <b>tlmiller:</b></span> I _thought_ the RPM I'm familiar with was actually condor-stable.rpm, so that you could install that and get the stable branch, or condor-current.rpm, etc.<br/>
<span style="color: #99a949"><span style="font-size: small">(13:23:29)</span> <b>matyas:</b></span> hang on...<br/><pre>yum -y install <a href="https://research.cs.wisc.edu/htcondor/repo/9.1/htcondor-release-current.el7.noarch.rpm">https://research.cs.wisc.edu/htcondor/repo/9.1/htcondor-release-current.el7.noarch.rpm</a><br/>rpm --import /etc/pki/rpm-gpg/*</pre><br/>then if you want to install stuff from dailies<br/><pre>yum -y install condor --enablerepo=htcondor-daily</pre><br/><br/>
<span style="color: #9e3997"><span style="font-size: small">(13:24:07)</span> <b>tlmiller:</b></span> ... that works?  That's pretty cool, actually.<br/>
<span style="color: #99a949"><span style="font-size: small">(13:24:31)</span> <b>matyas:</b></span> yeah it took a while to figure out the paths<br/>
<span style="color: #5a4592"><span style="font-size: small">(13:27:32)</span> <b>tannenba:</b></span> @matyas Much nicer than what I did!  So I put this here:  <a href="https://htcondor-wiki.cs.wisc.edu/index.cgi/wiki?p=InstallDailyNativePackage">https://htcondor-wiki.cs.wisc.edu/index.cgi/wiki?p=InstallDailyNativePackage</a><br/>
<span style="color: #99a949"><span style="font-size: small">(13:28:02)</span> <b>matyas:</b></span> sounds good<br/>
<span style="color: #bb86b7"><span style="font-size: small">(13:37:45)</span> <b>tim:</b></span> You don't even need the rpm --import. yum will do it automatically for you.<br/>
<span style="color: #bb86b7"><span style="font-size: small">(13:39:45)</span> <b>tim:</b></span> There may have been a time when multiple keys were needed. I had the mistaken belief that one could have multiple signatures on an RPM. However, there can be only one. So, the RPM signing key did not always match the repo. But, now they all should. I can double check them all.<br/>
<span style="color: #684b6c"><span style="font-size: small">(15:12:08)</span> <b>bbockelman:</b></span> @tim - you're right, the <tt>rpm --import</tt> is not needed.  Here are the keys that were imported from a fresh container:<br/><pre>Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7<br/>Importing GPG key 0x352C64E5:<br/> Userid     : "Fedora EPEL (7) &lt;epel@fedoraproject.org&gt;"<br/> Fingerprint: 91e9 7d7c 4a5e 96f1 7f3e 888f 6a2f aea2 352c 64e5<br/> Package    : epel-release-7-11.noarch (@extras)<br/> From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7<br/>Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-HTCondor-9.1<br/>Importing GPG key 0x6D4CA7CD:<br/> Userid     : "HTCondor 9.1 Key (Signing Key) &lt;htcondor-admin@cs.wisc.edu&gt;"<br/> Fingerprint: fb74 57aa 32cc a224 cbdc a6d7 6ea3 2eb8 6d4c a7cd<br/> Package    : htcondor-release-9.1-1.el7.noarch (@/htcondor-release-current.el7.noarch)<br/> From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-HTCondor-9.1<br/>Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-HTCondor-9.1-Daily<br/>Importing GPG key 0xEC836AA7:<br/> Userid     : "HTCondor 9.1 Daily Key (Signing Key) &lt;htcondor-admin@cs.wisc.edu&gt;"<br/> Fingerprint: f6ed 308c 5a4d 98a0 db52 c21f 2797 e475 ec83 6aa7<br/> Package    : htcondor-release-9.1-1.el7.noarch (@/htcondor-release-current.el7.noarch)<br/> From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-HTCondor-9.1-Daily</pre><br/>EPELL, HTCondor-9.1, and HTCondor-9.1-Daily.<br/>
<span style="color: #684b6c"><span style="font-size: small">(15:15:10)</span> <b>bbockelman:</b></span> However, it appears the condor-boinc RPM is not signed with the right key.<br/>
<span style="color: #bb86b7"><span style="font-size: small">(15:15:31)</span> <b>tim:</b></span> OK. I'll fix it.<br/>
<span style="color: #684b6c"><span style="font-size: small">(15:15:51)</span> <b>bbockelman:</b></span> This fails out with signature issues on a fresh Docker container:<br/><pre>yum install condor --enablerepo=htcondor-daily --disablerepo=htcondor</pre><br/>I'm guessing condor-boinc is signed with the production key?<br/>
<span style="color: #bb86b7"><span style="font-size: small">(15:16:26)</span> <b>tim:</b></span> Probably. Like I said before, I thought I could put multiple signatures on an RPM.<br/>
<span style="color: #684b6c"><span style="font-size: small">(15:17:06)</span> <b>bbockelman:</b></span> Reproducer:<br/><pre>yum -y install <a href="https://research.cs.wisc.edu/htcondor/repo/9.1/htcondor-release-current.el7.noarch.rpm">https://research.cs.wisc.edu/htcondor/repo/9.1/htcondor-release-current.el7.noarch.rpm</a><br/>yum -y install condor --enablerepo=htcondor-daily --disablerepo=htcondor</pre><br/><br/>
<span style="color: #bb86b7"><span style="font-size: small">(20:41:26)</span> <b>tim:</b></span> I fixed this earlier today.<br/>
</body>
</html>
