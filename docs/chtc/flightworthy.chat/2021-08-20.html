<!DOCTYPE html>
<html>
<head>
<title>Fri Aug 20, 2021 : #flightworthy (chtc)</title>
</head>
<body>
<h3>Fri Aug 20, 2021 : #flightworthy (chtc)</h3>
<span style="color: #99a949"><span style="font-size: small">(12:06:56)</span> <b>matyas:</b></span> I see a job on OSG with<br/><pre>OnExitRemove = NumJobCompletions &gt; JobMaxRetries || ExitCode =?= JobSuccessExitCode</pre><br/>which I gather is a common recipe...?<br/><br/>Is it supposed to work? I see no ExitCode in the job ad.<br/>
<span style="color: #99a949"><span style="font-size: small">(12:09:02)</span> <b>matyas:</b></span> (The job was running (a second time) when I checked, if that changes things)<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:13:08)</span> <b>tannenba:</b></span> Hi @matyas - The above was annoying to everyone, which is why it was fixed in yesterday's release.  From the v9.0.5 Version history at <a href="https://htcondor.readthedocs.io/en/v9_0/version-history/stable-release-series-90.html#version-9-0-5">https://htcondor.readthedocs.io/en/v9_0/version-history/stable-release-series-90.html#version-9-0-5</a> :<br/>The job attribute <tt>ExitCode</tt> is no longer missing from the job ad after <tt>OxExitHold</tt> triggers. <a href="https://opensciencegrid.atlassian.net/browse/HTCONDOR-599">(Ticket #599)</a><br/>
<span style="color: #99a949"><span style="font-size: small">(12:14:39)</span> <b>matyas:</b></span> hah, perfect :slightly_smiling_face:<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:14:48)</span> <b>tannenba:</b></span> I now see you are talking about OnExitRemove, not OnExitHold... hopefully ticket 599 fixes both (my guess is it does)<br/>
<span style="color: #99a949"><span style="font-size: small">(12:15:00)</span> <b>matyas:</b></span> but the expression still works?<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:15:44)</span> <b>tannenba:</b></span> The expressions always did the right thing, the problem was <tt>ExitCode</tt> did not always appear in the held job and/or the history file ad<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:18:44)</span> <b>tannenba:</b></span> @tim Hi Tim, is there a new ETA for when the v9.0.5/v9.1.3 releases will be completed?<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:19:43)</span> <b>tannenba:</b></span> It was Weds, then Thurs, and now it is Friday.... an our policy is we never make new releases on a Friday, which is why I am concerned it has lapsed for days....<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:23:33)</span> <b>tannenba:</b></span> After a few minutes of poking around, it looks like we still need a release announcement on <a href="http://htcondor.org">htcondor.org</a> and updated Docker Hub images....  and of course the release punchlist on condor-wiki :wink:.  Is the issue that the release punchlist is now so long it cannot be performed in one full workday and thus spills over into multiple days?  It is disconcerting to see a release announcement on htcondor-world, and then no mention of the new release on the web...  and doing a docker pull and I still get old images....<br/>
<span style="color: #bb86b7"><span style="font-size: small">(13:54:45)</span> <b>tim:</b></span> 2021-08-19 16:29<br/>
<span style="color: #bb86b7"><span style="font-size: small">(13:55:20)</span> <b>tim:</b></span> I pushed Docker Hub images yesterday. I'll take a look.<br/>
<span style="color: #bb86b7"><span style="font-size: small">(13:57:08)</span> <b>tim:</b></span> I just checked Docker Hub. It claims that the 9.0.5 and 9.1.3 images were pushed 21 hours ago.<br/>
<span style="color: #99a949"><span style="font-size: small">(14:01:53)</span> <b>matyas:</b></span> I see htcondor/base:9.1.3-el7 in there but htcondor/base:el7 is still 9.1.2<br/>
<span style="color: #99a949"><span style="font-size: small">(14:02:09)</span> <b>matyas:</b></span> what was the command line you used for the 9.1.3 images?<br/>
<span style="color: #bb86b7"><span style="font-size: small">(14:07:53)</span> <b>tim:</b></span> Is there a way to get a new 9.0-el7 tag?<br/>
<span style="color: #bb86b7"><span style="font-size: small">(14:09:11)</span> <b>tim:</b></span> Or do we only support the containers with the current series, not the stable series.<br/>
<span style="color: #684b6c"><span style="font-size: small">(14:12:15)</span> <b>bbockelman:</b></span> [Why on earth are humans pushing and tagging things?]<br/>
<span style="color: #bb86b7"><span style="font-size: small">(14:17:18)</span> <b>tim:</b></span> The build-images script invoked with the --push option handles it all.<br/>
<span style="color: #99a949"><span style="font-size: small">(14:20:00)</span> <b>matyas:</b></span> problem is if you do something like <tt>build-images --version 9.1.3 --push</tt>  then it pushes the tags for 9.1.3 but does not push the versionless tags (because it has no way of knowing that 9.1.3 is the "latest" htcondor)<br/>
<span style="color: #99a949"><span style="font-size: small">(14:21:15)</span> <b>matyas:</b></span> next time you should do <tt>build-images --series=9.1 --push</tt> instead<br/>
<span style="color: #bb86b7"><span style="font-size: small">(14:27:19)</span> <b>tim:</b></span> Does the series option also push a generic <tt>el7</tt> tag without any version information?<br/>
<span style="color: #99a949"><span style="font-size: small">(14:31:58)</span> <b>matyas:</b></span> Looks like no. Do you want it to ?<br/>
<span style="color: #99a949"><span style="font-size: small">(14:32:26)</span> <b>matyas:</b></span> (It pushes to the generic el7 tag if you do <tt>--series=latest</tt> or omit both <tt>--series</tt> and <tt>--version</tt>)<br/>
<span style="color: #5a4592"><span style="font-size: small">(14:33:22)</span> <b>tannenba:</b></span> @tim @matyas Ok, I just tried again and the Docker image was updated.  So Tim, did you update the release punchlist with Mat's wisdom (which apparently solved the issue) ?    And agree with BrianB, one reason I want the punchlist on the wiki is I then want to start automating each item on the list...  seems like this should be completely automated based on whenever you tag a release (or mark a release on github, or ....)<br/>
<span style="color: #bb86b7"><span style="font-size: small">(14:35:35)</span> <b>tim:</b></span> I don't want it to push a generic tag for the 9.0 series. I didn't want it to overwrite the current <tt>el7</tt> tag.<br/>
<span style="color: #3c989f"><span style="font-size: small">(14:57:38)</span> <b>wiscmoate:</b></span> Question 1) I would like to turn up <tt>&lt;SUBSYS&gt;_DEBUG</tt> on the <tt>condor_credd</tt>, but I don't see a respective <tt>$(SUBSYSTEM)</tt> here -&gt; <a href="https://htcondor.readthedocs.io/en/latest/admin-manual/introduction-to-configuration.html#pre-defined-macros">https://htcondor.readthedocs.io/en/latest/admin-manual/introduction-to-configuration.html#pre-defined-macros</a>;  I presume it's just missing?<br/>
<span style="color: #3c989f"><span style="font-size: small">(15:02:29)</span> <b>wiscmoate:</b></span> Question 2) I'm seeing this in the <a href="http://submit6.chtc.wisc.edu">submit6.chtc.wisc.edu</a> (OSPool HTCondor configuration from <a href="https://github.com/opensciencegrid/ospool-access-point">opensciencegrid/ospool-access-point</a>) SchedLog, and the schedd keeps restarting:<br/><pre>08/20/21 14:57:58 Kerberos User credentials not up-to-date.  Will wait up to 250 more seconds.<br/>08/20/21 14:58:08 Kerberos User credentials not up-to-date.  Will wait up to 240 more seconds.</pre><br/>I see no trace of Kerberos configuration.  How can I stop this - I can't seem to find anything in the HTCondor manual's index to disable Kerberos.<br/>
<span style="color: #3c989f"><span style="font-size: small">(15:04:14)</span> <b>wiscmoate:</b></span> strace of <tt>condor_schedd</tt> shows:<br/><pre>write(6, "08/20/21 14:51:57 ERROR \"User credentials unavailable after 10 minutes\" at line 129 in file /var/lib/condor/execute/slot1/dir_85854/userdir/.tmpiTUT8t/BUILD/condor-9.1.3/src/condor_schedd.V6/schedd_main.cpp\n", 207) = 207<br/>rt_sigprocmask(SIG_SETMASK, ~[ILL TRAP ABRT BUS FPE KILL SEGV STOP RTMIN RT_1], NULL, 8) = 0<br/>rt_sigprocmask(SIG_BLOCK, ~[ILL TRAP ABRT BUS FPE SEGV RTMIN RT_1], ~[ILL TRAP ABRT BUS FPE KILL SEGV STOP RTMIN RT_1], 8) = 0<br/>stat("/etc/localtime", {st_dev=makedev(253, 3), st_ino=788554, st_mode=S_IFREG|0644, st_nlink=2, st_uid=0, st_gid=0, st_blksize=4096, st_blocks=8, st_size=3559, st_atime=1629409144 /* 2021-08-19T16:39:04.354757836-0500 */, st_atime_nsec=354757836, st_mtime=1611698116 /* 2021-01-26T15:55:16-0600 */, st_mtime_nsec=0, st_ctime=1629149583 /* 2021-08-16T16:33:03.311608185-0500 */, st_ctime_nsec=311608185}) = 0<br/>lseek(6, 0, SEEK_END)                   = 5144173<br/>write(6, "08/20/21 14:51:57 Clearing userlog file cache\n", 46) = 46<br/>rt_sigprocmask(SIG_SETMASK, ~[ILL TRAP ABRT BUS FPE KILL SEGV STOP RTMIN RT_1], NULL, 8) = 0<br/>close(4)                                = 0<br/>exit_group(4)                           = ?<br/>+++ exited with 4 +++</pre><br/>
<span style="color: #3c989f"><span style="font-size: small">(15:08:51)</span> <b>wiscmoate:</b></span> Looks like I lied:<br/><pre>[moate@submit6 hello_ospool.0]$ condor_config_val -dump krb<br/># Configuration from machine: <a href="http://submit6.chtc.wisc.edu">submit6.chtc.wisc.edu</a><br/><br/># Parameters with names that match krb:<br/>CREDMON_KRB = $(SBIN)/condor_credmon_krb<br/>HAVE_EXT_KRB5 = 1<br/>SEC_CREDENTIAL_DIRECTORY_KRB = $(SEC_CREDENTIAL_DIRECTORY_OAUTH)</pre><br/>
<span style="color: #3c989f"><span style="font-size: small">(15:37:41)</span> <b>wiscmoate:</b></span> Ignore Question 2<br/>
<span style="color: #3c989f"><span style="font-size: small">(15:37:46)</span> <b>wiscmoate:</b></span> All solved<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:39:04)</span> <b>tlmiller:</b></span> (1) You're probably right.  <tt>CREDD_DEBUG</tt> is in the param table, but it isn't explicitly in the code AFAICT, which probably just means that the credd's subsystem really is <tt>credd</tt>.<br/>
<span style="color: #3c989f"><span style="font-size: small">(15:42:02)</span> <b>wiscmoate:</b></span> Thanks;  I'll add it to our wiki -&gt; <a href="https://wiki.chtc.wisc.edu/wiki/HTCondor_Subsystems">https://wiki.chtc.wisc.edu/wiki/HTCondor_Subsystems</a><br/>
<span style="color: #9b3b45"><span style="font-size: small">(15:45:08)</span> <b>jfrey:</b></span> The condor_credd’s subsystem is indeed <tt>CREDD</tt>, from which all subsystem-based param names follow.<br/>
<span style="color: #235e5b"><span style="font-size: small">(17:49:41)</span> <b>johnkn:</b></span> When Tim posts announcements for releases to condor-users.  Does someone have to reply to that email to prevent it from messing with our stats?<br/>
</body>
</html>
