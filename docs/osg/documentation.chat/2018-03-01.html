<!DOCTYPE html>
<html>
<head>
<title>Thu Mar 1, 2018 : #documentation (osg)</title>
</head>
<body>
<h3>Thu Mar 1, 2018 : #documentation (osg)</h3>
<span style="color: #9e3997"><span style="font-size: small">(00:56:41)</span> <b>bbockelm:</b></span> Hey all!  Could someone fix the broken GOC link on our homepage that our program manager just pointed out.<br/>
<span style="color: #43761b"><span style="font-size: small">(09:22:58)</span> <b>blin:</b></span> @kylegross i see two twiki links on <a href="http://opensciencegrid.org">opensciencegrid.org</a>: <br/><a href="https://twiki.opensciencegrid.org/bin/view/Operations/WebHome">https://twiki.opensciencegrid.org/bin/view/Operations/WebHome</a><br/><a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy</a><br/>
<span style="color: #e0a729"><span style="font-size: small">(09:54:36)</span> <b>kylegross:</b></span> ok, just got out of a WLCG meeting... I'll get to it asap<br/>
<span style="color: #a63024"><span style="font-size: small">(12:11:51)</span> <b>efajardo:</b></span> Good morning<br/>
<span style="color: #43761b"><span style="font-size: small">(13:05:14)</span> <b>blin:</b></span> LET'S GET READY TO FOCUSSSSSSSSSS<br/>
<span style="color: #43761b"><span style="font-size: small">(13:05:30)</span> <b>blin:</b></span> :boxing_glove::boxing_glove:<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:25:17)</span> <b>dweitzel:</b></span> does anyone know where "<a href="mailto:help@opensciencegrid.org">help@opensciencegrid.org</a>" goes?  @kylegross<br/>
<span style="color: #43761b"><span style="font-size: small">(13:27:30)</span> <b>blin:</b></span> the goc gets it<br/>
<span style="color: #43761b"><span style="font-size: small">(13:27:42)</span> <b>blin:</b></span> one way or another<br/>
<span style="color: #c386df"><span style="font-size: small">(13:39:16)</span> <b>matyas:</b></span> yo, the xrootd install docs assume your data is going to be in <tt>/data/xrootdfs</tt> but they don't tell you to make that directory or what permissions to give it<br/>
<span style="color: #c386df"><span style="font-size: small">(13:46:26)</span> <b>matyas:</b></span> can we shove a template <tt>/etc/xrootd/auth_file</tt> with the correct permissions into the xrootd package? that way the user won't have to create it and make sure to set the permissions right<br/>
<span style="color: #43761b"><span style="font-size: small">(13:53:55)</span> <b>blin:</b></span> i don't think we can necessarily do that because the "right" permissions are up to the site<br/>
<span style="color: #43761b"><span style="font-size: small">(13:53:59)</span> <b>blin:</b></span> same with who should be in the auth file<br/>
<span style="color: #c386df"><span style="font-size: small">(13:58:26)</span> <b>matyas:</b></span> the daemons run as <tt>xrootd</tt> right? and the auth file can be comments only<br/>
<span style="color: #c386df"><span style="font-size: small">(14:02:12)</span> <b>matyas:</b></span> it's a config file so admins' changes will be kept<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:07:30)</span> <b>dweitzel:</b></span> @matyas yes to both.<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:12:57)</span> <b>dweitzel:</b></span> Build is failing: <a href="https://travis-ci.org/opensciencegrid/docs/builds/347941035">https://travis-ci.org/opensciencegrid/docs/builds/347941035</a><br/>
<span style="color: #235e5b"><span style="font-size: small">(14:13:11)</span> <b>dweitzel:</b></span> links to a ton of things are broken?<br/>
<span style="color: #43761b"><span style="font-size: small">(14:14:11)</span> <b>blin:</b></span> i just fixed that in master<br/>
<span style="color: #43761b"><span style="font-size: small">(14:15:00)</span> <b>blin:</b></span> if you merge in/rebase on master, you should get the doc-ci-scripts update that fixes it<br/>
<span style="color: #43761b"><span style="font-size: small">(14:15:19)</span> <b>blin:</b></span> (it affects anyone using the material theme)<br/>
<span style="color: #43761b"><span style="font-size: small">(14:15:30)</span> <b>blin:</b></span> us, technology, management, all-hands, anyone else?<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:24:55)</span> <b>dweitzel:</b></span> Still broken links to <a href="http://fuse.sourceforge.net">fuse.sourceforge.net</a><br/>
<span style="color: #43761b"><span style="font-size: small">(14:25:42)</span> <b>blin:</b></span> oh yea, the hdfs doc is undergoing a major rewrite<br/>
<span style="color: #43761b"><span style="font-size: small">(14:25:47)</span> <b>blin:</b></span> so that can be ignored<br/>
<span style="color: #c386df"><span style="font-size: small">(15:09:37)</span> <b>matyas:</b></span> can you have more than one xrootd data server? if so, how does the redirector know which one to send data to?<br/>
<span style="color: #5b89d5"><span style="font-size: small">(15:22:30)</span> <b>sthapa:</b></span> yes, you can have multiple data servers<br/>
<span style="color: #5b89d5"><span style="font-size: small">(15:22:43)</span> <b>sthapa:</b></span> I think it round robins it so that the usage is balanced<br/>
<span style="color: #c386df"><span style="font-size: small">(15:23:25)</span> <b>matyas:</b></span> but it looks like <tt>/etc/xrootd/auth_file</tt> is per-data node?<br/>
<span style="color: #c386df"><span style="font-size: small">(15:24:22)</span> <b>matyas:</b></span> so you can have data nodes with different access controls refer to the same paths?<br/>
<span style="color: #5b89d5"><span style="font-size: small">(15:25:12)</span> <b>sthapa:</b></span> I suppose, although that’d be pretty odd.  I believe that typically you just use the same file on all the data nodes<br/>
<span style="color: #5b89d5"><span style="font-size: small">(15:25:21)</span> <b>sthapa:</b></span> That’s the setup that I have on my ITB instance<br/>
<span style="color: #c386df"><span style="font-size: small">(15:25:30)</span> <b>matyas:</b></span> yeah I imagine you wouldn't do that on purpose<br/>
<span style="color: #c386df"><span style="font-size: small">(15:52:06)</span> <b>matyas:</b></span> @blin: getting this when I try to xrdcp using a voms proxy <pre><br/>xrdcp --verbose /etc/motd <a href="root://fermicloud141.fnal.gov:1094//data/xrootdfs/test1">root://fermicloud141.fnal.gov:1094//data/xrootdfs/test1</a><br/>180301 15:51:08 8006 secgsi_ParseCAlist: nothing to parse<br/>[0B/0B][100%][==================================================][0B/s]  <br/>Run: [FATAL] Auth failed</pre><br/>
<span style="color: #5b89d5"><span style="font-size: small">(16:34:49)</span> <b>sthapa:</b></span> For GSI OpenSSH, how is the lcmaps voms setup configured?<br/>
<blockquote>
<span style="color: #43761b"><span style="font-size: small">(16:40:15)</span> <b>blin:</b></span> so mat and i looked at it and it looks like you can use more or less the same instructions as gridftp + lcmaps voms<br/>
<span style="color: #43761b"><span style="font-size: small">(16:40:35)</span> <b>blin:</b></span> so install <tt>osg-configure-misc</tt> alongside it<br/>
<span style="color: #5b89d5"><span style="font-size: small">(16:40:49)</span> <b>sthapa:</b></span> okay, thanks<br/>
<span style="color: #43761b"><span style="font-size: small">(16:40:53)</span> <b>blin:</b></span> (you may need to install <tt>vo-client</tt> directly)<br/>
<span style="color: #5b89d5"><span style="font-size: small">(16:41:11)</span> <b>sthapa:</b></span> I guess I’ll need to do a test install to figure it out<br/>
<span style="color: #43761b"><span style="font-size: small">(16:41:22)</span> <b>blin:</b></span> yea, sorry, i didn't even think about that<br/>
<span style="color: #5b89d5"><span style="font-size: small">(16:41:28)</span> <b>sthapa:</b></span> np<br/>
<span style="color: #5b89d5"><span style="font-size: small">(16:41:55)</span> <b>sthapa:</b></span> I can make the major changes and then go through and figure out the lcmaps bits tomorrow<br/>
</blockquote>
<span style="color: #235e5b"><span style="font-size: small">(16:38:31)</span> <b>dweitzel:</b></span> @matyas Could it be that CA's are not installed?<br/>
<span style="color: #c386df"><span style="font-size: small">(16:39:14)</span> <b>matyas:</b></span> no we figured it out; I didn't have a service cert<br/>
<span style="color: #c386df"><span style="font-size: small">(16:40:52)</span> <b>matyas:</b></span> as a side note, when I didn't have permissions to write to the directory, the xrootd client told me <tt>Unable to create new file; file already exists.</tt> and the server wrote <tt>Unable to locate /data/xrootdfs/test1; no such file or directory</tt><br/>
<span style="color: #c386df"><span style="font-size: small">(16:41:15)</span> <b>matyas:</b></span> moral of the story: never trust xrootd's error messages<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:46:49)</span> <b>dweitzel:</b></span> interesting.  I would expect something in the log messages about permission denied.<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:47:18)</span> <b>dweitzel:</b></span> I guess it depends if the problem is the unix directory permissions, or the auth_file.<br/>
<span style="color: #c386df"><span style="font-size: small">(16:56:06)</span> <b>matyas:</b></span> ok what am I doing wrong. here's my auth_file: <pre><br/>u * /data/xrootdfs lr<br/>u = /data/xrootdfs/@=/ a<br/>u fnalgrid /data/xrootdfs/fnalgrid a<br/>u xrootd /data/xrootdfs a <br/></pre><br/>
<span style="color: #c386df"><span style="font-size: small">(16:56:14)</span> <b>matyas:</b></span> on both the redirector and the data node<br/>
<span style="color: #c386df"><span style="font-size: small">(16:56:27)</span> <b>matyas:</b></span> I am getting authed as fnalgrid -- that's what xrootd.log says<br/>
<span style="color: #c386df"><span style="font-size: small">(16:57:10)</span> <b>matyas:</b></span> and running <tt>xrdcp --verbose /etc/motd <a href="root://fermicloud141.fnal.gov:1094//data/xrootdfs/fnalgrid/test2">root://fermicloud141.fnal.gov:1094//data/xrootdfs/fnalgrid/test2</a></tt><br/>
<span style="color: #c386df"><span style="font-size: small">(16:57:25)</span> <b>matyas:</b></span> all directories are owned by <tt>xrootd:xrootd</tt><br/>
<span style="color: #c386df"><span style="font-size: small">(16:58:11)</span> <b>matyas:</b></span> and I'm getting <tt>Run: [ERROR] Server responded with an error: [3011] Unable to create new file; file already exists.</tt><br/>
<span style="color: #c386df"><span style="font-size: small">(16:58:16)</span> <b>matyas:</b></span> (the file does not exist)<br/>
<span style="color: #235e5b"><span style="font-size: small">(17:04:59)</span> <b>dweitzel:</b></span> hum, xrootd isn't used for writing very much.  Almost 0% in CMS at least.<br/>
<span style="color: #235e5b"><span style="font-size: small">(17:05:02)</span> <b>dweitzel:</b></span> let me look around.<br/>
<span style="color: #c386df"><span style="font-size: small">(17:06:00)</span> <b>matyas:</b></span> sure. redirector is <a href="http://fermicloud141.fnal.gov">fermicloud141.fnal.gov</a>; data node is <a href="http://fermicloud306.fnal.gov">fermicloud306.fnal.gov</a><br/>
<span style="color: #235e5b"><span style="font-size: small">(17:06:41)</span> <b>dweitzel:</b></span> From the verbose output, can you tell that that the redirector is redirecting?<br/>
<span style="color: #235e5b"><span style="font-size: small">(17:07:49)</span> <b>dweitzel:</b></span> (you may also have to do a <tt> -d 2</tt> on the command line to xrdcp<br/>
<span style="color: #235e5b"><span style="font-size: small">(17:07:53)</span> <b>dweitzel:</b></span> (Debug lvl 2)<br/>
<span style="color: #c386df"><span style="font-size: small">(17:09:19)</span> <b>matyas:</b></span> looks like it is. i see both hostnames in the debug output<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:11:28)</span> <b>sthapa:</b></span> Aren’t the 2nd and 3rd lines in your auth redundant?  When you get authed, shouldn’t the 2nd line be equivalent to the 3rd?<br/>
<span style="color: #c386df"><span style="font-size: small">(17:11:44)</span> <b>matyas:</b></span> yeah I think they are<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:12:11)</span> <b>sthapa:</b></span> maybe try without the 3rd line in case it’s confusing xrootd?<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:12:23)</span> <b>sthapa:</b></span> Here’s what I have in my install:<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:12:41)</span> <b>sthapa:</b></span> @sthapa uploaded a file: <a href="https://opensciencegrid.slack.com/files/U04GGLEEV/F9GNSJT97/-.txt">Untitled</a><br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:13:26)</span> <b>sthapa:</b></span> That works as far as reading and writing, it looks pretty much the same as yours with the exception of the root entry<br/>
<span style="color: #c386df"><span style="font-size: small">(17:13:38)</span> <b>matyas:</b></span> ok; removed the third line on both machines and restarted xrootd on both machines. same result<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:16:34)</span> <b>sthapa:</b></span> not sure what else might be wrong, maybe copying my authfile with the appropriate changes and see if that works?  There might be an issue with your xrootd config that’s causing the problem<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:17:03)</span> <b>sthapa:</b></span> what’s your clustered config like?<br/>
<span style="color: #c386df"><span style="font-size: small">(17:18:39)</span> <b>matyas:</b></span> <pre>all.export /data/xrootdfs stage<br/>set xrdr = <a href="http://fermicloud141.fnal.gov">fermicloud141.fnal.gov</a><br/><br/>if $(xrdr)<br/>    all.role manager<br/>else<br/>    all.role server<br/>    <a href="http://cms.space">cms.space</a> min 2m 5m<br/>fi<br/><br/>all.manager $(xrdr) 3121<br/><br/>frm.xfr.copycmd /bin/cp /dev/null $PFN<br/><br/>all.adminpath /var/spool/xrootd<br/>all.pidpath /var/run/xrootd<br/><br/><br/>xrootd.seclib /usr/lib64/libXrdSec-4.so<br/>sec.protocol /usr/lib64 gsi -certdir:/etc/grid-security/certificates -cert:/etc/grid-security/xrootd/xrootdcert.pem \<br/>                    -key:/etc/grid-security/xrootd/xrootdkey.pem -crl:1 \<br/>                    -authzfun:libXrdLcmaps.so -authzfunparms:--loglevel,0 \<br/>                    -gmapopt:10 -gmapto:0<br/>acc.authdb /etc/xrootd/auth_file<br/>ofs.authorize</pre><br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:20:51)</span> <b>sthapa:</b></span> Not sure if this affects things, but I think you should have     xrd.port 1094 under the all.role manager<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:21:26)</span> <b>sthapa:</b></span> but other than that I don’t see anything that looks wrong<br/>
<span style="color: #c386df"><span style="font-size: small">(17:24:32)</span> <b>matyas:</b></span> I think if the manager were on a different port, the copy wouldn't have gotten as far as it did<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:25:13)</span> <b>sthapa:</b></span> yeah, probably not, but aside from auth methods, that’s the only difference from my xrootd install<br/>
<span style="color: #5b89d5"><span style="font-size: small">(17:25:27)</span> <b>sthapa:</b></span> well, that and I’m using  CNS<br/>
</body>
</html>
