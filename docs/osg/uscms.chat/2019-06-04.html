<!DOCTYPE html>
<html>
<head>
<title>Tue Jun 4, 2019 : #uscms (osg)</title>
</head>
<body>
<h3>Tue Jun 4, 2019 : #uscms (osg)</h3>
<span style="color: #9e3997"><span style="font-size: small">(08:33:29)</span> <b>bbockelm:</b></span> @andrew.melo - how's the DigiCert battle going?<br/>
<span style="color: #7d414c"><span style="font-size: small">(09:23:52)</span> <b>bockjoo:</b></span> OSG used to run its own IGTF CA. Is it not feasible for USCMS or CMS to run an IGTF CA? Do you know @bbockelm? We don't need Bank-Grade certificates.<br/>
<span style="color: #a72f79"><span style="font-size: small">(09:45:48)</span> <b>andrew.melo:</b></span> @bbockelm not terrific. It's apparently pinging around their dev group, but their first response wasn't encouraging. I told them their response was dumb and they're checking again<br/><pre><br/>"Vanderbilt needs to contact the owner of the Grid system they are connecting (Geant) to and ask them to either update the connection requirements to accept VB's cert or ask that Geant provide them a grid cert that matches the reqs on Geant's Grid system.<br/> <br/>It seems that they are connecting to a grid system that has the right certificate type but not authorized properly.<br/>Thats why its not failing to authenticate properly."<br/></pre><br/>
<span style="color: #9e3997"><span style="font-size: small">(10:06:00)</span> <b>bbockelm:</b></span> @bockjoo - the compliance cost for running a CA is around $250k / yr.  These things are pretty manpower-intensive because they are setup for user certificates (authenticating people) and not the level of assurance needed for host certificates.<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:08:42)</span> <b>bbockelm:</b></span> Answering your above question - FNAL did run its own CA for many years but never had the budget to get it certified.<br/>
<span style="color: #7d414c"><span style="font-size: small">(10:09:50)</span> <b>bockjoo:</b></span> If you give me that money, I can manage a ca with much less cost and I can still make profit I think. Lol<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:12:47)</span> <b>bbockelm:</b></span> @andrew.melo - would it help to point them here: <a href="http://www.digicert-grid.com/GridCLASSICprofiles.pdf">http://www.digicert-grid.com/GridCLASSICprofiles.pdf</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(10:13:38)</span> <b>bbockelm:</b></span> page 4 states the exact DN structure it's supposed to have for host certs.<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:17:18)</span> <b>bbockelm:</b></span> It looks like they are flipping the wrong bits and signing with the CA for Terena: <a href="https://www.terena.org/activities/tcs/">https://www.terena.org/activities/tcs/</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(10:19:14)</span> <b>bbockelm:</b></span> They were also the underlying CA for the Terena CA:<br/><pre><br/>$ openssl x509 -in /etc/grid-security/certificates/1db3b27f.0 -noout -text<br/>Certificate:<br/>    Data:<br/>        Version: 3 (0x2)<br/>        Serial Number:<br/>            0c:b6:a0:be:50:0e:3f:a4:06:b5:75:70:0e:0f:fe:6c<br/>    Signature Algorithm: sha256WithRSAEncryption<br/>        Issuer: C=US, O=DigiCert Inc, OU=<a href="http://www.digicert.com">www.digicert.com</a>, CN=DigiCert Assured ID Root CA<br/>        Validity<br/>            Not Before: Nov 18 12:00:00 2014 GMT<br/>            Not After : Nov 18 12:00:00 2024 GMT<br/>        Subject: C=NL, ST=Noord-Holland, L=Amsterdam, O=TERENA, CN=TERENA eScience SSL CA 3<br/></pre><br/>
<span style="color: #9e3997"><span style="font-size: small">(10:20:20)</span> <b>bbockelm:</b></span> So maybe you just ask that they sign for profile A with CA A or profile B with CA B.  Right now they are basically doing profile A with CA B.<br/>
<span style="color: #a72f79"><span style="font-size: small">(10:24:07)</span> <b>andrew.melo:</b></span> Well, we don't accept Terena in the certificate store anyway, so it would have to be the other one<br/>
<span style="color: #a72f79"><span style="font-size: small">(10:25:14)</span> <b>andrew.melo:</b></span> oh wait<br/>
<span style="color: #a72f79"><span style="font-size: small">(10:25:23)</span> <b>andrew.melo:</b></span> I need to grep -i ..<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:26:36)</span> <b>bbockelm:</b></span> yup yup<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:26:55)</span> <b>bbockelm:</b></span> Basically, DigiCert appears to run two different CAs in the IGTF.<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:27:11)</span> <b>bbockelm:</b></span> And they issued terena-style DNs from the digicert-grid CA.<br/>
<span style="color: #a72f79"><span style="font-size: small">(10:28:28)</span> <b>andrew.melo:</b></span> it's gonna not be great if I have to hit up vicki for $15k/year if digicert can't get their shit correct<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:31:53)</span> <b>andrew.melo:</b></span> I think I'm talking to a brick wall<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:32:21)</span> <b>andrew.melo:</b></span> <pre><br/>Hello Andrew,<br/><br/>Reviewing the current policy, that Terena chain is only available directly <br/>through the Geant account with DC. I have bcc'd that account owner at Geant so <br/>that she is aware of your current situation.<br/><br/>Would you like to work with GEANT directly to set up access to that account? I <br/>have also spoken with our dev team and we could set up a cert template that <br/>includes the subjectDN attributes applicable to our general use Grid CA, <br/>however I do not have an estimated ETA for that template.<br/><br/>Either way, we can certainly cancel and refund these orders as they do not <br/>meet your current needs. Please let me know how you would like to move <br/>forward.<br/></pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(12:33:03)</span> <b>andrew.melo:</b></span> although, I don't really care either way -- if geant doesn't mind signing it, then whatever<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:33:36)</span> <b>andrew.melo:</b></span> I replaced the CE with LE certs, so those at least work, and the fallback stageout @ vanderbilt goes to nebraska, (thanks, nebraska!), so stageout works<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:33:48)</span> <b>andrew.melo:</b></span> it's just xrootd and phedex transfers that are borked<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:44:09)</span> <b>andrew.melo:</b></span> @bbockelm do you know the magic openssl comand to verify a cert using <tt>/etc/grid-security/certificates</tt>? The naiive way seems to work, and I"m not sure why<br/><pre><br/>openssl verify -CApath /etc/grid-security/certificates/ /etc/grid-security/hostcert.pem<br/>/etc/grid-security/hostcert.pem: OK<br/></pre><br/>
<span style="color: #9e3997"><span style="font-size: small">(12:44:43)</span> <b>bbockelm:</b></span> Because the signing policy stuff is IGTF / GSI specific and not part of X509.<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:44:55)</span> <b>andrew.melo:</b></span> ffffffff<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:45:16)</span> <b>andrew.melo:</b></span> that might explain why part of this conversation isn't working right<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:52:54)</span> <b>bbockelm:</b></span> The crazy part of this is the signing policy stuff doesn't really apply to host certs.  It's all cruft.<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:53:27)</span> <b>andrew.melo:</b></span> yeah, but if I gotta somehow wait for the entirety of CMS to get a new signing_policy updated...<br/>
<span style="color: #a72f79"><span style="font-size: small">(12:54:31)</span> <b>andrew.melo:</b></span> I guess in the absolute worst case, one of my T2 comrades could generate some host certs for their site, point their DNS to my IPs....<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:59:36)</span> <b>bbockelm:</b></span> I was going to point out that nothing -- except Xrootd -- relies on reverse DNS anymore.<br/>
<span style="color: #a72f79"><span style="font-size: small">(13:34:18)</span> <b>andrew.melo:</b></span> I mean, I control my reverse DNS, so I can change that too if need be<br/>
<span style="color: #a72f79"><span style="font-size: small">(15:01:25)</span> <b>andrew.melo:</b></span> <pre><br/>This helped immensely. I have create a ticket to create a new template (this <br/>is how it is referenced on our side to meet the criteria outlined below) for <br/>our Grid certificates outside of the Geant profile.<br/><br/>I can't tell you how ashamed I am for taking so long to understand. Thanks for <br/>being patient with me. The tracking ID is CC-1881.<br/></pre><br/>Slightly encouraged...<br/>
</body>
</html>
