<!DOCTYPE html>
<html>
<head>
<title>Tue Jun 8, 2021 : #uscms (osg)</title>
</head>
<body>
<h3>Tue Jun 8, 2021 : #uscms (osg)</h3>
<span style="color: #de5f24"><span style="font-size: small">(19:54:03)</span> <b>justas.balcas:</b></span> Hi @gattebury @bbockelm<br/>Can you please disable TLS on Nebraska endpoints? If it is really needed - I would suggest to use a separate xrootd instances/redirector just for ligo or for cms (e.g. second xrootd process under diff port). What do you think?<br/>
<blockquote>
<span style="color: #e06b56"><span style="font-size: small">(20:15:25)</span> <b>jthiltges:</b></span> I think we're on-track to solving the TLS errors _soon_. There's a couple commits (not yet in a tagged release) that seem to be helping, and ongoing work to refine things a bit.<br/><a href="https://github.com/xrootd/xrootd/commit/9d355f6e">https://github.com/xrootd/xrootd/commit/9d355f6e</a><br/><a href="https://github.com/xrootd/xrootd/commit/f74d4531">https://github.com/xrootd/xrootd/commit/f74d4531</a><br/>
<span style="color: #de5f24"><span style="font-size: small">(20:40:00)</span> <b>justas.balcas:</b></span> 100% sure it will fix it? if not - I still suggest to disable on prod instance and have a separate test instance for testing/debugging<br/>
<span style="color: #e06b56"><span style="font-size: small">(21:53:02)</span> <b>jthiltges:</b></span> My opinion on separate instances...<br/>- It'll take a moderate amount of effort to get things configured, tested, etc. that I'd rather put toward fixing the underlying problem.<br/>- My understanding is the TLS issue has been challenging to reproduce in a test environment. I assume that even if we make a workaround for now, we'll still eventually need to get the issue fixed.<br/><br/>If we didn't have signs of progress, I'd be totally in favor of your workaround idea. I worry that if we make the problem go away, we'll lose momentum toward really fixing it.<br/>
<span style="color: #de5f24"><span style="font-size: small">(2021-06-09 08:56:17)</span> <b>justas.balcas:</b></span> and I have users giving up on cacheâ€¦<br/>
<span style="color: #e06b56"><span style="font-size: small">(2021-06-09 14:42:44)</span> <b>jthiltges:</b></span> I made a config change about 15 minutes ago (14:25 CDT) on our local redirector that might help. Could you let me know if the error rate changes?<br/>
<span style="color: #de5f24"><span style="font-size: small">(2021-06-09 15:55:40)</span> <b>justas.balcas:</b></span> <pre>[root@xrd-cache-2 ~]# cat /var/log/xrootd/xcache/xrootd.log | grep 'Failed to do TLS connect' | grep -v '<a href="http://unl.edu">unl.edu</a>' | awk '{split($2, a,":"); print a[1] " " a[2]}' | uniq -c<br/>[root@xrd-cache-2 ~]# cat /var/log/xrootd/xcache/xrootd.log | grep 'Failed to do TLS connect' | grep '<a href="http://unl.edu">unl.edu</a>' | awk '{split($2, a,":"); print a[1] " " a[2]}' | uniq -c<br/>      1 05 59<br/>      2 06 03<br/>      1 06 09<br/>      1 06 21<br/>      1 06 23<br/>      3 06 25<br/>      1 06 26<br/>      2 06 27<br/>      1 06 29<br/>      1 06 30<br/>      1 06 31<br/>      1 06 36<br/>      1 06 39<br/>      1 06 40<br/>      1 06 41<br/>      1 06 48<br/>      1 06 52<br/>      1 06 56<br/>      1 06 58<br/>      2 07 05<br/>      1 07 09<br/>      1 07 12<br/>      1 07 14<br/>      1 07 26<br/>      1 07 29<br/>      1 09 46<br/>      1 09 48<br/>      1 10 02<br/>      1 10 10<br/>      1 10 17<br/>      1 10 22<br/>      1 10 47<br/>      1 11 19<br/>      1 11 27<br/>      1 11 31<br/>      1 11 32<br/>      1 11 34<br/>      1 11 53<br/>      1 11 56<br/>      1 11 57<br/>      4 12 00<br/>      1 12 01<br/>      2 12 03<br/>      3 12 05<br/>      1 12 06<br/>      1 12 08<br/>      2 12 10<br/>      2 12 13<br/>      2 12 15<br/>      2 12 16<br/>      3 12 17<br/>      2 12 19<br/>      2 12 21<br/>      2 12 24<br/>      8 12 28<br/>      4 12 32<br/>      1 12 35<br/>      4 12 38<br/>      1 12 44<br/>      1 12 45<br/>      1 12 48<br/>      1 12 49<br/>      3 12 51<br/>      2 12 52<br/>      2 12 53<br/>      2 12 55<br/>      5 13 00<br/>      2 13 01<br/>      4 13 02<br/>      1 13 03<br/>      1 13 05<br/>      3 13 06<br/>      1 13 09<br/>      1 13 13<br/>      1 13 18<br/>      2 13 19<br/>      3 13 20<br/>      2 13 21<br/>      4 13 22<br/>      9 13 23<br/>      2 13 24<br/>      2 13 25<br/>      4 13 26<br/>      4 13 27<br/>      1 13 28<br/>      2 13 31<br/>      3 13 32<br/>      3 13 33<br/>      4 13 35<br/>      2 13 37<br/>      3 13 38<br/>      4 13 39<br/>      2 13 40<br/>      6 13 44<br/>      4 13 45<br/>      3 13 46<br/>      2 13 47<br/>     13 13 51<br/>      2 13 52<br/>      1 13 54<br/>      2 13 55</pre><br/>
<span style="color: #de5f24"><span style="font-size: small">(2021-06-09 15:57:11)</span> <b>justas.balcas:</b></span> and based on other days - does not seem to get better<br/>
<span style="color: #e06b56"><span style="font-size: small">(2021-06-09 16:14:02)</span> <b>jthiltges:</b></span> A 13:55 error seems to line up with this log entry.<br/><pre>red-gridftp4: 210609 15:55:21 327 anon.0:157@xrd-cache-2.ultralight.org XrootdResponse: sending err 3000: Invalid request data length</pre><br/>
<span style="color: #e06b56"><span style="font-size: small">(2021-06-09 16:15:08)</span> <b>jthiltges:</b></span> Matevz reported it to Andy<br/><a href="https://opensciencegrid.slack.com/archives/C113HRYUV/p1622665584022900?thread_ts=1622660111.020900&amp;cid=C113HRYUV">https://opensciencegrid.slack.com/archives/C113HRYUV/p1622665584022900?thread_ts=1622660111.020900&amp;cid=C113HRYUV</a><br/>And I suspect it was fixed here, but I wasn't in the reporting loop<br/><a href="https://github.com/xrootd/xrootd/commit/804e48cd9a0f1cee7237a19ad07e30f997bb55ff">https://github.com/xrootd/xrootd/commit/804e48cd9a0f1cee7237a19ad07e30f997bb55ff</a><br/>
<span style="color: #e06b56"><span style="font-size: small">(2021-06-09 16:20:49)</span> <b>jthiltges:</b></span> I think that's a different error than my config change was intended to fix. Has the number of <tt>Socket error encountered: [FATAL] TLS error</tt> messages changed?<br/>
<span style="color: #de5f24"><span style="font-size: small">(2021-06-09 18:48:25)</span> <b>justas.balcas:</b></span> If question is to me - no - I would say same rate of failures. (Maybe ggus is better place to keep track of this)<br/>
<span style="color: #e06b56"><span style="font-size: small">(2021-06-10 11:04:14)</span> <b>jthiltges:</b></span> Thanks much for the info. (In hindsight, that makes sense.)<br/>If you'd like to open a GGUS ticket instead, sure! It's kind of a tangle of github, email, and slack at present. I'm not sure the best way to coordinate.<br/>
<span style="color: #de5f24"><span style="font-size: small">(2021-06-10 12:12:06)</span> <b>justas.balcas:</b></span> created: <a href="https://ggus.eu/?mode=ticket_info&amp;ticket_id=152417">https://ggus.eu/?mode=ticket_info&amp;ticket_id=152417</a><br/>
<span style="color: #e06b56"><span style="font-size: small">(2021-06-10 12:12:24)</span> <b>jthiltges:</b></span> Thanks!<br/>
</blockquote>
</body>
</html>
