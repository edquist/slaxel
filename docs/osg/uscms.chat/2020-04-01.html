<!DOCTYPE html>
<html>
<head>
<title>Wed Apr 1, 2020 : #uscms (osg)</title>
</head>
<body>
<h3>Wed Apr 1, 2020 : #uscms (osg)</h3>
<span style="color: #7d414c"><span style="font-size: small">(10:34:44)</span> <b>bockjoo:</b></span> @maxi Can you check?<br/>
<span style="color: #aba727"><span style="font-size: small">(10:57:17)</span> <b>maxi:</b></span> Hi Everyone, we are having problems upgrading condor to the current version. yum upgrade ges fine, start commands do start condor and condor-ce, CE accepts jobs, but all of the stay idle<br/>
<span style="color: #7d414c"><span style="font-size: small">(10:59:40)</span> <b>bockjoo:</b></span> @maxi Are you referring to <a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a>?<br/>
<span style="color: #aba727"><span style="font-size: small">(11:00:44)</span> <b>maxi:</b></span> yes<br/>
<span style="color: #7d414c"><span style="font-size: small">(11:01:50)</span> <b>bockjoo:</b></span> HoldReason = "The system macro SYSTEM_PERIODIC_HOLD expression '( JobStatus =!= 5 &amp;&amp; JobStatus =!= 3 &amp;&amp; ( CurrentTime - GridResourceUnavailableTime ) &gt; 3600 )' evaluated to TRUE<br/>
<span style="color: #7d414c"><span style="font-size: small">(11:03:11)</span> <b>bockjoo:</b></span> I think @blin can help you.<br/>
<span style="color: #43761b"><span style="font-size: small">(11:03:53)</span> <b>blin:</b></span> we have a whole troubleshooting section just for that on the CE: <a href="https://opensciencegrid.org/docs/compute-element/troubleshoot-htcondor-ce/#jobs-stay-idle-on-the-ce">https://opensciencegrid.org/docs/compute-element/troubleshoot-htcondor-ce/#jobs-stay-idle-on-the-ce</a><br/>
<span style="color: #43761b"><span style="font-size: small">(11:04:23)</span> <b>blin:</b></span> also notes on updating to 8.8: <a href="https://opensciencegrid.org/docs/release/release_series/#updating-to-htcondor-88x_1">https://opensciencegrid.org/docs/release/release_series/#updating-to-htcondor-88x_1</a><br/>
<span style="color: #43761b"><span style="font-size: small">(11:04:32)</span> <b>blin:</b></span> and 3.5-specific update instructions: <a href="https://opensciencegrid.org/docs/release/release_series/#updating-to-osg-35">https://opensciencegrid.org/docs/release/release_series/#updating-to-osg-35</a><br/>
<span style="color: #aba727"><span style="font-size: small">(11:06:22)</span> <b>maxi:</b></span> Brian, As root, try to change ownership of the file or directory in question. If the file does not exist, a parent directory may have improper permissions.<br/>
<span style="color: #aba727"><span style="font-size: small">(11:06:34)</span> <b>maxi:</b></span> to change permissions to what user, condor?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:06:49)</span> <b>blin:</b></span> where are you seeing that text?<br/>
<span style="color: #aba727"><span style="font-size: small">(11:07:18)</span> <b>maxi:</b></span> in the first link you showed me<br/>
<span style="color: #43761b"><span style="font-size: small">(11:14:05)</span> <b>blin:</b></span> yeah, it should be <tt>condor:condor</tt> from <tt>/var/lib/condor*</tt> up<br/>
<span style="color: #aba727"><span style="font-size: small">(11:14:45)</span> <b>maxi:</b></span> ls -ld /var/lib/condor-ce<br/>drwxr-xr-x 4 condor condor 4096 Feb 11 2019 /var/lib/condor-ce<br/>
<span style="color: #aba727"><span style="font-size: small">(11:15:02)</span> <b>maxi:</b></span> I always wipe out this directory clean whe restarting<br/>
<span style="color: #43761b"><span style="font-size: small">(11:15:12)</span> <b>blin:</b></span> er, don't do that<br/>
<span style="color: #43761b"><span style="font-size: small">(11:15:41)</span> <b>blin:</b></span> that'll cause lots of issues with jobs that were running before the restart<br/>
<span style="color: #aba727"><span style="font-size: small">(11:16:46)</span> <b>maxi:</b></span> systemctl status condor-ce -l<br/>*●* condor-ce.service - HTCondor CE<br/>  Loaded: loaded (/usr/lib/systemd/system/condor-ce.service; disabled; vendor preset: disabled)<br/>  Active: *active (running)* since Wed 2020-04-01 12:13:03 EDT; 3min 10s ago<br/> Process: 1028219 ExecStart=/usr/share/condor-ce/condor_ce_startup (code=exited, status=0/SUCCESS)<br/> Main PID: 1028226 (condor_master)<br/>  Tasks: 6<br/>  Memory: 117.9M<br/>  CGroup: /system.slice/condor-ce.service<br/>      ├─1028226 condor_master<br/>      ├─1028275 condor_procd -A /var/lock/condor-ce/procd_pipe -L /var/log/condor-ce/ProcLog -R 1000000 -S 60 -C 989<br/>      ├─1028276 condor_shared_port -f<br/>      ├─1028279 condor_collector -f<br/>      ├─1028283 condor_schedd -f<br/>      └─1028284 condor_job_router -f<br/><br/>Apr 01 12:13:03 <a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a> systemd[1]: Starting HTCondor CE...<br/>Apr 01 12:13:03 <a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a> systemd[1]: Started HTCondor CE.<br/>Apr 01 12:13:14 <a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a> htcondor-ce[1028283]: Callout to "LCMAPS" returned local user (service condor): "cmsu0725"<br/>
<span style="color: #aba727"><span style="font-size: small">(11:18:05)</span> <b>maxi:</b></span> everything looks good, right?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:20:08)</span> <b>blin:</b></span> that looks reasonable, yes<br/>
<span style="color: #43761b"><span style="font-size: small">(11:20:23)</span> <b>blin:</b></span> but errors, if any will show up in <tt>/var/log/condor-ce</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(11:20:33)</span> <b>blin:</b></span> most likely in the JobRouterLog<br/>
<span style="color: #aba727"><span style="font-size: small">(11:25:31)</span> <b>maxi:</b></span> yes, it is fool of:<br/>
<span style="color: #aba727"><span style="font-size: small">(11:25:34)</span> <b>maxi:</b></span> 04/01/20 12:24:37 JobRouter failure (src=815.0,route=Local_Condor): failed to submit job<br/>04/01/20 12:24:37 Can't find address for schedd <a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a><br/>04/01/20 12:24:37 ERROR (pool <a href="http://t2srv0006.cmsaf.mit.edu:9618">t2srv0006.cmsaf.mit.edu:9618</a>) Can't find address of schedd<br/>04/01/20 12:24:37 JobRouter failure (src=642.0,route=Local_Condor): failed to submit job<br/>04/01/20 12:24:37 Can't find address for schedd <a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a><br/>04/01/20 12:24:37 ERROR (pool <a href="http://t2srv0006.cmsaf.mit.edu:9618">t2srv0006.cmsaf.mit.edu:9618</a>) Can't find address of schedd<br/>04/01/20 12:24:37 JobRouter failure (src=800.0,route=Local_Condor): failed to submit job<br/>04/01/20 12:24:37 Can't find address for schedd <a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a><br/>04/01/20 12:24:37 ERROR (pool <a href="http://t2srv0006.cmsaf.mit.edu:9618">t2srv0006.cmsaf.mit.edu:9618</a>) Can't find address of schedd<br/>
<span style="color: #aba727"><span style="font-size: small">(11:31:17)</span> <b>maxi:</b></span> t2srv0006 is our negotiator<br/>
<span style="color: #aba727"><span style="font-size: small">(11:33:29)</span> <b>maxi:</b></span> I do not see anything else obvious in any other logs<br/>
<span style="color: #43761b"><span style="font-size: small">(11:36:39)</span> <b>blin:</b></span> anything in <tt>/var/log/condor/SchedLog</tt> ? does the local schedd show up in the collector with <tt>condor_status -schedd</tt>?<br/>
<span style="color: #aba727"><span style="font-size: small">(11:36:41)</span> <b>maxi:</b></span> it might be:<br/>
<span style="color: #aba727"><span style="font-size: small">(11:36:44)</span> <b>maxi:</b></span> condor_config_val JOB_ROUTER_SCHEDD2_NAME<br/>Not defined: JOB_ROUTER_SCHEDD2_NAME<br/>
<span style="color: #aba727"><span style="font-size: small">(11:36:52)</span> <b>maxi:</b></span> where do I set all those?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:37:03)</span> <b>blin:</b></span> that's fine, it shouldn't be set for the local condor<br/>
<span style="color: #43761b"><span style="font-size: small">(11:37:22)</span> <b>blin:</b></span> <tt>condor_ce_config_val -v JOB_ROUTER_SCHEDD2_NAME</tt> on the other hand should be set (and appears to be from your error messages)<br/>
<span style="color: #aba727"><span style="font-size: small">(11:38:05)</span> <b>maxi:</b></span> condor_config_val JOB_ROUTER_SCHEDD2_NAME<br/>Not defined: JOB_ROUTER_SCHEDD2_NAME<br/>[root@ce02 ~]# condor_config_val JOB_ROUTER_SCHEDD2_POOL<br/>Not defined: JOB_ROUTER_SCHEDD2_POOL<br/>[root@ce02 ~]# condor_config_val JOB_ROUTER_SCHEDD2_SPOOL<br/>Not defined: JOB_ROUTER_SCHEDD2_SPOOL<br/>
<span style="color: #aba727"><span style="font-size: small">(11:38:22)</span> <b>maxi:</b></span> so where do I set them? in local config?<br/>
<span style="color: #aba727"><span style="font-size: small">(11:38:39)</span> <b>maxi:</b></span> and they should be all <a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a>, right?<br/>
<span style="color: #aba727"><span style="font-size: small">(11:42:35)</span> <b>maxi:</b></span> sorry, I made a mistake, all those are set:<br/>
<span style="color: #aba727"><span style="font-size: small">(11:43:24)</span> <b>maxi:</b></span> condor_ce_config_val JOB_ROUTER_SCHEDD2_SPOOL<br/>/condor/spool<br/>[root@ce02 ~]# condor_ce_config_val JOB_ROUTER_SCHEDD2_NAME<br/><a href="http://ce02.cmsaf.mit.edu">ce02.cmsaf.mit.edu</a><br/>
<span style="color: #aba727"><span style="font-size: small">(11:43:43)</span> <b>maxi:</b></span> I used cond_config instead of condor_ce_config<br/>
<span style="color: #43761b"><span style="font-size: small">(11:44:53)</span> <b>blin:</b></span> yeah those look good<br/>
<span style="color: #43761b"><span style="font-size: small">(11:45:05)</span> <b>blin:</b></span> the ERROR that you're seeing in the JobRouterLog means a communication issue between the CE and your local condor<br/>
<span style="color: #43761b"><span style="font-size: small">(11:45:35)</span> <b>blin:</b></span> i would check <tt>/var/log/condor/SchedLog</tt> on the CE and <tt>/var/log/condor/CollectorLog</tt> on the central maanger<br/>
<span style="color: #43761b"><span style="font-size: small">(11:45:46)</span> <b>blin:</b></span> and double check that the CE local schedd shows up in <tt>condor_status -schedd</tt><br/>
<span style="color: #aba727"><span style="font-size: small">(11:51:13)</span> <b>maxi:</b></span> but why it stopped communicating? 2 other CEs are fine, and if I downgrade to *condor*-8.6.13 it will start working again<br/>
<span style="color: #aba727"><span style="font-size: small">(11:51:58)</span> <b>maxi:</b></span> I looked through the pages you reffered me two, I do not see anything obvious<br/>
<span style="color: #aba727"><span style="font-size: small">(11:52:41)</span> <b>maxi:</b></span> ls -l /var/log/condor-ce/*<br/>-rw-r--r-- 1 condor condor  638399 Apr 1 12:52 /var/log/condor-ce/AuditLog<br/>-rw-r--r-- 1 condor condor 1277645 Apr 1 12:09 /var/log/condor-ce/AuditLog.20200328T200000<br/>-rw-r--r-- 1 condor condor   267 Apr 1 12:21 /var/log/condor-ce/AuditPayloadLog<br/>-rw-r--r-- 1 condor condor   222 Apr 1 12:09 /var/log/condor-ce/AuditPayloadLog.20200328T200000<br/>-rw-r--r-- 1 condor condor  403707 Apr 1 12:52 /var/log/condor-ce/CollectorLog<br/>-rw-r--r-- 1 condor condor 2836308 Apr 1 12:52 /var/log/condor-ce/JobRouterLog<br/>-rw-r--r-- 1 condor condor 10485949 Apr 1 12:45 /var/log/condor-ce/JobRouterLog.old<br/>-rw-r--r-- 1 root  root    3268 Apr 1 12:21 /var/log/condor-ce/KernelTuning.log<br/>-rw-r--r-- 1 condor condor  23188 Apr 1 12:21 /var/log/condor-ce/MasterLog<br/>-rw-r--r-- 1 root  root   226218 Apr 1 12:52 /var/log/condor-ce/ProcLog<br/>-rw-r--r-- 1 condor condor 1867644 Apr 1 12:52 /var/log/condor-ce/SchedLog<br/>-rw-r--r-- 1 condor condor 10485922 Apr 1 12:22 /var/log/condor-ce/SchedLog.old<br/>-rw-r--r-- 1 condor condor  21512 Apr 1 12:51 /var/log/condor-ce/SharedPortLog<br/>-rw-r--r-- 1 condor condor  596780 Apr 1 12:52 /var/log/condor-ce/transfer_history<br/>
<span style="color: #43761b"><span style="font-size: small">(11:53:07)</span> <b>blin:</b></span> please read through the next two links i sent<br/>
<span style="color: #43761b"><span style="font-size: small">(11:53:34)</span> <b>blin:</b></span> there are specific instructions there for upgrading to condor 8.8 and/or OSG 3.5<br/>
<span style="color: #aba727"><span style="font-size: small">(11:53:52)</span> <b>maxi:</b></span> it can't be that complicated<br/>
<span style="color: #aba727"><span style="font-size: small">(11:54:48)</span> <b>maxi:</b></span> I read both of them, I do not see anything obvious<br/>
<span style="color: #aba727"><span style="font-size: small">(11:56:22)</span> <b>maxi:</b></span> no other changes were done on the host other than you upgrade, why it looses it is own name and the hame of negotiator?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:57:32)</span> <b>blin:</b></span> please open a GGUS ticket<br/>
<span style="color: #43761b"><span style="font-size: small">(11:57:59)</span> <b>blin:</b></span> you should be able to assign it to the <tt>OSG Software Support</tt> unit (either upon creation or after)<br/>
<span style="color: #aba727"><span style="font-size: small">(12:02:27)</span> <b>maxi:</b></span> what should ticket category and type of issue?<br/>
<blockquote>
<span style="color: #43761b"><span style="font-size: small">(12:19:36)</span> <b>blin:</b></span> issue type: local batch system<br/>category: incident<br/>
</blockquote>
<span style="color: #e06b56"><span style="font-size: small">(12:04:47)</span> <b>jthiltges:</b></span> Hi @justas.balcas . In the T2 meeting chat yesterday, you mentioned using a newer Hadoop/HDFS? I was curious which packaging you used.<br/>
<span style="color: #de5f24"><span style="font-size: small">(12:06:23)</span> <b>justas.balcas:</b></span> <a href="https://www.apache.org/dyn/closer.cgi/hadoop/common/hadoop-3.2.1/hadoop-3.2.1.tar.gz">https://www.apache.org/dyn/closer.cgi/hadoop/common/hadoop-3.2.1/hadoop-3.2.1.tar.gz</a><br/>
<blockquote>
<span style="color: #e06b56"><span style="font-size: small">(12:27:00)</span> <b>jthiltges:</b></span> Thank you! We're using RPMs at the moment. If you were using RPM packaging before, any issues with the transition?<br/>
<span style="color: #de5f24"><span style="font-size: small">(12:29:03)</span> <b>justas.balcas:</b></span> Yes, I moved testbed cluster from OSG 2.6 RPM Based install to non RPM based install (had to do twice, from 2.6 to 2.9.2 and then to 3.2.1) There are some config changes to be made, but all went smooth.<br/>
<span style="color: #e06b56"><span style="font-size: small">(12:29:59)</span> <b>jthiltges:</b></span> Good to know. Thanks much!<br/>
</blockquote>
</body>
</html>
