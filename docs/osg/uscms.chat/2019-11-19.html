<!DOCTYPE html>
<html>
<head>
<title>Tue Nov 19, 2019 : #uscms (osg)</title>
</head>
<body>
<h3>Tue Nov 19, 2019 : #uscms (osg)</h3>
<span style="color: #a72f79"><span style="font-size: small">(08:49:42)</span> <b>andrew.melo:</b></span> Does anyone explicitly up the limits for their xrootd daemons? I'm seeing a lot of timeouts on the client side accompanied by the following in the xrootd log (grepping for my own username)<br/><br/><pre><br/>191119 08:47:10 6918 XrootdXeq: meloam.46194:72@gw343 pub IPv4 login as cmsuser<br/>191119 08:47:10 6918 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24<br/>191119 08:47:10 6918 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24 rc=4 (Resource temporarily unavailable)<br/>191119 08:47:14 6942 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24<br/>191119 08:47:14 6942 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24 rc=6 (Resource temporarily unavailable)<br/>191119 08:47:20 6953 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24<br/>191119 08:47:20 6953 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24 rc=8 (Resource temporarily unavailable)<br/>191119 08:47:28 6946 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24<br/>191119 08:47:28 6946 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24 rc=10 (Resource temporarily unavailable)<br/>191119 08:47:38 6955 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24<br/>191119 08:47:38 6955 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24 rc=12 (Resource temporarily unavailable)<br/>191119 08:47:50 6955 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24<br/>191119 08:47:50 6955 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24 rc=14 (Resource temporarily unavailable)<br/>191119 08:48:04 6953 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24<br/>191119 08:48:04 6953 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24 rc=16 (Resource temporarily unavailable)<br/>191119 08:48:21 7150 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24<br/>191119 08:48:21 7150 meloam.46194:72@gw343 XrootdProtocol: endsess 6312:54.24 rc=18 (Resource temporarily unavailable)</pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(08:51:31)</span> <b>andrew.melo:</b></span> I tried cranking nproc and nfiles for xrootd and bouncing the service and didn't get any change, though the limits appear to be high enough anyway<br/><br/><pre>[root@xrootd2 ~]# cat /proc/6312/limits<br/>Limit                     Soft Limit           Hard Limit           Units     <br/>Max cpu time              unlimited            unlimited            seconds   <br/>Max file size             unlimited            unlimited            bytes     <br/>Max data size             unlimited            unlimited            bytes     <br/>Max stack size            8388608              unlimited            bytes     <br/>Max core file size        unlimited            unlimited            bytes     <br/>Max resident set          unlimited            unlimited            bytes     <br/>Max processes             30000                256965               processes <br/>Max open files            65536                65536                files     <br/>Max locked memory         65536                65536                bytes     <br/>Max address space         unlimited            unlimited            bytes     <br/>Max file locks            unlimited            unlimited            locks     <br/>Max pending signals       256965               256965               signals   <br/>Max msgqueue size         819200               819200               bytes     <br/>Max nice priority         0                    0                    <br/>Max realtime priority     0                    0                    <br/>Max realtime timeout      unlimited            unlimited            us  </pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(08:51:58)</span> <b>andrew.melo:</b></span> (looking at proc/6312/status, there's only 150 threads)<br/>
<span style="color: #a72f79"><span style="font-size: small">(09:03:49)</span> <b>andrew.melo:</b></span> and if I look at lsof for xrootd, I see that the top file handle # is <tt>790</tt>, so I don't think I'm blowing the nfiles limit<br/>
<span style="color: #b14cbc"><span style="font-size: small">(14:49:06)</span> <b>tmartin:</b></span> We are having all sorts of issues with our gridftp doors all of a sudden. I am seeing for example piles of root owned gridftp processes just hanging around. Thousands of them. A restart clears it, but they just hang around otherwise and do not seem to want to clear out.<br/><br/>This is on top of our xrootd redirector deciding it does not like IPv4 any more and if our doors talk IPv6 it ignores their IPv4 connection. Only disabling IPv6 on a door allows the redirector to talk IPv4 to the door.<br/>
<span style="color: #b14cbc"><span style="font-size: small">(14:51:45)</span> <b>tmartin:</b></span> I guess the processes hanging around could because of the honestly silly timeout that FTS requests<br/>
</body>
</html>
