<!DOCTYPE html>
<html>
<head>
<title>Fri Oct 11, 2019 : #uscms (osg)</title>
</head>
<body>
<h3>Fri Oct 11, 2019 : #uscms (osg)</h3>
<span style="color: #53b759"><span style="font-size: small">(10:47:07)</span> <b>marian:</b></span> @andrew.melo: just adding few tech details to what John mentioned ... I have such setup on my VM for testing purposes, you may want to check with <tt>xrdmapc</tt> whether you've successfully configured manager(redirector)+server role on the same host:<br/>
<span style="color: #53b759"><span style="font-size: small">(10:47:12)</span> <b>marian:</b></span> <pre><br/>$  xrdmapc --list all <a href="http://cms-xrd-transit.cern.ch:1094">cms-xrd-transit.cern.ch:1094</a> | grep marian<br/>1     Man <a href="http://hcc-marian.unl.edu:1095">hcc-marian.unl.edu:1095</a><br/>           Srv <a href="http://hcc-marian.unl.edu:1094">hcc-marian.unl.edu:1094</a><br/></pre><br/>
<span style="color: #53b759"><span style="font-size: small">(10:50:10)</span> <b>marian:</b></span> the trick would be ideally split thing into two config files and have pair of <tt>xrootd,cmsd</tt> process run for both ... in the EL7 system it would be then something like:<br/><pre><br/>$ systemctl status {cmsd,xrootd}@local-redirector<br/>$ systemctl status {cmsd,xrootd}@local-server<br/></pre><br/>
<span style="color: #53b759"><span style="font-size: small">(10:52:22)</span> <b>marian:</b></span> where in my case important bits for <tt>/etc/xrootd/xrootd-local-redirector.cfg</tt> are:<br/><pre><br/>all.manager <a href="http://hcc-marian.unl.edu">hcc-marian.unl.edu</a> 3121<br/>xrd.port 1095<br/>all.manager meta all <a href="http://cms-xrd-transit.cern.ch">cms-xrd-transit.cern.ch</a>+ 1213<br/></pre><br/>and for <tt>/etc/xrootd/xrootd-local-server.cfg</tt>:<br/><pre><br/>all.role server<br/>xrd.port 1094<br/>all.manager <a href="http://hcc-marian.unl.edu">hcc-marian.unl.edu</a> 3121<br/></pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(10:52:35)</span> <b>andrew.melo:</b></span> what does the xrdmapc do?<br/>
<span style="color: #53b759"><span style="font-size: small">(10:53:37)</span> <b>marian:</b></span> it tells you hierarchically how you subscribe your sever/manager to another manager (cmsd)<br/>
<span style="color: #53b759"><span style="font-size: small">(10:54:33)</span> <b>marian:</b></span> so in the <tt>xrdmapc</tt> output above you see bits <tt>Srv</tt> and <tt>Man</tt> for the same host<br/>
<span style="color: #53b759"><span style="font-size: small">(10:54:49)</span> <b>marian:</b></span> meaning both roles are served by that host<br/>
<span style="color: #53b759"><span style="font-size: small">(10:55:27)</span> <b>marian:</b></span> <tt>xrdmapc</tt> is nothing than admin tool at some point<br/>
<span style="color: #a72f79"><span style="font-size: small">(11:00:14)</span> <b>andrew.melo:</b></span> gotcha<br/>
<span style="color: #53b759"><span style="font-size: small">(11:02:42)</span> <b>marian:</b></span> you can pretty much test the things using transitional redirector if you like, just to isolate possible mess up of anything in the production federation ...<br/>
<span style="color: #a72f79"><span style="font-size: small">(11:03:40)</span> <b>andrew.melo:</b></span> right<br/>
<span style="color: #53b759"><span style="font-size: small">(11:04:18)</span> <b>marian:</b></span> so the example above would be good for you ... assuming all will be configured ok everybody should be able also reach data underneath transitional federation if it's only you hosting that data, production federation will redirect requests to you<br/>
<span style="color: #53b759"><span style="font-size: small">(11:05:26)</span> <b>marian:</b></span> after you're confident with setup then you just switch subscription line from <a href="http://cms-xrd-transit.cern.ch">cms-xrd-transit.cern.ch</a> to <a href="http://cmsxrootd.fnal.gov">cmsxrootd.fnal.gov</a><br/>
<span style="color: #e06b56"><span style="font-size: small">(11:06:30)</span> <b>jthiltges:</b></span> This reminds me, are redundant local redirectors an option? I remember going down this trail, but not sure where it ended. It bothers me a little that it's a single point of failure at Nebraska.<br/>
<span style="color: #53b759"><span style="font-size: small">(11:07:39)</span> <b>marian:</b></span> well if you host a lot of servers subscribed, redundancy could help ... is your case let's say &gt;=10 data servers?<br/>
<span style="color: #53b759"><span style="font-size: small">(11:08:58)</span> <b>marian:</b></span> or maybe I misunderstand the point ... was it about DNS alias for more than one local redirector?<br/>
<span style="color: #a72f79"><span style="font-size: small">(11:09:21)</span> <b>andrew.melo:</b></span> the latter<br/>
<span style="color: #e06b56"><span style="font-size: small">(11:10:26)</span> <b>jthiltges:</b></span> If <a href="http://xrootd-local.unl.edu">xrootd-local.unl.edu</a> falls over, we're down. The regional redirector and SEs have redundancy. Was wondering about how to fix that.<br/>
<span style="color: #7d414c"><span style="font-size: small">(11:12:15)</span> <b>bockjoo:</b></span> How frequent and long does it fall over?<br/>
<span style="color: #e06b56"><span style="font-size: small">(11:15:37)</span> <b>jthiltges:</b></span> I was hoping to avoid saying that out loud, for fear of tempting fate. :stuck_out_tongue_closed_eyes:<br/>xrootd 4.10 has been quite stable for us, with the daemon running 2+ months.<br/>If the local redirector or the underlying VM server fails over a weekend, I'd like to be in a position to fix it Monday morning, rather than fixing it _now_.<br/>
<span style="color: #53b759"><span style="font-size: small">(11:18:48)</span> <b>marian:</b></span> yeah, if xrootd-local is belly up we're down<br/>
<span style="color: #7d414c"><span style="font-size: small">(11:19:17)</span> <b>bockjoo:</b></span> My life is not so exciting, so I would fix it (non-hardware problem) even if it is a weekend :slightly_smiling_face:<br/>
<span style="color: #7d414c"><span style="font-size: small">(11:25:39)</span> <b>bockjoo:</b></span> But I have never seen my redirector fail so far (Don't zynx it!).<br/>
<span style="color: #d1707d"><span style="font-size: small">(11:34:22)</span> <b>gattebury:</b></span> I think John was implying we would fix it immediately, but we’d like to have redundancy so we don’t _have_ to bother fixing it and can just let it coast automatically until Monday on a backup/secondary<br/>
<span style="color: #d1707d"><span style="font-size: small">(11:34:48)</span> <b>gattebury:</b></span> failures you can get around to on your own time are the best type of failures (if such things exist!)<br/>
<span style="color: #d1707d"><span style="font-size: small">(11:40:36)</span> <b>gattebury:</b></span> (is this the part where Edgar runs in waving a Kubernetes flag around?) :slightly_smiling_face:<br/>
<span style="color: #53b759"><span style="font-size: small">(13:20:19)</span> <b>marian:</b></span> (I think @efajardo has only things StashCache specific for xrootd in Kubernetes, nothing about redirector, though ... but he can correct me if it's otherwise)<br/>
<span style="color: #d1707d"><span style="font-size: small">(13:29:16)</span> <b>gattebury:</b></span> it was more a joke that Kubernetes is the current FOTM hammer for automatic restarts / sustainability of services which die often, and that Edgar love Kubernetes so much :wink:<br/>
<span style="color: #a72f79"><span style="font-size: small">(13:50:41)</span> <b>andrew.melo:</b></span> Hmm, I just gave it a shot to set up a redirector and server on the same host and something's off. I can connect and download a file from the server OK, but if I try it from the manager I get<br/><pre><br/>[2019-10-11 13:48:14.204371 -0500][Dump   ][XRootD            ] [<a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a>] Message kXR_open (file: /store/ONLYATVANDY-LFS.txt, mode: 00, flags: kXR_open_read kXR_async kXR_retstat ) has been successfully sent.<br/>[2019-10-11 13:48:14.204404 -0500][Dump   ][PostMaster        ] [<a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a> #0.0] All messages consumed, disable uplink<br/>[2019-10-11 13:48:14.209851 -0500][Dump   ][XRootDTransport   ] [msg: 0xdc0049c0] Expecting 5 bytes of message body<br/>[2019-10-11 13:48:14.209916 -0500][Dump   ][AsyncSock         ] [<a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a> #0.0] Received message header for 0xdc0049c0 size: 8<br/>[2019-10-11 13:48:14.209978 -0500][Dump   ][AsyncSock         ] [<a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a> #0.0] Received message 0xdc0049c0 of 13 bytes<br/>[2019-10-11 13:48:14.210025 -0500][Dump   ][PostMaster        ] [<a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a> #0] Handling received message: 0xdc0049c0.<br/>[2019-10-11 13:48:14.210157 -0500][Dump   ][XRootD            ] [<a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a>] Got a kXR_error response to request kXR_open (file: /store/ONLYATVANDY-LFS.txt, mode: 00, flags: kXR_open_read kXR_async kXR_retstat ) [3005] <br/>[2019-10-11 13:48:14.210256 -0500][Debug  ][XRootD            ] [<a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a>] Handling error while processing kXR_open (file: /store/ONLYATVANDY-LFS.txt, mode: 00, flags: kXR_open_read kXR_async kXR_retstat ): [ERROR] Error response: Input/output error.<br/>[2019-10-11 13:48:14.210336 -0500][Debug  ][File              ] [0x24e3350@root://xrootd1.accre.vanderbilt.edu:1096//store/ONLYATVANDY-LFS.txt] Open has returned with status [ERROR] Server responded with an error: [3005] <br/></pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(13:51:15)</span> <b>andrew.melo:</b></span> (1095 is the server backing it<br/>
<span style="color: #e06b56"><span style="font-size: small">(14:00:43)</span> <b>jthiltges:</b></span> Hmm. The open _should_ get a redirect response, but I'm not sure why it's getting an error. Maybe turn up the debugging knobs on the <tt>:1096</tt> server and check for clues?<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:01:00)</span> <b>andrew.melo:</b></span> let me crank it to all<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:03:05)</span> <b>andrew.melo:</b></span> Nothing jumps out here:<br/><pre><br/>191011 14:02:43 7583 cms_setStatus: Manager <a href="http://xrootd1.accre.vanderbilt.edu">xrootd1.accre.vanderbilt.edu</a> resumed<br/>191011 14:02:48 7568 ?:28@[::129.93.239.166] XrootdProtocol: 0000 req=login dlen=86<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdResponse: 0000 sending 61 data bytes; status=0<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdProtocol: 0000 req=auth dlen=112<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdProtocol: 0000 more auth requested; sz=2858<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdResponse: 0000 sending 2858 data bytes; status=4002<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdProtocol: 0000 req=auth dlen=8645<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdResponse: 0000 sending OK<br/>191011 14:02:48 7568 XrootdMonitor: 272 bytes sent to <a href="http://xrootd.t2.ucsd.edu:9930">xrootd.t2.ucsd.edu:9930</a> rc=0<br/>191011 14:02:48 7568 XrootdXeq: jthiltge.21805:28@[::129.93.239.166] pub IP46 login as /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jthiltge/CN=744982/CN=John Thiltges<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdProtocol: 0100 req=query dlen=5<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdProtocol: 0100 query config role<br/>191011 14:02:48 7568 jthiltge.21805:28@[::129.93.239.166] XrootdResponse: 0100 sending 8 data bytes<br/>191011 14:02:48 7568 XrootdXeq: jthiltge.21805:28@[::129.93.239.166] disc 0:00:01<br/>191011 14:02:48 7568 XrootdMonitor: 56 bytes sent to <a href="http://xrootd.t2.ucsd.edu:9930">xrootd.t2.ucsd.edu:9930</a> rc=0<br/></pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(14:03:28)</span> <b>andrew.melo:</b></span> <tt>xrootd.trace all</tt><br/>
<span style="color: #e06b56"><span style="font-size: small">(14:04:03)</span> <b>jthiltges:</b></span> I think you caught me checking the roles. :slightly_smiling_face:  That part looks OK:<br/><pre>[jthiltge@t3 ~]$ xrdfs <a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a> query config role<br/>manager<br/>[jthiltge@t3 ~]$ xrdfs <a href="http://xrootd1.accre.vanderbilt.edu:1095">xrootd1.accre.vanderbilt.edu:1095</a> query config role<br/>server</pre><br/>
<span style="color: #e06b56"><span style="font-size: small">(14:07:27)</span> <b>jthiltges:</b></span> Anything for the file access attempt?<br/><pre>[2019-10-11 14:04:28.734931 -0500][Debug  ][XRootD            ] [<a href="http://xrootd1.accre.vanderbilt.edu:1096">xrootd1.accre.vanderbilt.edu:1096</a>] Handling error while processing kXR_open (file: /store/ONLYATVANDY-LFS.txt, mode: 00, flags: kXR_open_read kXR_async kXR_retstat ): [ERROR] Error response: Input/output error.</pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(14:09:18)</span> <b>andrew.melo:</b></span> on redir<br/><pre><br/>191011 14:04:28 7568 ?:28@t3.unl.edu XrootdProtocol: 0000 req=login dlen=86<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdResponse: 0000 sending 61 data bytes; status=0<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdProtocol: 0000 req=auth dlen=112<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdProtocol: 0000 more auth requested; sz=2858<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdResponse: 0000 sending 2858 data bytes; status=4002<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdProtocol: 0000 req=auth dlen=8645<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdResponse: 0000 sending OK<br/>191011 14:04:28 7568 XrootdMonitor: 264 bytes sent to <a href="http://xrootd.t2.ucsd.edu:9930">xrootd.t2.ucsd.edu:9930</a> rc=0<br/>191011 14:04:28 7568 XrootdXeq: jthiltge.22321:28@t3.unl.edu pub IP46 login as /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jthiltge/CN=744982/CN=John Thiltges<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdProtocol: 0100 req=open dlen=26<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdProtocol: 0100 open rat /store/ONLYATVANDY-LFS.txt<br/>191011 14:04:28 7568 jthiltge.22321:28@t3.unl.edu XrootdResponse: 0100 sending err 3005: <br/>191011 14:04:28 7568 XrootdXeq: jthiltge.22321:28@t3.unl.edu disc 0:00:00<br/>191011 14:04:28 7568 XrootdMonitor: 56 bytes sent to <a href="http://xrootd.t2.ucsd.edu:9930">xrootd.t2.ucsd.edu:9930</a> rc=0<br/>191011 14:07:34 7567 XrootdMonitor: 148 bytes sent to <a href="http://xrootd.t2.ucsd.edu:9930">xrootd.t2.ucsd.edu:9930</a> rc=0<br/></pre><br/>on server<br/><pre><br/>==&gt; /var/log/xrootd/pluginvers/xrootd.log &lt;==<br/>191011 14:03:00 7328 jthiltge.21823:46@t3.unl.edu XrootdProtocol: more auth requested; sz=2858<br/>191011 14:03:00 7328 XrootdXeq: jthiltge.21823:46@t3.unl.edu pub IP46 login as /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jthiltge/CN=744982/CN=John Thiltges<br/>191011 14:03:00 7328 XrootdXeq: jthiltge.21823:46@t3.unl.edu disc 0:00:00<br/><br/></pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(14:10:15)</span> <b>andrew.melo:</b></span> wait, differnt times<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:10:34)</span> <b>andrew.melo:</b></span> the server doesn't get any logs if I try to do a transfer on my own<br/>
<span style="color: #e06b56"><span style="font-size: small">(14:17:43)</span> <b>jthiltges:</b></span> Checking our logs for that error code, there's things like this:<br/><pre>XrootdResponse: sending err 3005: Too many attempts to gain dfs read access to the file</pre><br/>Kinda odd that it's <tt>sending err 3005: &lt;BLANK&gt;</tt><br/><br/>I've run into globus or lcmaps errors where the logging is underwhelming. (Or I haven't found the right combination of flags and output file.)<br/>Attaching an strace to xrootd sometimes shows helpful error strings flying around. Bump up the string size (<tt>-s</tt>) too.<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:27:32)</span> <b>andrew.melo:</b></span> Hmm, this is everything, but ignoring futex calls since they're constantly triggering<br/><pre><br/>[pid  7370] poll([{fd=30, events=POLLIN}, {fd=21, events=POLLIN}], 2, 5000) = 0 (Timeout)<br/>[pid  7370] poll([{fd=30, events=POLLIN}], 1, 0) = 0 (Timeout)<br/>[pid  7370] poll([{fd=30, events=POLLIN}], 1, 0) = 0 (Timeout)<br/>[pid  7370] write(28, "\1\0\0\0\0\0\0\0", 8) = 8<br/>[pid  7372] &lt;... epoll_wait resumed&gt; [{EPOLLIN, {u32=2550151008, u64=139803735635808}}], 256, -1) = 1<br/>[pid  7370] poll([{fd=30, events=POLLIN}, {fd=21, events=POLLIN}], 2, 0 &lt;unfinished ...&gt;<br/>[pid  7372] poll([{fd=28, events=POLLIN}], 1, 0 &lt;unfinished ...&gt;<br/>[pid  7370] &lt;... poll resumed&gt; )        = 0 (Timeout)<br/>[pid  7372] &lt;... poll resumed&gt; )        = 1 ([{fd=28, revents=POLLIN}])<br/>[pid  7370] poll([{fd=30, events=POLLIN}], 1, 0 &lt;unfinished ...&gt;<br/>[pid  7372] epoll_ctl(29, EPOLL_CTL_MOD, 31, {EPOLLIN|EPOLLOUT, {u32=2080377632, u64=139803265862432}} &lt;unfinished ...&gt;<br/>[pid  7370] &lt;... poll resumed&gt; )        = 0 (Timeout)<br/>[pid  7372] &lt;... epoll_ctl resumed&gt; )   = 0<br/>[pid  7370] poll([{fd=30, events=POLLIN}, {fd=21, events=POLLIN}], 2, 5000 &lt;unfinished ...&gt;<br/>[pid  7372] sendto(31, "\1\0\1\7LMQv100\1\1\1\1\10\10\0\0\0\0\0\0\0\0\0", 26, 0, NULL, 0) = 26<br/>[pid  7372] read(28, "\1\0\0\0\0\0\0\0", 8) = 8<br/>[pid  7372] poll([{fd=28, events=POLLIN}], 1, 0) = 0 (Timeout)<br/>[pid  7372] epoll_wait(29, [{EPOLLIN|EPOLLOUT, {u32=2080377632, u64=139803265862432}}], 256, -1) = 1<br/>[pid  7372] epoll_ctl(29, EPOLL_CTL_MOD, 31, {EPOLLIN, {u32=2080377632, u64=139803265862432}}) = 0<br/>[pid  7372] recvfrom(31, "\1\0\1\7LMQv100\1\1\2\1\10\10\0\0\0\0\0\0\0\0\0", 8192, 0, NULL, NULL) = 26<br/>[pid  7372] write(30, "\1\0\0\0\0\0\0\0", 8) = 8<br/>[pid  7370] &lt;... poll resumed&gt; )        = 1 ([{fd=30, revents=POLLIN}])<br/>[pid  7372] epoll_wait(29,  &lt;unfinished ...&gt;<br/>[pid  7370] poll([{fd=30, events=POLLIN}], 1, 0) = 1 ([{fd=30, revents=POLLIN}])<br/>[pid  7370] read(30, "\1\0\0\0\0\0\0\0", 8) = 8<br/>[pid  7370] poll([{fd=30, events=POLLIN}], 1, 0) = 0 (Timeout)<br/>[pid  7370] poll([{fd=30, events=POLLIN}], 1, 0) = 0 (Timeout)<br/>[pid  7370] poll([{fd=30, events=POLLIN}], 1, 0) = 0 (Timeout)<br/>[pid  7370] poll([{fd=30, events=POLLIN}, {fd=21, events=POLLIN}], 2, 0) = 0 (Timeout)<br/>[pid  7370] poll([{fd=30, events=POLLIN}], 1, 0) = 0 (Timeout)<br/>[pid  7370] poll([{fd=30, events=POLLIN}, {fd=21, events=POLLIN}], 2, 5000<br/></pre><br/>
<span style="color: #a72f79"><span style="font-size: small">(14:28:27)</span> <b>andrew.melo:</b></span> NM, that looks like a periodic task and not related to the actual transfer<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:31:49)</span> <b>andrew.melo:</b></span> Interesting .. possibly a goof with IPV6 support?<br/><pre><br/>[pid  8619] writev(21, [{"\3773\0\0\n\0\0)", 8}, {"\0\1", 2}, {"\0", 1}, {"\240\0\0 \10", 5}, {"\0\33", 2}, {"/store/ONLYATVANDY-LFS.txt\0", 27}, {"\0\0", 2}, {"\0\0", 2}], 8) = 49<br/>[pid  7583] &lt;... recvfrom resumed&gt; "\3773\0\0\1\0\0G", 8, MSG_WAITALL, NULL, NULL) = 8<br/>[pid  7583] recvfrom(21, "\0\0\0\1No servers are reachable via public IPv6 network to read the file.\0", 71, MSG_WAITALL, NULL, NULL) = 71<br/>[pid  7583] recvfrom(21,  &lt;unfinished ...&gt;<br/>[pid  8619] gettid()                    = 8619<br/>[pid  8619] write(2, "191011 14:30:54 8619 ", 21) = 21<br/>[pid  8619] write(2, "meloam.18744:6@gw346", 20) = 20<br/>[pid  8619] write(2, " ", 1)            = 1<br/>[pid  8619] write(2, "Xrootd", 6)       = 6<br/>[pid  8619] write(2, "Response", 8)     = 8<br/>[pid  8619] write(2, ": ", 2)           = 2<br/>[pid  8619] write(2, "0100 ", 5)        = 5<br/>[pid  8619] write(2, "sending err ", 12) = 12<br/>[pid  8619] write(2, "3005", 4)         = 4<br/>[pid  8619] write(2, ": ", 2)           = 2<br/>[pid  8619] write(2, "\n", 1)           = 1<br/>[pid  8619] writev(6, [{"\1\0\17\243\0\0\0\5", 8}, {"\0\0\v\275", 4}, {"\0", 1}], 3) = 13<br/>[pid  8619] poll([{fd=6, events=POLLIN|POLLRDNORM}], 1, 3000) = 1 ([{fd=6, revents=POLLIN|POLLRDNORM}])<br/>[pid  8619] recvfrom(6, "", 24, 0, NULL, NULL) = 0<br/>[pid  8619] gettid()                    = 8619<br/>[pid  8619] writev(2, [{"191011 14:30:54 8619 ", 21}, {"Xrootd", 6}, {"Xeq", 3}, {": ", 2}, {"meloam.18744:6@gw346", 20}, {" ", 1}, {"disc", 4}, {" ", 1}, {"0:00:00", 7}, {"\n", 1}], 10) = 66<br/>[pid  8619] sendto(22, "t\30\0008]\240\321\312\340\0\0\0\35\211\4H]\240\330n]\240\330n\320\0\0\0\0\0\0\0\0\0\0\0\0\0\0\f\340\0\0\0\35\211\4H]\240\330x]\240\330x", 56, 0, {sa_family=AF_INET, sin_port=htons(9930), sin_addr=inet_addr("169.228.130.91")}, 28) = 56<br/>[pid  8619] gettid()                    = 8619<br/>[pid  8619] write(2, "191011 14:30:54 8619 ", 21) = 21<br/>[pid  8619] write(2, "Xrootd", 6)       = 6<br/>[pid  8619] write(2, "Monitor", 7)      = 7<br/>[pid  8619] write(2, ": ", 2)           = 2<br/>[pid  8619] write(2, "56", 2)           = 2<br/>[pid  8619] write(2, " bytes sent to ", 15) = 15<br/>[pid  8619] write(2, "<a href="http://xrootd.t2.ucsd.edu:9930">xrootd.t2.ucsd.edu:9930</a>", 23) = 23<br/>[pid  8619] write(2, " rc=", 4)         = 4<br/>[pid  8619] write(2, "0", 1)            = 1<br/>[pid  8619] write(2, "\n", 1)           = 1<br/></pre><br/>
<span style="color: #e06b56"><span style="font-size: small">(14:35:35)</span> <b>jthiltges:</b></span> Hrm. Any other interesting bits for <tt>[pid  8619]</tt> a bit earlier?<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:37:08)</span> <b>andrew.melo:</b></span> looks like the GSI handshake stuff followed by the "you logged in" message<br/><pre><br/>[pid  8619] writev(2, [{"191011 14:30:54 8619 ", 21}, {"Xrootd", 6}, {"Xeq", 3}, {": ", 2}, {"meloam.18744:6@gw346", 20}, {" ", 1}, {"pub IPv4 login as", 17}, {" ", 1}, {"/DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=meloam/CN=692113/CN=Andrew Malone Melo", 82}, {"\n", 1}], 10) = 154<br/>[pid  8619] poll([{fd=6, events=POLLIN|POLLRDNORM}], 1, 3000) = 1 ([{fd=6, revents=POLLIN|POLLRDNORM}])<br/>[pid  8619] recvfrom(6, "\1\0\v\302\0\0\4P\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\32", 24, 0, NULL, NULL) = 24<br/>[pid  8619] gettid()                    = 8619<br/>[pid  8619] write(2, "191011 14:30:54 8619 ", 21) = 21<br/>[pid  8619] write(2, "meloam.18744:6@gw346", 20) = 20<br/>[pid  8619] write(2, " ", 1)            = 1<br/>[pid  8619] write(2, "Xrootd", 6)       = 6<br/>[pid  8619] write(2, "Protocol", 8)     = 8<br/>[pid  8619] write(2, ": ", 2)           = 2<br/>[pid  8619] write(2, "0100 ", 5)        = 5<br/>[pid  8619] write(2, "req=", 4)         = 4<br/>[pid  8619] write(2, "open", 4)         = 4<br/>[pid  8619] write(2, " dlen=", 6)       = 6<br/>[pid  8619] write(2, "26", 2)           = 2<br/>[pid  8619] write(2, "\n", 1)           = 1<br/>[pid  8619] poll([{fd=6, events=POLLIN|POLLRDNORM}], 1, 3000) = 1 ([{fd=6, revents=POLLIN|POLLRDNORM}])<br/>[pid  8619] recvfrom(6, "/store/ONLYATVANDY-LFS.txt", 26, 0, NULL, NULL) = 26<br/>[pid  8619] gettid()                    = 8619<br/>[pid  8619] write(2, "191011 14:30:54 8619 ", 21) = 21<br/>[pid  8619] write(2, "meloam.18744:6@gw346", 20) = 20<br/>[pid  8619] write(2, " ", 1)            = 1<br/>[pid  8619] write(2, "Xrootd", 6)       = 6<br/>[pid  8619] write(2, "Protocol", 8)     = 8<br/>[pid  8619] write(2, ": ", 2)           = 2<br/>[pid  8619] write(2, "0100 ", 5)        = 5<br/>[pid  8619] write(2, "open ", 5)        = 5<br/>[pid  8619] write(2, "rat", 3)          = 3<br/>[pid  8619] write(2, " ", 1)            = 1<br/>[pid  8619] write(2, "/store/ONLYATVANDY-LFS.txt", 26) = 26<br/>[pid  8619] write(2, "\n", 1)           = 1<br/>[pid  8619] writev(21, [{"\3773\0\0\n\0\0)", 8}, {"\0\1", 2}, {"\0", 1}, {"\240\0\0 \10", 5}, {"\0\33", 2}, {"/store/ONLYATVANDY-LFS.txt\0", 27}, {"\0\0", 2}, {"\0\0", 2}], 8) = 49<br/></pre><br/>
<span style="color: #e06b56"><span style="font-size: small">(14:56:04)</span> <b>jthiltges:</b></span> I'm running out of ideas. Only thing I've got is that 3005 suggests kXR_FSError maybe?<br/><a href="https://github.com/xrootd/xrootd/blob/master/src/XProtocol/XProtocol.hh#L334">https://github.com/xrootd/xrootd/blob/master/src/XProtocol/XProtocol.hh#L334</a><br/>
<span style="color: #a72f79"><span style="font-size: small">(14:56:52)</span> <b>andrew.melo:</b></span> Well there's no public ipv6 addresses on either the client or the server itself, so the fact that it's blowing up with <tt>No servers are reachable via public IPv6 </tt> is suspicious<br/>
<span style="color: #e06b56"><span style="font-size: small">(15:00:54)</span> <b>jthiltges:</b></span> Hrm. That's a cmsd message, I think. Maybe enable debug logging there too?<br/>
<span style="color: #a72f79"><span style="font-size: small">(15:07:36)</span> <b>andrew.melo:</b></span> Brb 30<br/>
<span style="color: #a72f79"><span style="font-size: small">(16:49:06)</span> <b>andrew.melo:</b></span> For giggles, I moved the redirector config as-is to <a href="http://xrootd-vanderbilt.sites.opensciencegrid.org:1096">xrootd-vanderbilt.sites.opensciencegrid.org:1096</a> and it's also behaving the same way....<br/>
<span style="color: #a72f79"><span style="font-size: small">(19:53:51)</span> <b>andrew.melo:</b></span> Extra giggles, deleted some lines and now it works<br/>
</body>
</html>
