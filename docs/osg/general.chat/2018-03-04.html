<!DOCTYPE html>
<html>
<head>
<title>Sun Mar 4, 2018 : #general (osg)</title>
</head>
<body>
<h3>Sun Mar 4, 2018 : #general (osg)</h3>
<span style="color: #a2a5dc"><span style="font-size: small">(17:10:10)</span> <b>james.clark:</b></span> <b>@channel</b> Can somebody confirm that <tt>+DESIRED_sites="Nebraska"</tt>  would be the correct directive to put in my submission file for an OSG job I want to run only at Nebraska ?<br/>
<span style="color: #965d1b"><span style="font-size: small">(17:10:38)</span> <b>briedel:</b></span> @james.clark no, you are just stating a preference<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(17:11:35)</span> <b>james.clark:</b></span> ah, thanks!   is there a way to restrict exclusively to a given site?<br/>
<span style="color: #965d1b"><span style="font-size: small">(17:13:18)</span> <b>briedel:</b></span> in the <tt>requirements</tt> you will need to state <tt>GLIDEIN_ResourceName == "&lt;insert nebraska site you wanted to restrict yourself to?"</tt><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(17:13:43)</span> <b>james.clark:</b></span> perfect, i'll give that a go<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(17:55:00)</span> <b>james.clark:</b></span> ok, that's definitely doing something different.  but I'm getting zero matches which satisfy the requirements.   I'm fairly sure this has the correct resource name:<br/><tt>requirements = GLIDEIN_ResourceName == "LIGO-CIT"</tt><br/>is there somewhere i can check resource names?<br/>
<span style="color: #e7392d"><span style="font-size: small">(17:59:38)</span> <b>bala:</b></span> For osg connect, I check the pool by  <tt>condor_status -pool <a href="http://osg-flock.grid.iu.edu">osg-flock.grid.iu.edu</a> -af GLIDEIN_Site  | sort  | uniq -c</tt><br/>
<span style="color: #e7392d"><span style="font-size: small">(18:00:06)</span> <b>bala:</b></span> <pre>  306 BNL<br/>     10 BU<br/>    282 Caltech<br/>    366 CancerComputer<br/>      5 CCIN2P3<br/>    128 Cinvestav<br/>    589 Colorado<br/>     96 FIU_HPCOSG_CE<br/>    360 FNAL<br/>   1561 FNAL_GPGrid<br/>     24 GLUEX_US_FSU_HNPGRID<br/>    218 IIT<br/>      1 ISI<br/>     39 Michigan<br/>      7 MIT<br/>    325 MWT2<br/>    146 Nebraska<br/>     19 NIKHEF<br/>    126 NotreDame<br/>     66 NUMEP<br/>      8 Omaha<br/>    118 OSG_IN_IUCAA_SARATHI<br/>     49 OSG_US_GSU_ACORE<br/>    140 OSG_US_NDSU_CCAST_CLUSTER2<br/>    571 OSG_US_NDSU_CCAST_CLUSTER3<br/>    121 OSG_US_WSU_GRID<br/>     48 PuertoRico<br/>     90 SPRACE<br/>   1262 SU-OG<br/>      3 SURFsara<br/>     10 SWT2<br/>    183 UCD<br/>    567 UChicago<br/>    184 UConn<br/>    426 UCR<br/>     39 UCSD<br/>    698 undefined<br/>     23 UNESP<br/>     20 UTA<br/>    141 Wisconsin<br/>      1 XSEDE<br/></pre><br/>
<span style="color: #e7392d"><span style="font-size: small">(18:01:35)</span> <b>bala:</b></span> for Nebraska <tt>requirements = GLIDEIN_Site == Nebraska</tt> may find some resources<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:06:33)</span> <b>james.clark:</b></span> still no matches.  Same  situation with Caltech which I really think should be available.   Does anything special need to be configured at the submission site (also caltech) for this requirement?<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:07:23)</span> <b>briedel:</b></span> i am assuming the CIT site might be running through the LIGO infrastructure, so if you aren't the LIGO group it wont match<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:08:38)</span> <b>james.clark:</b></span> I am in LIGO, submitting from a LIGO OSG node, if that's what you mean?<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:08:42)</span> <b>briedel:</b></span> what does <tt>condor_q -better &lt;job_id&gt; -pool <a href="http://osg-flock.grid.iu.edu">osg-flock.grid.iu.edu</a></tt> spit out?<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:08:46)</span> <b>briedel:</b></span> yeah<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:09:34)</span> <b>james.clark:</b></span> waiting for that condor_q output now..<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:09:59)</span> <b>briedel:</b></span> i mean you also might going through a different pool<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:10:13)</span> <b>briedel:</b></span> i am not superfamiliar with the LIGO setup<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:10:38)</span> <b>james.clark:</b></span> ah, i don't think so - the node i'm on is certainly supposed to be the OSG pool<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:11:01)</span> <b>james.clark:</b></span> here we go:<br/><pre><br/>[jclark@ldas-osg] $ condor_q -better 2322369.0 -pool <a href="http://osg-flock.grid.iu.edu">osg-flock.grid.iu.edu</a><br/><br/><br/>-- Schedd: <a href="http://ldas-osg.ligo.caltech.edu">ldas-osg.ligo.caltech.edu</a> : &lt;131.215.113.204:9615?...<br/>The Requirements expression for job 2322369.000 is<br/><br/>    ( GLIDEIN_ResourceName == Caltech ) &amp;&amp; ( TARGET.Arch == "X86_64" ) &amp;&amp; ( TARGET.OpSys == "LINUX" ) &amp;&amp; ( TARGET.Disk &gt;= RequestDisk ) &amp;&amp;<br/>    ( TARGET.Memory &gt;= RequestMemory ) &amp;&amp; ( TARGET.HasFileTransfer )<br/><br/>Job 2322369.000 defines the following attributes:<br/><br/>    RequestDisk = 1<br/>    RequestMemory = 1024<br/><br/>The Requirements expression for job 2322369.000 reduces to these conditions:<br/><br/>         Slots<br/>Step    Matched  Condition<br/>-----  --------  ---------<br/>[0]           0  GLIDEIN_ResourceName == Caltech<br/><br/>No successful match recorded.<br/>Last failed match: Sun Mar  4 16:09:37 2018<br/><br/>Reason for last match failure: no match found <br/><br/>2322369.000:  Run analysis summary ignoring user priority.  Of 9299 machines,<br/>   8888 are rejected by your job's requirements <br/>      0 reject your job because of their own requirements <br/>    411 are exhausted partitionable slots <br/>      0 match and are already running your jobs <br/>      0 match but are serving other users <br/>      0 are available to run your job<br/><br/>WARNING:  Be advised:<br/>   No machines matched the jobs's constraints<br/></pre><br/>
<span style="color: #965d1b"><span style="font-size: small">(18:11:57)</span> <b>briedel:</b></span> you can also try <tt>GLIDEIN_Site</tt> in the requirements<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:12:27)</span> <b>briedel:</b></span> so this could also be setup such there is a special caltech flocking node<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:16:07)</span> <b>james.clark:</b></span> I have exactly the same result at Nebraska.  Isn't it strange that it doesn't even find that site?<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:16:25)</span> <b>james.clark:</b></span> as in <tt>requirements = GLIDEIN_Site == Nebraska</tt><br/>
<span style="color: #965d1b"><span style="font-size: small">(18:16:47)</span> <b>briedel:</b></span> yeah<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:17:50)</span> <b>bala:</b></span> maybe your pool is not <tt><a href="http://osg-flock.grid.iu.edu">osg-flock.grid.iu.edu</a></tt> and something else<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:21:02)</span> <b>briedel:</b></span> you can check the possible pools through <tt>/etc/condor/config.d/30-flocking.conf</tt><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:22:13)</span> <b>james.clark:</b></span> hmm:<br/><pre>[jclark@ldas-osg] $ ls /etc/condor/config.d/30-flocking.conf<br/>ls: cannot access /etc/condor/config.d/30-flocking.conf: No such file or directory</pre><br/>
<span style="color: #965d1b"><span style="font-size: small">(18:22:33)</span> <b>briedel:</b></span> mhh check if there is a flocking config in <tt>/etc/condor/config.d/</tt><br/>
<span style="color: #e7392d"><span style="font-size: small">(18:22:58)</span> <b>bala:</b></span> how about <tt>condor_config_val flock_to</tt><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:24:23)</span> <b>james.clark:</b></span> there's a <tt>/etc/condor/config.d/90_flock_to_osg.config</tt>  with <tt>FLOCK_TO = <a href="http://osg-ligo-1.t2.ucsd.edu">osg-ligo-1.t2.ucsd.edu</a></tt><br/>
<span style="color: #965d1b"><span style="font-size: small">(18:24:42)</span> <b>briedel:</b></span> yeah so try that url as the pool<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:26:02)</span> <b>james.clark:</b></span> is there a way to do that without logging in?<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:28:27)</span> <b>briedel:</b></span> to the schedd host?<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:29:06)</span> <b>bala:</b></span> <pre> $ condor_status -pool <a href="http://osg-ligo-1.t2.ucsd.edu">osg-ligo-1.t2.ucsd.edu</a> -af GLIDEIN_Site  | sort  | uniq -c<br/>      1 FNAL_GPGrid<br/>      3 Nebraska<br/>      6 NIKHEF<br/>      2 OSG_IN_IUCAA_SARATHI<br/>      2 RAL<br/>      1 UChicago<br/>      1 Wisconsin </pre><br/>
<span style="color: #e7392d"><span style="font-size: small">(18:29:09)</span> <b>bala:</b></span> ```<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:29:23)</span> <b>james.clark:</b></span> i mean how can i set the pool when i submit?<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:29:40)</span> <b>briedel:</b></span> it will be set automatically through the config<br/>
<span style="color: #965d1b"><span style="font-size: small">(18:30:12)</span> <b>briedel:</b></span> it is just doesnt really do the right thing for <tt>condor_status</tt>, etc.<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:30:14)</span> <b>bala:</b></span> hmm.. your pool looks a lot different than the one in OSG connect<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:34:01)</span> <b>bala:</b></span> in any case, requirements = GLIDEIN_Site == Nebraska should work I think since it is listed in the pool currently.<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:34:22)</span> <b>james.clark:</b></span> yeah, trying a couple of the other ones in that list<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:35:51)</span> <b>bala:</b></span> is there a particular reason to target a specific resource like Nebraska or you just want to try and see how to target<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:37:25)</span> <b>bala:</b></span> Because generic job submissions go through the queue quickly<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:38:43)</span> <b>james.clark:</b></span> yes, this is just for testing a singularity container (and also to learn how)<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:39:26)</span> <b>bala:</b></span> cool! sounds good<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:40:34)</span> <b>bala:</b></span> for singularity, i think we have additional requirement <tt>HAS_SINGULARITY == True</tt><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:40:37)</span> <b>james.clark:</b></span> right, they're built and deployed at caltech and my jobs always land there first - just want to be sure it's generally useable across the OSG (same results  at NIKHEF and a few others)<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:41:43)</span> <b>bala:</b></span> ah i see your point<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:42:13)</span> <b>bala:</b></span> i agree, it is a good idea to check these stuffs<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:42:14)</span> <b>james.clark:</b></span> HAS_SINGULARITY  also leaves jobs idling in the past.  but maybe that's a caltech-specific issue<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:44:20)</span> <b>bala:</b></span> @rynge wrote a tutorial for osg connect that talks about getting machine classAdds. let me get the command.<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:46:03)</span> <b>james.clark:</b></span> thanks!  this is to identify the appropriate requirement to target sites, right?<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:46:36)</span> <b>bala:</b></span> yes, you can get the full classAdd of a machine. By going through it you will get a good idea what are available on which target site<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:49:19)</span> <b>bala:</b></span> ok here is the tutorial <tt><a href="https://swc-osg-workshop.github.io/OSG-UserTraining-AHM18/novice/DHTC/04-HTCondor-Submitting.html">https://swc-osg-workshop.github.io/OSG-UserTraining-AHM18/novice/DHTC/04-HTCondor-Submitting.html</a></tt><br/>
<span style="color: #e7392d"><span style="font-size: small">(18:49:57)</span> <b>bala:</b></span> you can search for classadd<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:50:15)</span> <b>bala:</b></span> <pre>$ condor_status -pool <a href="http://osg-flock.grid.iu.edu">osg-flock.grid.iu.edu</a> -af Name | head -n 1<br/>[resource name]<br/>$ condor_status -long -pool <a href="http://osg-flock.grid.iu.edu">osg-flock.grid.iu.edu</a> [resource name] | sort </pre><br/>
<span style="color: #e7392d"><span style="font-size: small">(18:50:26)</span> <b>bala:</b></span> you can substitute your pool name<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:50:39)</span> <b>bala:</b></span> well it did not gave me a lot of info<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:51:41)</span> <b>bala:</b></span> you can also try <tt>condor_status -pool <a href="http://osg-ligo-1.t2.ucsd.edu">osg-ligo-1.t2.ucsd.edu</a> -l</tt> to get the full listing.<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:56:10)</span> <b>bala:</b></span> coming back to singularity job. no idea why it waited so long in idle state. anyways good luck with your jobs submissions. maybe later on you can cut and paste here the <tt>bet</tt> analysis results of long waiting idle job so that someone can provide feedback.<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:57:12)</span> <b>james.clark:</b></span> yep, thanks!<br/>
<span style="color: #e7392d"><span style="font-size: small">(18:57:49)</span> <b>bala:</b></span> <tt>condor_q -bet &lt;jobid&gt; -pool &lt;your pool name&gt;</tt><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(18:59:43)</span> <b>james.clark:</b></span> i'll me see i can get them running off-site first<br/>
<span style="color: #e7392d"><span style="font-size: small">(19:00:36)</span> <b>bala:</b></span> sure, sounds good. just pasted the command in case you need them<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(19:03:46)</span> <b>james.clark:</b></span> thanks!<br/>
<span style="color: #674b1b"><span style="font-size: small">(19:29:26)</span> <b>rynge:</b></span> @james.clark Maybe you are doing this already, but note that the names have to be quoted. E.g.: <tt>requirements = GLIDEIN_Site == "Nebraska"</tt><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(19:38:42)</span> <b>james.clark:</b></span> indeed, that exact line gives me:<br/><pre><br/>-----  --------  ---------<br/>[0]           0  GLIDEIN_Site == "Nebraska"<br/><br/>No successful match recorded.<br/></pre><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(19:39:11)</span> <b>james.clark:</b></span> I'll have to call it a night for now, though.   Thanks and I'll try again after travelling tomorrow<br/>
</body>
</html>
