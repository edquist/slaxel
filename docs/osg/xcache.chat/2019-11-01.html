<!DOCTYPE html>
<html>
<head>
<title>Fri Nov 1, 2019 : #xcache (osg)</title>
</head>
<body>
<h3>Fri Nov 1, 2019 : #xcache (osg)</h3>
<span style="color: #43761b"><span style="font-size: small">(10:31:51)</span> <b>blin:</b></span> @efajardo is <tt><a href="http://xcache-11.t2.ucsd.edu">xcache-11.t2.ucsd.edu</a></tt> a CE?<br/>
<span style="color: #43761b"><span style="font-size: small">(10:32:04)</span> <b>blin:</b></span> because it's advertising to the central collector as one<br/>
<span style="color: #43761b"><span style="font-size: small">(10:32:07)</span> <b>blin:</b></span> (cc @isfiligoi)<br/>
<span style="color: #53b759"><span style="font-size: small">(10:32:23)</span> <b>isfiligoi:</b></span> yes<br/>
<span style="color: #53b759"><span style="font-size: small">(10:32:35)</span> <b>isfiligoi:</b></span> it is the portal to PRP<br/>
<span style="color: #53b759"><span style="font-size: small">(10:32:56)</span> <b>isfiligoi:</b></span> heavily used by IceCube and LIGO<br/>
<span style="color: #c386df"><span style="font-size: small">(10:33:02)</span> <b>matyas:</b></span> why's it called xcache-11<br/>
<span style="color: #53b759"><span style="font-size: small">(10:33:08)</span> <b>isfiligoi:</b></span> historical reasons<br/>
<span style="color: #a63024"><span style="font-size: small">(10:48:09)</span> <b>efajardo:</b></span> It is a kuberneteized host<br/>
<span style="color: #a63024"><span style="font-size: small">(10:48:23)</span> <b>efajardo:</b></span> so it has a pod for collector a pod for CE a por for part of the CMS Xcache<br/>
<span style="color: #a63024"><span style="font-size: small">(13:16:37)</span> <b>efajardo:</b></span> Hi <b>@here</b>,<br/>
<span style="color: #a63024"><span style="font-size: small">(13:16:43)</span> <b>efajardo:</b></span> can you remind me how to debug this<br/>
<span style="color: #a63024"><span style="font-size: small">(13:16:46)</span> <b>efajardo:</b></span> <pre>cat /run/stash-cache-auth/Authfile.tmp <br/>&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;<br/>&lt;html&gt;&lt;head&gt;<br/>&lt;title&gt;503 Service Unavailable&lt;/title&gt;<br/>&lt;/head&gt;&lt;body&gt;<br/>&lt;h1&gt;Service Unavailable&lt;/h1&gt;<br/>&lt;p&gt;The server is temporarily unable to service your<br/>request due to maintenance downtime or capacity<br/>problems. Please try again later.&lt;/p&gt;<br/>&lt;/body&gt;&lt;/html&gt;<br/></pre><br/>
<span style="color: #43761b"><span style="font-size: small">(13:17:40)</span> <b>blin:</b></span> looks like <a href="http://topology.opensciencegrid.org">topology.opensciencegrid.org</a> is down? @jthiltges @dweitzel<br/>
<span style="color: #c386df"><span style="font-size: small">(13:18:49)</span> <b>matyas:</b></span> seems back up now<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:18:50)</span> <b>dweitzel:</b></span> topology seems up to me<br/>
<span style="color: #c386df"><span style="font-size: small">(13:19:01)</span> <b>matyas:</b></span> Edgar, try again?<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:20:51)</span> <b>dweitzel:</b></span> the monitoring showed it was down ~an hour ago.<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:20:56)</span> <b>dweitzel:</b></span> for only a few minutes.<br/>
<span style="color: #99a949"><span style="font-size: small">(13:22:23)</span> <b>dwd:</b></span> an oasis machine that reads every 15 minutes from <a href="http://my.opensciencegrid.org">my.opensciencegrid.org</a> failed only at 13:04<br/>
<span style="color: #99a949"><span style="font-size: small">(13:23:56)</span> <b>dwd:</b></span> oasis-login reads every 5 minutes and failed 13:00 through 13:15<br/>
<span style="color: #a63024"><span style="font-size: small">(13:24:00)</span> <b>efajardo:</b></span> nop same prolbme<br/>
<span style="color: #a63024"><span style="font-size: small">(13:24:11)</span> <b>efajardo:</b></span> which command procudes this <tt>Authfile</tt><br/>
<span style="color: #e06b56"><span style="font-size: small">(13:24:18)</span> <b>jthiltges:</b></span> Issues in contacting LIGO LDAP?<br/>
<span style="color: #a63024"><span style="font-size: small">(13:24:57)</span> <b>efajardo:</b></span> hmm ok<br/>
<span style="color: #a63024"><span style="font-size: small">(13:25:03)</span> <b>efajardo:</b></span> I guess they are in downtime<br/>
<span style="color: #a63024"><span style="font-size: small">(13:27:13)</span> <b>efajardo:</b></span> Does topoloy keep a state<br/>
<span style="color: #a63024"><span style="font-size: small">(13:27:20)</span> <b>efajardo:</b></span> like the last Authfile that worked?<br/>
<span style="color: #a63024"><span style="font-size: small">(13:27:48)</span> <b>efajardo:</b></span> I will just upload one from the other caches<br/>
<span style="color: #a63024"><span style="font-size: small">(13:27:53)</span> <b>efajardo:</b></span> I think that should work rigt?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:27:54)</span> <b>blin:</b></span> yeah, that's pretty awful<br/>
<span style="color: #43761b"><span style="font-size: small">(13:28:03)</span> <b>blin:</b></span> err, your solution should work, i think<br/>
<span style="color: #43761b"><span style="font-size: small">(13:28:09)</span> <b>blin:</b></span> but the fact that we're failing this way is awful<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:28:21)</span> <b>jthiltges:</b></span> Ooof. Is it hitting LIGO LDAP for every authfile generation?<br/>
<span style="color: #c386df"><span style="font-size: small">(13:28:23)</span> <b>matyas:</b></span> yeah just shove it into /run/stash-cache-auth/Authfile<br/>
<span style="color: #c386df"><span style="font-size: small">(13:28:45)</span> <b>matyas:</b></span> it's not gonna get overwritten until it works<br/>
<span style="color: #c386df"><span style="font-size: small">(13:29:00)</span> <b>matyas:</b></span> @jthiltges yes it is hitting LIGO LDAP<br/>
<span style="color: #a63024"><span style="font-size: small">(13:29:08)</span> <b>efajardo:</b></span> The problem is xrotod process fails to start if it cannot find it<br/>
<span style="color: #a63024"><span style="font-size: small">(13:29:26)</span> <b>efajardo:</b></span> I will just create new pod and shove in the manual authfile<br/>
<span style="color: #43761b"><span style="font-size: small">(13:30:12)</span> <b>blin:</b></span> i'm getting gateway timeouts to <a href="http://topology.opensciencegrid.org">topology.opensciencegrid.org</a><br/>
<span style="color: #43761b"><span style="font-size: small">(13:30:26)</span> <b>blin:</b></span> it works some of the time?<br/>
<span style="color: #c386df"><span style="font-size: small">(13:33:47)</span> <b>matyas:</b></span> I'm not sure what the behavior _should_ be if LIGO LDAP is down<br/>
<span style="color: #c386df"><span style="font-size: small">(13:33:51)</span> <b>matyas:</b></span> fail open? fail closed?<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:34:41)</span> <b>jthiltges:</b></span> Fail to the last version?<br/>
<span style="color: #c386df"><span style="font-size: small">(13:34:45)</span> <b>matyas:</b></span> if there is one<br/>
<span style="color: #43761b"><span style="font-size: small">(13:34:54)</span> <b>blin:</b></span> yeah, we should keep a cache<br/>
<span style="color: #c386df"><span style="font-size: small">(13:35:43)</span> <b>matyas:</b></span> where? the webapp is soorta stateless<br/>
<span style="color: #43761b"><span style="font-size: small">(13:36:36)</span> <b>blin:</b></span> sorta?<br/>
<span style="color: #c386df"><span style="font-size: small">(13:37:31)</span> <b>matyas:</b></span> well it does hold a cache of the parsed yaml stuff for 5-15 minutes (depending on which data) but each copy of the webapp holds its own cache and there are 8 copies<br/>
<span style="color: #c386df"><span style="font-size: small">(13:37:49)</span> <b>matyas:</b></span> instance, not copy<br/>
<span style="color: #43761b"><span style="font-size: small">(13:38:11)</span> <b>blin:</b></span> 8 instances?<br/>
<span style="color: #c386df"><span style="font-size: small">(13:38:39)</span> <b>matyas:</b></span> yeah that's how it works. apache starts up the webapp 8 times so it can handle multiple connections<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:38:55)</span> <b>jthiltges:</b></span> We could toss memcached on there, or something. (single shared cache for all the workers)<br/>
<span style="color: #c386df"><span style="font-size: small">(13:38:58)</span> <b>matyas:</b></span> because the webapp itself is single-threaded<br/>
<span style="color: #c386df"><span style="font-size: small">(13:39:23)</span> <b>matyas:</b></span> memcached might be useful; never tried it before<br/>
</body>
</html>
