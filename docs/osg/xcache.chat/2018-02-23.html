<!DOCTYPE html>
<html>
<head>
<title>Fri Feb 23, 2018 : #xcache (osg)</title>
</head>
<body>
<h3>Fri Feb 23, 2018 : #xcache (osg)</h3>
<span style="color: #A82F2F"><span style="font-size: small">(15:15:21)</span> <b>gfarr:</b></span> good afternoon. I’m seeing the admin path <tt>/var/spool/xrootd</tt> fill up the root partition on one of my stashcache machines. can I limit the amount of data thats stored in the admin path via an xrootd conf?<br/>
<span style="color: #53b759"><span style="font-size: small">(15:28:43)</span> <b>marian:</b></span> hi @gfarr... could you list what you have in that directory? that path should be for core and other supporting files to run xrootd process, I believe ... unless you specify things otherwise in the config...<br/>
<span style="color: #A82F2F"><span style="font-size: small">(15:30:47)</span> <b>gfarr:</b></span> @marian, sure. there is the subdirectory <tt>stashcache-cache-server</tt> and its indeed filled with core files and one 0 byte file named <tt>ofsEvents</tt><br/>
<span style="color: #A82F2F"><span style="font-size: small">(15:31:11)</span> <b>gfarr:</b></span> 175 core files to be exact<br/>
<span style="color: #53b759"><span style="font-size: small">(15:35:43)</span> <b>marian:</b></span> oh ... which of those core files are most recent and what's size of it?<br/>
<span style="color: #53b759"><span style="font-size: small">(15:37:08)</span> <b>marian:</b></span> what's the hostname of your cache btw and what you specify in the pss.origin line in the xrootd config, please?<br/>
<span style="color: #A82F2F"><span style="font-size: small">(15:41:06)</span> <b>gfarr:</b></span> today and yesterday’s core files are as follows:<br/><pre><br/>-rw------- 1 xrootd xrootd 2.8G Feb 22 11:21 core.3980194<br/>-rw------- 1 xrootd xrootd 1.9G Feb 22 12:32 core.4016647<br/>-rw------- 1 xrootd xrootd 2.0G Feb 22 14:21 core.4020807<br/>-rw------- 1 xrootd xrootd 2.0G Feb 22 16:26 core.4025134<br/>-rw------- 1 xrootd xrootd 2.2G Feb 22 17:23 core.4029346<br/>-rw------- 1 xrootd xrootd 2.1G Feb 22 18:27 core.4032058<br/>-rw------- 1 xrootd xrootd 2.0G Feb 22 20:19 core.4034951<br/>-rw------- 1 xrootd xrootd 2.3G Feb 22 21:41 core.4039551<br/>-rw------- 1 xrootd xrootd 1.9G Feb 22 23:32 core.4042868<br/>-rw------- 1 xrootd xrootd 2.1G Feb 23 03:27 core.4047303<br/>-rw------- 1 xrootd xrootd    0 Feb 23 10:02 core.4055530<br/>-rw------- 1 xrootd xrootd 2.5G Feb 23 11:37 core.4067315<br/>-rw------- 1 xrootd xrootd 2.1G Feb 23 13:36 core.4071746<br/></pre><br/><br/>hostname in question is <a href="http://stashcache.grid.uchicago.edu">stashcache.grid.uchicago.edu</a><br/><br/>pss.origin line<br/><pre><br/>[gfarr@stashcache ~]$ grep pss.origin /etc/xrootd/xrootd-stashcache-cache-server.cfg <br/>pss.origin <a href="http://redirector.osgstorage.org:1094">redirector.osgstorage.org:1094</a><br/></pre><br/>
<span style="color: #53b759"><span style="font-size: small">(15:56:36)</span> <b>marian:</b></span> that is a lot of core files! you can remove some older ones get some space on disk ... and what's in the xrootd logs before crash? anything in the system logs /var/log/messages when it crashes?<br/>
<span style="color: #A82F2F"><span style="font-size: small">(15:56:45)</span> <b>gfarr:</b></span> let me see<br/>
<span style="color: #53b759"><span style="font-size: small">(15:56:51)</span> <b>marian:</b></span> and also what version of xrootd, please<br/>
<span style="color: #A82F2F"><span style="font-size: small">(15:57:57)</span> <b>gfarr:</b></span> xrootd version to start:<br/><pre><br/>[gfarr@stashcache ~]$ rpm -qa | grep xrootd<br/>xrootd-client-libs-4.7.1-1.osg33.el7.x86_64<br/>xrootd-libs-4.7.1-1.osg33.el7.x86_64<br/>xrootd-server-libs-4.7.1-1.osg33.el7.x86_64<br/>xrootd-python-4.7.1-1.osg33.el7.x86_64<br/>xrootd-server-4.7.1-1.osg33.el7.x86_64<br/></pre><br/><br/>checking <tt>/var/log/messages</tt><br/>
<span style="color: #A82F2F"><span style="font-size: small">(15:59:32)</span> <b>gfarr:</b></span> most recent 20 xrootd related entries in <tt>/var/log/messages</tt>:<br/><pre><br/>[gfarr@stashcache ~]$ sudo grep xrootd /var/log/messages | tail -20<br/>Feb 23 10:02:54 stashcache systemd: xrootd@stashcache-cache-server.service: main process exited, code=killed, status=11/SEGV<br/>Feb 23 10:02:54 stashcache systemd: Unit xrootd@stashcache-cache-server.service entered failed state.<br/>Feb 23 10:02:54 stashcache systemd: xrootd@stashcache-cache-server.service failed.<br/>Feb 23 10:02:54 stashcache systemd: xrootd@stashcache-cache-server.service has no holdoff time, scheduling restart.<br/>Feb 23 10:02:54 stashcache systemd: Started XRootD xrootd deamon instance stashcache/cache/server.<br/>Feb 23 10:02:54 stashcache systemd: Starting XRootD xrootd deamon instance stashcache/cache/server...<br/>Feb 23 11:37:11 stashcache kernel: xrootd[4070079]: segfault at 447 ip 00007ff38a713136 sp 00007ff351dc6b10 error 6 in libXrdFileCache-4.so[7ff38a703000+2a000]<br/>Feb 23 11:37:43 stashcache systemd: xrootd@stashcache-cache-server.service: main process exited, code=killed, status=11/SEGV<br/>Feb 23 11:37:43 stashcache systemd: Unit xrootd@stashcache-cache-server.service entered failed state.<br/>Feb 23 11:37:43 stashcache systemd: xrootd@stashcache-cache-server.service failed.<br/>Feb 23 11:37:43 stashcache systemd: xrootd@stashcache-cache-server.service has no holdoff time, scheduling restart.<br/>Feb 23 11:37:43 stashcache systemd: Started XRootD xrootd deamon instance stashcache/cache/server.<br/>Feb 23 11:37:43 stashcache systemd: Starting XRootD xrootd deamon instance stashcache/cache/server...<br/>Feb 23 13:36:14 stashcache kernel: xrootd[4072859]: segfault at 4e1 ip 00007ff78b12c136 sp 00007ff696be8b10 error 6 in libXrdFileCache-4.so[7ff78b11c000+2a000]<br/>Feb 23 13:36:42 stashcache systemd: xrootd@stashcache-cache-server.service: main process exited, code=killed, status=11/SEGV<br/>Feb 23 13:36:42 stashcache systemd: Unit xrootd@stashcache-cache-server.service entered failed state.<br/>Feb 23 13:36:42 stashcache systemd: xrootd@stashcache-cache-server.service failed.<br/>Feb 23 13:36:42 stashcache systemd: xrootd@stashcache-cache-server.service has no holdoff time, scheduling restart.<br/>Feb 23 13:36:42 stashcache systemd: Started XRootD xrootd deamon instance stashcache/cache/server.<br/>Feb 23 13:36:42 stashcache systemd: Starting XRootD xrootd deamon instance stashcache/cache/server...<br/></pre><br/>
<span style="color: #53b759"><span style="font-size: small">(16:02:37)</span> <b>marian:</b></span> would you be willing update to 4.8.1?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:02:54)</span> <b>marian:</b></span> it's in the osg-development, though<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:03:18)</span> <b>gfarr:</b></span> I’ll have to run it by my coworkers<br/>
<span style="color: #53b759"><span style="font-size: small">(16:03:45)</span> <b>marian:</b></span> 4.8.0 is in production release, so at least to that one ... but preferably to 4.8.1<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:03:55)</span> <b>gfarr:</b></span> ok<br/>
<span style="color: #53b759"><span style="font-size: small">(16:06:36)</span> <b>marian:</b></span> and also update to the OSG34 would be great ...<br/>
<span style="color: #53b759"><span style="font-size: small">(16:06:46)</span> <b>marian:</b></span> so could you pass to your colleagues following?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:07:15)</span> <b>marian:</b></span> <pre><br/>rpm -e osg-release<br/>rpm -Uvh <a href="http://repo.grid.iu.edu/osg/3.4/osg-3.4-el7-release-latest.rpm">http://repo.grid.iu.edu/osg/3.4/osg-3.4-el7-release-latest.rpm</a><br/>yum clean all --enablerepo=*<br/>yum update<br/>yum update --enablerepo=osg-development xrootd-*<br/></pre><br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:08:02)</span> <b>gfarr:</b></span> sure<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:13:43)</span> <b>gfarr:</b></span> I’m cleared to do it now, so lets see what happens<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:23:56)</span> <b>gfarr:</b></span> something with the way our puppet is setup isn’t letting me upgrade to OSG 3.4 easily. I’ll poke around and ping you when I get it fixed.<br/>
<span style="color: #53b759"><span style="font-size: small">(16:23:56)</span> <b>marian:</b></span> good, I like Friday changes :wink:<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:24:03)</span> <b>gfarr:</b></span> :upside_down_face:<br/>
<span style="color: #53b759"><span style="font-size: small">(16:24:14)</span> <b>marian:</b></span> sure, good luck!<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:24:18)</span> <b>gfarr:</b></span> thank you<br/>
<span style="color: #53b759"><span style="font-size: small">(16:24:31)</span> <b>marian:</b></span> you can still try without switch to OSG34 ...<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:24:38)</span> <b>gfarr:</b></span> ah ok<br/>
<span style="color: #53b759"><span style="font-size: small">(16:24:39)</span> <b>marian:</b></span> but update xrootd<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:29:24)</span> <b>gfarr:</b></span> osg33 dev repo says xrootd is version 4.8.0-2 while osg33 prod repo has xrootd 4.8.0-1. I’ll update to the prod release first to see how things are.<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:31:12)</span> <b>gfarr:</b></span> upgraded and xrootd service seems happy<br/>
<span style="color: #53b759"><span style="font-size: small">(16:45:39)</span> <b>marian:</b></span> oh<br/>
<span style="color: #53b759"><span style="font-size: small">(16:48:36)</span> <b>marian:</b></span> yes, that's correct, you'd have 4.8.1 available in osg34, though<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:49:33)</span> <b>gfarr:</b></span> ok<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:53:12)</span> <b>gfarr:</b></span> lots of bits flowing into xrootd.log, so I think I’m all set<br/>
<span style="color: #A82F2F"><span style="font-size: small">(16:53:21)</span> <b>gfarr:</b></span> thank you :slightly_smiling_face:<br/>
<span style="color: #53b759"><span style="font-size: small">(17:20:41)</span> <b>marian:</b></span> alright, clean up all core files and lets see if you get new case of crashes ... if so please contact us again ... thanks, @gfarr<br/>
</body>
</html>
