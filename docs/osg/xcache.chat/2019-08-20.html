<!DOCTYPE html>
<html>
<head>
<title>Tue Aug 20, 2019 : #xcache (osg)</title>
</head>
<body>
<h3>Tue Aug 20, 2019 : #xcache (osg)</h3>
<span style="color: #c386df"><span style="font-size: small">(10:35:28)</span> <b>matyas:</b></span> I'm looking at the Kibana graphs for /chtc: &lt; <a href="https://gracc.opensciencegrid.org/kibana/app/kibana#/dashboard/AWG5ztK58IKqxDdAglqh?_g=()&amp;_a=(description:'',filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:AWG5Vxjr4SibPatHSRAw,key:logical_dirname.keyword,negate:!f,type:phrase,value:%2Fchtc),query:(match:(logical_dirname.keyword:(query:%2Fchtc,type:phrase))))),options:(darkTheme:!f),panels:!((col:1,id:AWG5Aphc8IKqxDdAglqg,panelIndex:1,row:1,size_x:6,size_y:5,type:visualization),(col:7,id:AWG5z7gs8IKqxDdAglqi,panelIndex:2,row:1,size_x:6,size_y:3,type:visualization),(col:1,id:AWG53PR88IKqxDdAglqj,panelIndex:3,row:6,size_x:12,size_y:6,type:visualization),(col:1,id:AWG-ZL-88IKqxDdAglqk,panelIndex:4,row:22,size_x:6,size_y:5,type:visualization),(col:1,id:AWIrOP7H8IKqxDdAglqm,panelIndex:6,row:12,size_x:12,size_y:5,type:visualization),(col:1,id:AWYScIbkB7z0d_285O8h,panelIndex:7,row:17,size_x:12,size_y:5,type:visualization),(col:1,id:AWeoT5tlJcJLTeGoCAKf,panelIndex:8,row:27,size_x:12,size_y:5,type:visualization),(col:1,id:AWeppSMIJcJLTeGoCAKg,panelIndex:9,row:32,size_x:12,size_y:5,type:visualization),(col:1,id:AWep4duMJcJLTeGoCAKh,panelIndex:10,row:37,size_x:12,size_y:5,type:visualization)),query:(match_all:()),timeRestore:!f,title:StashCache,uiState:(P-1:(vis:(params:(sort:(columnIndex:2,direction:desc)))),P-10:(vis:(params:(sort:(columnIndex:2,direction:desc)))),P-2:(vis:(defaultColors:('0%20-%20100':'rgb(0,104,55)'))),P-4:(vis:(params:(sort:(columnIndex:!n,direction:!n)))),P-8:(vis:(params:(sort:(columnIndex:1,direction:desc)))),P-9:(vis:(params:(sort:(columnIndex:1,direction:desc))))),viewMode:view)">https://gracc.opensciencegrid.org/kibana/app/kibana#/dashboard/AWG5ztK58IKqxDdAglqh?_g=()&amp;_a=(description:'',filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:AWG5Vxjr4SibPatHSRAw,key:logical_dirname.keyword,negate:!f,type:phrase,value:%2Fchtc),query:(match:(logical_dirname.keyword:(query:%2Fchtc,type:phrase))))),options:(darkTheme:!f),panels:!((col:1,id:AWG5Aphc8IKqxDdAglqg,panelIndex:1,row:1,size_x:6,size_y:5,type:visualization),(col:7,id:AWG5z7gs8IKqxDdAglqi,panelIndex:2,row:1,size_x:6,size_y:3,type:visualization),(col:1,id:AWG53PR88IKqxDdAglqj,panelIndex:3,row:6,size_x:12,size_y:6,type:visualization),(col:1,id:AWG-ZL-88IKqxDdAglqk,panelIndex:4,row:22,size_x:6,size_y:5,type:visualization),(col:1,id:AWIrOP7H8IKqxDdAglqm,panelIndex:6,row:12,size_x:12,size_y:5,type:visualization),(col:1,id:AWYScIbkB7z0d_285O8h,panelIndex:7,row:17,size_x:12,size_y:5,type:visualization),(col:1,id:AWeoT5tlJcJLTeGoCAKf,panelIndex:8,row:27,size_x:12,size_y:5,type:visualization),(col:1,id:AWeppSMIJcJLTeGoCAKg,panelIndex:9,row:32,size_x:12,size_y:5,type:visualization),(col:1,id:AWep4duMJcJLTeGoCAKh,panelIndex:10,row:37,size_x:12,size_y:5,type:visualization)),query:(match_all:()),timeRestore:!f,title:StashCache,uiState:(P-1:(vis:(params:(sort:(columnIndex:2,direction:desc)))),P-10:(vis:(params:(sort:(columnIndex:2,direction:desc)))),P-2:(vis:(defaultColors:('0%20-%20100':'rgb(0,104,55)'))),P-4:(vis:(params:(sort:(columnIndex:!n,direction:!n)))),P-8:(vis:(params:(sort:(columnIndex:1,direction:desc)))),P-9:(vis:(params:(sort:(columnIndex:1,direction:desc))))),viewMode:view)</a> &gt;<br/>
<span style="color: #c386df"><span style="font-size: small">(10:36:11)</span> <b>matyas:</b></span> most of the "bytes read" comes from <a href="http://sc-origin.chtc.wisc.edu">sc-origin.chtc.wisc.edu</a> itself. does that mean that the data isn't being cached?<br/>
<span style="color: #c386df"><span style="font-size: small">(10:36:39)</span> <b>matyas:</b></span> (looking at "working set size by host and directory")<br/>
<span style="color: #c386df"><span style="font-size: small">(10:38:14)</span> <b>matyas:</b></span> it's all shared data (one test user with 100M-13G files)<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:40:07)</span> <b>dweitzel:</b></span> indeed, that is unexpected.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:40:30)</span> <b>dweitzel:</b></span> I would have expected much more sc-cache.chtc* accesses.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:40:33)</span> <b>dweitzel:</b></span> but there are none.<br/>
<span style="color: #c386df"><span style="font-size: small">(10:41:57)</span> <b>matyas:</b></span> that's expected - I asked the user to put HAS_MODULES=?=true in her submit file (because otherwise stashcp might not be available)<br/>
<span style="color: #c386df"><span style="font-size: small">(10:42:02)</span> <b>matyas:</b></span> and we don't have modules in chtc<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:43:17)</span> <b>dweitzel:</b></span> ah, the user is using stashcp...<br/>
<span style="color: #c386df"><span style="font-size: small">(10:45:17)</span> <b>matyas:</b></span> shouldn't they? I mean I'd love to have a file transfer plugin<br/>
<span style="color: #c386df"><span style="font-size: small">(10:50:01)</span> <b>matyas:</b></span> (on that subject, Mark Coatsworth put together an example plugin that also reports on transfer stats: <a href="https://github.com/htcondor/htcondor/blob/master/src/condor_examples/gluster_plugin.py">https://github.com/htcondor/htcondor/blob/master/src/condor_examples/gluster_plugin.py</a> )<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:53:14)</span> <b>dweitzel:</b></span> yeah, that's fine.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:53:27)</span> <b>dweitzel:</b></span> There was a file transfer plugin at one time, but it's certainly not the new and improved version*<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:54:14)</span> <b>dweitzel:</b></span> But CVMFS accesses will NEVER go back to the origin.  stashcp will go back to the origin if the nearest cache fails.<br/>
<span style="color: #c386df"><span style="font-size: small">(10:58:02)</span> <b>matyas:</b></span> stashcp tries CVMFS first<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:59:31)</span> <b>dweitzel:</b></span> yes.<br/>
<span style="color: #c386df"><span style="font-size: small">(11:01:26)</span> <b>matyas:</b></span> you said CVMFS never goes back to the origin. what if all caches fail?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:02:18)</span> <b>dweitzel:</b></span> then CVMFS returns with an IO problem.<br/>
<span style="color: #c386df"><span style="font-size: small">(11:03:14)</span> <b>matyas:</b></span> does CVMFS wait for the cache to fetch from the origin?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:03:42)</span> <b>dweitzel:</b></span> Yes, though that behavior has less to do with CVMFS and more to do with the xrootd cache.<br/>
<span style="color: #c386df"><span style="font-size: small">(11:07:07)</span> <b>matyas:</b></span> the user did report an I/O error from CVMFS: <pre><br/>019-08-16T21:36:13+0000 root         ERROR    Unable to copy with CVMFS, even though file exists: [Errno 5] Input/output error<br/></pre><br/>
<span style="color: #235e5b"><span style="font-size: small">(11:07:40)</span> <b>dweitzel:</b></span> yup, that is what you would see from CVMFS if it is unable to download the file.<br/>
<span style="color: #c386df"><span style="font-size: small">(11:24:51)</span> <b>matyas:</b></span> ... kinda hard for caches to hit our origin IF THEY'RE FIREWALLED OFF<br/>
<span style="color: #c386df"><span style="font-size: small">(11:24:55)</span> <b>***matyas:</b></span> grumbles<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:26:24)</span> <b>dweitzel:</b></span> ah, hitting the infamous CHTC firewall?<br/>
<span style="color: #c386df"><span style="font-size: small">(11:29:38)</span> <b>matyas:</b></span> yeah<br/>
</body>
</html>
