<!DOCTYPE html>
<html>
<head>
<title>Tue Oct 8, 2019 : #xcache (osg)</title>
</head>
<body>
<h3>Tue Oct 8, 2019 : #xcache (osg)</h3>
<span style="color: #a72f79"><span style="font-size: small">(14:33:06)</span> <b>andrew.melo:</b></span> Hi xrootd comrades --<br/>We've got quite a bit of xrootd load (for whatever reason), and the log has a lot of<br/><pre><br/>191008 14:29:11 22429 cmsprod.273:826@red-c2331.unl.edu XrootdProtocol: endsess 32697:762.92765<br/>191008 14:29:11 22429 cmsprod.273:826@red-c2331.unl.edu XrootdProtocol: endsess 32697:762.92765 rc=6 (Resource temporarily unavailable)<br/></pre><br/>Which resource is unavailable? Filehandles? nproc? I'd like to bump whatever the limit is since this box has plenty of headroom, but I don't know what to do<br/>
<span style="color: #43761b"><span style="font-size: small">(14:35:07)</span> <b>blin:</b></span> <b>@here</b> ^^<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:48:36)</span> <b>andrew.melo:</b></span> This isn't terribly helpful.. if I try to strace the whole process, it's just a waterfall of futexes<br/><pre><br/>[root@xrootd1 lfs_roots]# strace -p 7942<br/>strace: Process 7942 attached<br/>clock_gettime(CLOCK_THREAD_CPUTIME_ID, {0, 148382820}) = 0<br/>futex(0x610f58, FUTEX_WAKE_PRIVATE, 1)  = 1<br/>futex(0x610f78, FUTEX_WAKE_PRIVATE, 1)  = 1<br/>writev(1923, [{"\2\0\17\240\0\4\0\0", 8}, {"\333\300\376\203\361\302\227\306\201\334\215_$K\212\351\257U\314'\216\240\376\7\367\254${C\263\375T"..., 262144}], 2) = 262152<br/>futex(0x869db8, FUTEX_WAKE_PRIVATE, 1)  = 1<br/>futex(0x610f58, FUTEX_WAIT_PRIVATE, 0, NULL) = 0<br/>futex(0x7f14c83bb3a8, FUTEX_WAIT_PRIVATE, 2, NULL) = -1 EAGAIN (Resource temporarily unavailable)<br/>clock_gettime(CLOCK_THREAD_CPUTIME_ID, {0, 148847399}) = 0<br/>pread64(33864, "Z0\243\\u\244\203\216\277\26\223O\2\271\243\237\37F\356\0]1\n%\341\273H\302\240B&amp;\250"..., 262144, 1466433536) = 262144<br/>clock_gettime(CLOCK_THREAD_CPUTIME_ID, {0, 149194598}) = 0<br/>futex(0x610f58, FUTEX_WAKE_PRIVATE, 1)  = 1<br/>futex(0x610f78, FUTEX_WAKE_PRIVATE, 1)  = 1<br/>writev(2261, [{"\2\0\17\240\0\4\0\0", 8}, {"\3664\vK 8e\234I/*$\347\201\341t\365X\302\373\317\0268xc!Y\317\225\347:o"..., 262144}], 2) = 262152<br/>futex(0x7f14c83bb3a8, FUTEX_WAKE_PRIVATE, 1) = 1<br/>futex(0x610f58, FUTEX_WAIT_PRIVATE, 0, NULL) = 0<br/>futex(0x610f58, FUTEX_WAIT_PRIVATE, 0, NULL<br/></pre><br/>
<span style="color: #e06b56"><span style="font-size: small">(14:57:12)</span> <b>jthiltges:</b></span> I just noticed that the client was a worker node here at Nebraska. Glancing at logs, this "Redirect limit" entry seems odd to me.<br/><pre>glide_hOINqO/execute/dir_31940/job/WMTaskSpace/cmsRun1/cmsRun1-stdout.log:[2019-10-08 19:50:14.723172 +0000][Warning][XRootD            ] [<a href="http://cmsxrootd.fnal.gov:1094">cmsxrootd.fnal.gov:1094</a>] Redirect limit has been reached for message kXR_open (file: /store/data/Run2017C/BTagCSV/RAW/v1/000/299/478/00000/CAF9D6C1-746D-E711-BA32-02163E01A730.root?tried=<a href="http://xrootd1.accre.vanderbilt.edu">xrootd1.accre.vanderbilt.edu</a>,<a href="http://xrootd-vanderbilt.sites.opensciencegrid.org">xrootd-vanderbilt.sites.opensciencegrid.org</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>,<a href="http://xrootd2.accre.vanderbilt.edu">xrootd2.accre.vanderbilt.edu</a>, mode: 0660, flags: kXR_open_read kXR_async kXR_retstat ), the last known error is: [FATAL] Auth failed</pre><br/><br/>Could that be generating load, or running things out of resources?<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:57:14)</span> <b>andrew.melo:</b></span> (and the futexes are the only thing returning 'resource temporarily unavailable)<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:57:32)</span> <b>andrew.melo:</b></span> well, xrootd2.a.v.e isn't on, so...<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:58:11)</span> <b>andrew.melo:</b></span> well, someone booted that machine without me knowing it.. I'm looking at xrootd1<br/>
</body>
</html>
