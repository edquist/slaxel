<!DOCTYPE html>
<html>
<head>
<title>Mon Apr 24, 2017 : #xcache (osg)</title>
</head>
<body>
<h3>Mon Apr 24, 2017 : #xcache (osg)</h3>
<span style="color: #84b22f"><span style="font-size: small">(11:12:30)</span> <b>ivukotic:</b></span> hi<br/>
<span style="color: #84b22f"><span style="font-size: small">(11:12:52)</span> <b>ivukotic:</b></span> coming back to this - was the change implemented?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:12:53)</span> <b>dweitzel:</b></span> hi<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:12:56)</span> <b>dweitzel:</b></span> no<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:13:13)</span> <b>dweitzel:</b></span> It's on my list.<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:13:20)</span> <b>dweitzel:</b></span> do you have a test file that I can use to check of my changes work?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:13:27)</span> <b>dweitzel:</b></span> somewhere on the xenon1t origin?<br/>
<span style="color: #84b22f"><span style="font-size: small">(11:14:04)</span> <b>ivukotic:</b></span> I will check x1t origin, let’s make sure it works for UC origin<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:14:25)</span> <b>dweitzel:</b></span> well of course.  We already have a battery of tests for the Stash origin.<br/>
<span style="color: #84b22f"><span style="font-size: small">(11:26:59)</span> <b>ivukotic:</b></span> here the file to test:<br/>
<span style="color: #84b22f"><span style="font-size: small">(11:27:00)</span> <b>ivukotic:</b></span> xrdcp  -f  <a href="root://redirector.osgstorage.org://xenon/rucio/x1t_SR001_170419_1605_mv/73/90/XENON1T-0-000008000-000008999-000001000.zip">root://redirector.osgstorage.org://xenon/rucio/x1t_SR001_170419_1605_mv/73/90/XENON1T-0-000008000-000008999-000001000.zip</a> /dev/null<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:27:27)</span> <b>dweitzel:</b></span> ok, I can do that.<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:30:59)</span> <b>dweitzel:</b></span> @ivukotic the stashcp -&gt; ES server is refusing connections (is the daemon turned off)? <a href="http://uct2-collectd.mwt2.org:9951">http://uct2-collectd.mwt2.org:9951</a><br/>
<span style="color: #84b22f"><span style="font-size: small">(14:31:49)</span> <b>ivukotic:</b></span> I was fixing some things this morning and puppet reverted my changes :disappointed:<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:31:55)</span> <b>ivukotic:</b></span> will be up very soon<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:33:45)</span> <b>dweitzel:</b></span> Ok, I have a build of stashcp that works for xenon1t test file.  Do you need recursive copies to work for that host?<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:33:52)</span> <b>ivukotic:</b></span> nice<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:33:56)</span> <b>ivukotic:</b></span> not really<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:34:00)</span> <b>dweitzel:</b></span> ok, good.<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:34:08)</span> <b>dweitzel:</b></span> wanna test the new stashcp?<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:34:13)</span> <b>ivukotic:</b></span> yes<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:36:38)</span> <b>dweitzel:</b></span> k, here's the quick commands: <pre><br/>git clone <a href="https://github.com/djw8605/StashCache-1.git">https://github.com/djw8605/StashCache-1.git</a> StashCache &amp;&amp; cd StashCache<br/>git checkout -b multi_origin origin/multi_origin<br/>./bin/stashcp ...<br/></pre><br/>
<span style="color: #235e5b"><span style="font-size: small">(14:37:04)</span> <b>dweitzel:</b></span> I'll merge and cut a release when I get the green light from you.<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:37:15)</span> <b>ivukotic:</b></span> great<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:51:32)</span> <b>ivukotic:</b></span> ./bin/stashcp -d /user/ivukotic/xAOD_mc.pool.root test.root                                                                                            14:50<br/>2017-04-24T14:50:31+0000 root         DEBUG    Trying geoip site of: <a href="http://cvmfs-egi.gridpp.rl.ac.uk:8000/cvmfs/oasis.opensciencegrid.org">http://cvmfs-egi.gridpp.rl.ac.uk:8000/cvmfs/oasis.opensciencegrid.org</a><br/>2017-04-24T14:50:31+0000 root         DEBUG    Querying for closest cache: <a href="http://cvmfs-egi.gridpp.rl.ac.uk:8000/cvmfs/oasis.opensciencegrid.org/api/v1.0/geo/@proxy@/xrd-cache-1.t2.ucsd.edu,mwt2-stashcache.campuscluster.illinois.edu,hcc-stash.unl.edu,osgxroot.usatlas.bnl.gov,its-condor-xrootd1.syr.edu">http://cvmfs-egi.gridpp.rl.ac.uk:8000/cvmfs/oasis.opensciencegrid.org/api/v1.0/geo/@proxy@/xrd-cache-1.t2.ucsd.edu,mwt2-stashcache.campuscluster.illinois.edu,hcc-stash.unl.edu,osgxroot.usatlas.bnl.gov,its-condor-xrootd1.syr.edu</a><br/>2017-04-24T14:50:32+0000 root         DEBUG    Got error code 200 from <a href="http://cvmfs-egi.gridpp.rl.ac.uk:8000/cvmfs/oasis.opensciencegrid.org">http://cvmfs-egi.gridpp.rl.ac.uk:8000/cvmfs/oasis.opensciencegrid.org</a><br/>2017-04-24T14:50:32+0000 root         DEBUG    Got response [‘1’, ‘3’, ‘2’, ‘5’, ‘4’]<br/>2017-04-24T14:50:32+0000 root         DEBUG    Returning closest cache: <a href="root://xrd-cache-1.t2.ucsd.edu">root://xrd-cache-1.t2.ucsd.edu</a><br/>2017-04-24T14:50:32+0000 root         DEBUG    Using Cache <a href="root://xrd-cache-1.t2.ucsd.edu">root://xrd-cache-1.t2.ucsd.edu</a><br/>2017-04-24T14:50:32+0000 root         DEBUG    Checking if the CVMFS file exists: /cvmfs/stash.osgstorage.org/user/ivukotic/xAOD_mc.pool.root<br/>2017-04-24T14:50:39+0000 root         DEBUG    CVMFS File does not exist<br/>2017-04-24T14:50:39+0000 root         DEBUG    Checking size of file.<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:51:46)</span> <b>ivukotic:</b></span> Traceback (most recent call last):<br/>  File “./bin/stashcp”, line 384, in &lt;module&gt;<br/>    main()<br/>  File “./bin/stashcp”, line 376, in main<br/>    result = doStashCpSingle(sourceFile=source, destination=destination, cache=cache, debug=args.debug)<br/>  File “./bin/stashcp”, line 85, in doStashCpSingle<br/>    (xrdfs_stdout, xrdfs_stderr) = subprocess.Popen([“xrdfs”, main_redirector, “stat”, sourceFile], stdout=subprocess.PIPE).communicate()<br/>  File “/usr/lib64/python2.6/subprocess.py”, line 642, in __init__<br/>    errread, errwrite)<br/>  File “/usr/lib64/python2.6/subprocess.py”, line 1238, in _execute_child<br/>    raise child_exception<br/>OSError: [Errno 2] No such file or directory<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:53:30)</span> <b>dweitzel:</b></span> hum... did you load xrootd module?<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:53:41)</span> <b>dweitzel:</b></span> I think it's complaining about xrdfs not being in the path.<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:53:56)</span> <b>ivukotic:</b></span> so true…<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:54:10)</span> <b>dweitzel:</b></span> yeah, the OSG pilots automatically do that module loading.<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:54:26)</span> <b>ivukotic:</b></span> is there some reason module load does not do it for me?<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:54:54)</span> <b>dweitzel:</b></span> are you on one of the osgconnect hosts?<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:55:18)</span> <b>ivukotic:</b></span> on <a href="http://login.usatlas.org">login.usatlas.org</a><br/>
<span style="color: #84b22f"><span style="font-size: small">(14:55:47)</span> <b>ivukotic:</b></span> now this file works..<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:55:49)</span> <b>dweitzel:</b></span> oh, I'm not sure if that host has the xrootd modules.<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:55:54)</span> <b>dweitzel:</b></span> ok<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:57:51)</span> <b>ivukotic:</b></span> both origins now work as expected.<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:58:01)</span> <b>ivukotic:</b></span> thanks for doing this so quickly<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:58:26)</span> <b>dweitzel:</b></span> no worries.  Wasn't that many changes.<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:58:34)</span> <b>dweitzel:</b></span> I'll cut a release and have bala deploy it.<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:58:39)</span> <b>ivukotic:</b></span> let me (and Bala) know when you have it<br/>
<span style="color: #84b22f"><span style="font-size: small">(14:58:41)</span> <b>ivukotic:</b></span> thanks<br/>
</body>
</html>
