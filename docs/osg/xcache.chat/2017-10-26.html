<!DOCTYPE html>
<html>
<head>
<title>Thu Oct 26, 2017 : #xcache (osg)</title>
</head>
<body>
<h3>Thu Oct 26, 2017 : #xcache (osg)</h3>
<span style="color: #e96699"><span style="font-size: small">(09:49:21)</span> <b>lincoln:</b></span> so just fyi<br/>
<span style="color: #e96699"><span style="font-size: small">(09:49:28)</span> <b>lincoln:</b></span> <pre><br/>[root@stashcache stashcache-cache-server]# rpm -q xrootd-server<br/>xrootd-server-4.6.1-1.osg34.el7.x86_64<br/></pre><br/>
<span style="color: #e96699"><span style="font-size: small">(09:49:36)</span> <b>lincoln:</b></span> <pre><br/>[root@stashcache stashcache-cache-server]# ls -lat<br/>total 178331272<br/>drwx--x--- 2 xrootd xrootd        4096 Oct 26 03:30 .xrootd<br/>-rw------- 1 xrootd xrootd  3830628352 Oct 26 03:30 core.3146765<br/>drwx------ 4 xrootd xrootd        4096 Oct 26 03:29 .<br/>-rw------- 1 xrootd xrootd  4132204544 Oct 25 20:34 core.3127518<br/>-rw------- 1 xrootd xrootd  2117578752 Oct 25 09:32 core.3084360<br/>-rw------- 1 xrootd xrootd  2440765440 Oct 23 17:11 core.3063474<br/>-rw------- 1 xrootd xrootd  2168639488 Oct 22 21:30 core.3050483<br/>-rw------- 1 xrootd xrootd  1506451456 Oct 22 09:20 core.3037825<br/>-rw------- 1 xrootd xrootd  1594298368 Oct 21 21:39 core.3022653<br/>-rw------- 1 xrootd xrootd  1719853056 Oct 21 07:58 core.3008997<br/>-rw------- 1 xrootd xrootd  1885851648 Oct 20 19:03 core.2998280<br/>-rw------- 1 xrootd xrootd  1925730304 Oct 20 09:59 core.2992758<br/>-rw------- 1 xrootd xrootd  1816961024 Oct 20 05:23 core.2984620<br/>-rw------- 1 xrootd xrootd  2815635456 Oct 19 22:48 core.2973645<br/>-rw------- 1 xrootd xrootd  2261766144 Oct 19 12:57 core.2961656<br/>-rw------- 1 xrootd xrootd  1918750720 Oct 19 02:16 core.2949368<br/>-rw------- 1 xrootd xrootd  2271858688 Oct 18 17:56 core.2874173<br/>-rw------- 1 xrootd xrootd  1588359168 Oct 17 00:53 core.2865500<br/>-rw------- 1 xrootd xrootd  1970888704 Oct 16 17:33 core.2830681<br/></pre><br/>
<span style="color: #e96699"><span style="font-size: small">(09:49:47)</span> <b>lincoln:</b></span> etc<br/>
<span style="color: #e96699"><span style="font-size: small">(09:50:36)</span> <b>lincoln:</b></span> osg please fix :disappointed:<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:00:57)</span> <b>bbockelm:</b></span> @marian ^^^<br/>
<span style="color: #53b759"><span style="font-size: small">(10:01:37)</span> <b>marian:</b></span> which host is it, @lincoln?<br/>
<span style="color: #53b759"><span style="font-size: small">(10:04:37)</span> <b>marian:</b></span> would you mind update to <tt>v4.7.1-rc2</tt> which is available in <tt>osg-development</tt> repo? I bet you may be facing several issues we experienced as well at Nebraska and we have <tt>v4.7.1-rc2</tt> under testing ... that'll be shortest way to go now<br/>
<span style="color: #53b759"><span style="font-size: small">(10:05:18)</span> <b>marian:</b></span> assuming this is cache host, not origin<br/>
<span style="color: #e96699"><span style="font-size: small">(10:08:36)</span> <b>lincoln:</b></span> Sure<br/>
<span style="color: #e96699"><span style="font-size: small">(10:10:06)</span> <b>lincoln:</b></span> and yeah it's a cache<br/>
<span style="color: #e96699"><span style="font-size: small">(10:12:28)</span> <b>lincoln:</b></span> OK, running<br/><pre><br/>xrootd-server-4.7.1-0.1.rc2.osg33.el7.x86_64<br/></pre><br/>
<span style="color: #e96699"><span style="font-size: small">(10:12:33)</span> <b>lincoln:</b></span> will let you know if I see any more issues<br/>
<span style="color: #53b759"><span style="font-size: small">(11:24:11)</span> <b>marian:</b></span> excellent, thanks for testing!<br/>
<span style="color: #e7392d"><span style="font-size: small">(11:42:23)</span> <b>bala:</b></span> <pre> $ stashcp /user/dbala/2gb_file1.tar .<br/>[ERROR] Server responded with an error: [3011] No servers are available to read the file.<br/><br/>Unable to find size of file<br/><br/>None<br/></pre><br/>
<span style="color: #e7392d"><span style="font-size: small">(11:43:16)</span> <b>bala:</b></span> the above error was from login01<br/>
<span style="color: #e7392d"><span style="font-size: small">(11:43:40)</span> <b>bala:</b></span> @lincoln @rynge @dweitzel any thoughts<br/>
<span style="color: #e96699"><span style="font-size: small">(11:43:50)</span> <b>lincoln:</b></span> hm<br/>
<span style="color: #e96699"><span style="font-size: small">(11:43:55)</span> <b>lincoln:</b></span> lets see if the origin is still working after the downtime<br/>
<span style="color: #e96699"><span style="font-size: small">(11:44:32)</span> <b>lincoln:</b></span> seems to be<br/>
<span style="color: #e7392d"><span style="font-size: small">(12:06:35)</span> <b>bala:</b></span> stashcp ing a file in public path works<br/>
<span style="color: #e7392d"><span style="font-size: small">(12:06:46)</span> <b>bala:</b></span> $ stashcp /user/dbala/public/2gb_file1.tar . (works fine)<br/>
<span style="color: #e7392d"><span style="font-size: small">(12:13:02)</span> <b>bala:</b></span> <pre> $ stashcp -d /user/dbala/2gb_file1.tar .<br/>2017-10-26T12:12:11+0000 root         DEBUG    Trying geoip site of: <a href="http://klei.nikhef.nl:8000/cvmfs/oasis.opensciencegrid.org">http://klei.nikhef.nl:8000/cvmfs/oasis.opensciencegrid.org</a><br/>2017-10-26T12:12:11+0000 root         DEBUG    Querying for closest cache: <a href="http://klei.nikhef.nl:8000/cvmfs/oasis.opensciencegrid.org/api/v1.0/geo/stashcp/xrd-cache-1.t2.ucsd.edu,mwt2-stashcache.campuscluster.illinois.edu,hcc-stash.unl.edu,osgxroot.usatlas.bnl.gov,its-condor-xrootd1.syr.edu,stashcache.grid.uchicago.edu">http://klei.nikhef.nl:8000/cvmfs/oasis.opensciencegrid.org/api/v1.0/geo/stashcp/xrd-cache-1.t2.ucsd.edu,mwt2-stashcache.campuscluster.illinois.edu,hcc-stash.unl.edu,osgxroot.usatlas.bnl.gov,its-condor-xrootd1.syr.edu,stashcache.grid.uchicago.edu</a><br/>2017-10-26T12:12:11+0000 root         DEBUG    Got error code 200 from <a href="http://klei.nikhef.nl:8000/cvmfs/oasis.opensciencegrid.org">http://klei.nikhef.nl:8000/cvmfs/oasis.opensciencegrid.org</a><br/>2017-10-26T12:12:11+0000 root         DEBUG    Got response ['6', '2', '3', '5', '4', '1']<br/>2017-10-26T12:12:11+0000 root         DEBUG    Returning closest cache: <a href="root://stashcache.grid.uchicago.edu">root://stashcache.grid.uchicago.edu</a><br/>2017-10-26T12:12:11+0000 root         DEBUG    Using Cache <a href="root://stashcache.grid.uchicago.edu">root://stashcache.grid.uchicago.edu</a><br/>2017-10-26T12:12:11+0000 root         DEBUG    Checking if the CVMFS file exists: /cvmfs/stash.osgstorage.org/user/dbala/2gb_file1.tar<br/>2017-10-26T12:12:11+0000 root         DEBUG    CVMFS File does not exist<br/>2017-10-26T12:12:11+0000 root         DEBUG    Checking size of file.<br/>[ERROR] Server responded with an error: [3011] No servers are available to read the file.<br/><br/>Unable to find size of file<br/><br/>None<br/></pre><br/>
<span style="color: #e7392d"><span style="font-size: small">(12:13:23)</span> <b>bala:</b></span> so the debug message says the file does not exist<br/>
<span style="color: #e7392d"><span style="font-size: small">(12:13:38)</span> <b>bala:</b></span> Looks like only the public path works.<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:42:21)</span> <b>rynge:</b></span> Which is correct, right?<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:43:36)</span> <b>rynge:</b></span> We don't want to expose all of stash - that is what public/ is for<br/>
<span style="color: #e7392d"><span style="font-size: small">(13:03:46)</span> <b>bala:</b></span> <pre> $ stashcp -d /user/agmills7/public/testing.txt .<br/>2017-10-26T13:02:11+0000 root         DEBUG    Trying geoip site of: <a href="http://cvmfs-s1bnl.opensciencegrid.org:8000/cvmfs/oasis.opensciencegrid.org">http://cvmfs-s1bnl.opensciencegrid.org:8000/cvmfs/oasis.opensciencegrid.org</a><br/>2017-10-26T13:02:11+0000 root         DEBUG    Querying for closest cache: <a href="http://cvmfs-s1bnl.opensciencegrid.org:8000/cvmfs/oasis.opensciencegrid.org/api/v1.0/geo/stashcp/xrd-cache-1.t2.ucsd.edu,mwt2-stashcache.campuscluster.illinois.edu,hcc-stash.unl.edu,osgxroot.usatlas.bnl.gov,its-condor-xrootd1.syr.edu,stashcache.grid.uchicago.edu">http://cvmfs-s1bnl.opensciencegrid.org:8000/cvmfs/oasis.opensciencegrid.org/api/v1.0/geo/stashcp/xrd-cache-1.t2.ucsd.edu,mwt2-stashcache.campuscluster.illinois.edu,hcc-stash.unl.edu,osgxroot.usatlas.bnl.gov,its-condor-xrootd1.syr.edu,stashcache.grid.uchicago.edu</a><br/>2017-10-26T13:02:11+0000 root         DEBUG    Got error code 200 from <a href="http://cvmfs-s1bnl.opensciencegrid.org:8000/cvmfs/oasis.opensciencegrid.org">http://cvmfs-s1bnl.opensciencegrid.org:8000/cvmfs/oasis.opensciencegrid.org</a><br/>2017-10-26T13:02:11+0000 root         DEBUG    Got response ['6', '2', '3', '5', '4', '1']<br/>2017-10-26T13:02:11+0000 root         DEBUG    Returning closest cache: <a href="root://stashcache.grid.uchicago.edu">root://stashcache.grid.uchicago.edu</a><br/>2017-10-26T13:02:11+0000 root         DEBUG    Using Cache <a href="root://stashcache.grid.uchicago.edu">root://stashcache.grid.uchicago.edu</a><br/>2017-10-26T13:02:11+0000 root         DEBUG    Checking if the CVMFS file exists: /cvmfs/stash.osgstorage.org/user/agmills7/public/testing.txt<br/>2017-10-26T13:02:33+0000 root         ERROR    Unable to copy with CVMFS, even though file exists: [Errno 5] Input/output error: '/cvmfs/stash.osgstorage.org/user/agmills7/public/testing.txt'<br/>2017-10-26T13:02:33+0000 root         DEBUG    Checking size of file.<br/>[ERROR] Server responded with an error: [3011] No servers are available to read the file.<br/><br/>Unable to find size of file<br/><br/>None<br/></pre><br/>
<span style="color: #e7392d"><span style="font-size: small">(13:04:17)</span> <b>bala:</b></span> file exist in public but could not find size<br/>
<span style="color: #e7392d"><span style="font-size: small">(13:05:52)</span> <b>bala:</b></span> also, if we decide to go allowing only public we need to update helpdesk doc.<br/>
<span style="color: #e7392d"><span style="font-size: small">(13:16:48)</span> <b>bala:</b></span> <pre> $ cat /stash/user/agmills7/public/testing.txt <br/>testing<br/></pre><br/>
<span style="color: #e7392d"><span style="font-size: small">(13:17:01)</span> <b>bala:</b></span> <pre> cat  /cvmfs/stash.osgstorage.org/user/agmills7/public/testing.txt<br/>cat: /cvmfs/stash.osgstorage.org/user/agmills7/public/testing.txt: Input/output error</pre><br/>
<span style="color: #e7392d"><span style="font-size: small">(13:17:14)</span> <b>bala:</b></span> probably the file is not properly replicated under cvms path<br/>
<span style="color: #e7392d"><span style="font-size: small">(13:18:22)</span> <b>bala:</b></span> may not be all files or users effected by this. because for me all seems to work fine, but not for <tt>agmills7</tt><br/>
<span style="color: #9e3997"><span style="font-size: small">(14:40:35)</span> <b>bbockelm:</b></span> @dweitzel ^^^ can you look at the <tt>agmills7</tt> example?<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:49:56)</span> <b>dweitzel:</b></span> @marian I think it's a redirector problem.  What is the command to see all the subscribed origins to the reidrector?<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:50:02)</span> <b>dweitzel:</b></span> There's some xrd* command to do it.<br/>
<span style="color: #53b759"><span style="font-size: small">(15:11:15)</span> <b>marian:</b></span> <pre><br/>$ xrdmapc --list all <a href="http://redirector.osgstorage.org:1094">redirector.osgstorage.org:1094</a><br/>0**** <a href="http://redirector.grid.iu.edu:1094">redirector.grid.iu.edu:1094</a><br/>      Srv <a href="http://ceph-gridftp1.grid.uchicago.edu:1094">ceph-gridftp1.grid.uchicago.edu:1094</a><br/>      Srv <a href="http://redirector1.grid.iu.edu:2094">redirector1.grid.iu.edu:2094</a><br/>      Srv <a href="http://csiu.grid.iu.edu:1094">csiu.grid.iu.edu:1094</a><br/>      Srv <a href="http://redirector2.grid.iu.edu:2094">redirector2.grid.iu.edu:2094</a><br/>      Srv <a href="http://stashcache.fnal.gov:1094">stashcache.fnal.gov:1094</a><br/></pre><br/>
<span style="color: #53b759"><span style="font-size: small">(15:14:40)</span> <b>marian:</b></span> are we missing <tt><a href="http://stash.osgconnect.net">stash.osgconnect.net</a></tt> in subscription?<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:22:54)</span> <b>dweitzel:</b></span> yes, yes we are.<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:22:57)</span> <b>dweitzel:</b></span> @lincoln!<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:29:27)</span> <b>bbockelm:</b></span> @marian @dweitzel - something like that should have triggered a monitoring failures.  What "went red"?<br/>
<span style="color: #53b759"><span style="font-size: small">(15:38:17)</span> <b>marian:</b></span> xrootd seems respond on pings to <tt><a href="http://stash.osgconnect.net">stash.osgconnect.net</a></tt>, so no red ... lost subscription we don't monitor via check_mk but we did via RSV which seems turned of since October 16: <a href="http://tinyurl.com/y8r3u9u4">http://tinyurl.com/y8r3u9u4</a> ... I'll write a similar script to what we were doing, compare xrdmapc values for each redirector and trigger an error in case result returned differ<br/>
<span style="color: #53b759"><span style="font-size: small">(19:32:03)</span> <b>marian:</b></span> ^ ticket created: <a href="https://jira.opensciencegrid.org/browse/STAS-28">https://jira.opensciencegrid.org/browse/STAS-28</a><br/>
<span style="color: #53b759"><span style="font-size: small">(19:34:01)</span> <b>marian:</b></span> I also emailed GOC staff with question why RSV tests for StashCache are deactivated since Oct 16 ...<br/>
<span style="color: #53b759"><span style="font-size: small">(19:55:43)</span> <b>marian:</b></span> @lincoln: can you bounce cmsd/xrootd on <tt><a href="http://stash.osgconnect.net">stash.osgconnect.net</a></tt> when you get a chance...<br/>
</body>
</html>
