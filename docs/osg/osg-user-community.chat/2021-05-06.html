<!DOCTYPE html>
<html>
<head>
<title>Thu May 6, 2021 : #osg-user-community (osg)</title>
</head>
<body>
<h3>Thu May 6, 2021 : #osg-user-community (osg)</h3>
<span style="color: #5870dd"><span style="font-size: small">(09:44:33)</span> <b>duncan.macleod:</b></span> hi all (probably especially @dwd), I'm getting this from a host I manage:<br/><pre>$ cvmfs_config probe <a href="http://oasis.opensciencegrid.org">oasis.opensciencegrid.org</a><br/>required configuration repository directory does not exist: /cvmfs/config-osg.opensciencegrid.org/etc/cvmfs<br/>Probing /cvmfs/oasis.opensciencegrid.org... Failed!</pre><br/>I'm not sure what the action is to correct this, anyone able to suggest a fix?<br/>
<span style="color: #99a949"><span style="font-size: small">(09:48:40)</span> <b>dwd:</b></span> As it says, that repository needs to be mounted.  Normally the automounter will automatically mount it.<br/>
<span style="color: #5870dd"><span style="font-size: small">(09:49:07)</span> <b>duncan.macleod:</b></span> yes, that's where I get confused, since I've never had to manually act on config-osg in the past<br/>
<span style="color: #99a949"><span style="font-size: small">(09:49:27)</span> <b>dwd:</b></span> So something’s causing the automounter to not work on that machine<br/>
<span style="color: #99a949"><span style="font-size: small">(09:50:20)</span> <b>dwd:</b></span> To debug, try first accessing /cvmfs/config-osg.opensciencegrid.org and figure out why it’s not mounting.<br/>
<span style="color: #5870dd"><span style="font-size: small">(09:58:39)</span> <b>duncan.macleod:</b></span> so <tt>systemctl status autofs</tt> reported this:<br/><pre>May 06 15:48:58 cl8 cvmfs2[1308535]: could not open debug log file /var/log/cvmfs.log.cachemgr ...ting</pre><br/>(truncated), so I fixed that and the issues with <tt><a href="http://config-osg.opensciencegrid.org">config-osg.opensciencegrid.org</a></tt> are gone, but I still can't probe oasis<br/>
<span style="color: #5870dd"><span style="font-size: small">(10:13:27)</span> <b>duncan.macleod:</b></span> various attempts to unmount oasis so I can restart things:<br/><pre>$ ls /cvmfs/oasis.opensciencegrid.org<br/>ls: cannot access /cvmfs/oasis.opensciencegrid.org: Transport endpoint is not connected<br/>$ umount /cvmfs/oasis.opensciencegrid.org<br/>umount: /cvmfs/oasis.opensciencegrid.org: target is busy.<br/>        (In some cases useful info about processes that use<br/>         the device is found by lsof(8) or fuser(1))<br/>$ umount -f /cvmfs/oasis.opensciencegrid.org<br/>umount: /cvmfs/oasis.opensciencegrid.org: target is busy.<br/>        (In some cases useful info about processes that use<br/>         the device is found by lsof(8) or fuser(1))<br/>$ fusermount -u /cvmfs/oasis.opensciencegrid.org<br/>fusermount: failed to unmount /cvmfs/oasis.opensciencegrid.org: Device or resource busy</pre><br/>
<span style="color: #5870dd"><span style="font-size: small">(10:19:39)</span> <b>duncan.macleod:</b></span> ok, after a random set of <tt>umount -l</tt> , <tt>systemctl restart autofs</tt> , and related commands, I think I have oasis back, thanks Dave<br/>
<span style="color: #684b6c"><span style="font-size: small">(13:39:16)</span> <b>cnatzke:</b></span> Hi Everyone,<br/>When running a docker container on OSG, how is the user handled? When building the container I specified a default user because without it I get some seg-faults related to permission issues. I would imagine the container would run as the default user on the OSG but am not sure.<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:43:55)</span> <b>bbockelm:</b></span> @cnatzke - tends to get squashed to one UID and file permissions get tweaked to world readable.  May or may not be the UID of the invoking user (but guaranteed to not be "real root").<br/>
<span style="color: #684b6c"><span style="font-size: small">(13:46:09)</span> <b>cnatzke:</b></span> Perfect, in my testing I was using the flag <tt>docker run --user $(id -u):$(id -g)</tt> which  caused issues since my container didn’t have my specific user or group.  If I understand your answer correctly this is not something I have to worry about when the container is deployed on the OSG?<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:52:56)</span> <b>bbockelm:</b></span> "Maybe".  For example, I think Singularity may generate a fake <tt>/etc/passwd</tt> file and mount it into the container so your username resolves, regardless of the ID.<br/>
<span style="color: #9e3997"><span style="font-size: small">(14:00:45)</span> <b>bbockelm:</b></span> So there are potentially subtle things like that which might cause differences.<br/>
<span style="color: #9e3997"><span style="font-size: small">(14:00:58)</span> <b>bbockelm:</b></span> Unfortunately there's no good substitute for just testing.<br/>
</body>
</html>
