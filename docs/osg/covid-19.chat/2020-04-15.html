<!DOCTYPE html>
<html>
<head>
<title>Wed Apr 15, 2020 : #covid-19 (osg)</title>
</head>
<body>
<h3>Wed Apr 15, 2020 : #covid-19 (osg)</h3>
<span style="color: #43761b"><span style="font-size: small">(08:26:08)</span> <b>blin:</b></span> the kinds of pilots we're sending is going to differ from site to site<br/>
<span style="color: #43761b"><span style="font-size: small">(08:26:33)</span> <b>blin:</b></span> for instance, BNL is only taking single core pilots<br/>
<span style="color: #43761b"><span style="font-size: small">(08:26:52)</span> <b>blin:</b></span> @jdost321 may have a better idea of the size of pilots available for covid, generally<br/>
<span style="color: #674b1b"><span style="font-size: small">(10:22:28)</span> <b>rynge:</b></span> @dweitzel I think we should just do a mixed workload, some 8 core and some single core<br/>
<span style="color: #674b1b"><span style="font-size: small">(10:23:13)</span> <b>rynge:</b></span> I also think setting JobPrio a little bit higher on the 8 cores ones would help<br/>
<span style="color: #674b1b"><span style="font-size: small">(10:23:39)</span> <b>rynge:</b></span> As we would try to schedule those first and then fill in with the single core ones where the 8 ones do not fit<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:25:36)</span> <b>dweitzel:</b></span> I could do a mixed workload, no problem.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:25:53)</span> <b>dweitzel:</b></span> maybe 1/8 of jobs are 8 core?<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:25:56)</span> <b>dweitzel:</b></span> or 1/4?<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:26:32)</span> <b>dweitzel:</b></span> or should we submit separately and keep track of jobs separately?<br/>
<span style="color: #bc3663"><span style="font-size: small">(11:46:04)</span> <b>dmason:</b></span> are you targetting specific sites with these or sending them all out to the wind to be picked up as slots are open?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:46:58)</span> <b>dweitzel:</b></span> "out to the wind"<br/>
<span style="color: #bc3663"><span style="font-size: small">(12:02:49)</span> <b>dmason:</b></span> I mean submit to the pool and let them match as they will or do you target sites.<br/>
<span style="color: #bc3663"><span style="font-size: small">(12:03:48)</span> <b>dmason:</b></span> ah you are answering the question — I misread a question mark.  OK yes then the single core guys can take over<br/>
<span style="color: #235e5b"><span style="font-size: small">(12:21:35)</span> <b>dweitzel:</b></span> Yup. Answering question. Sorry for the confusion. I liked the wording. <br/>
<span style="color: #5a4592"><span style="font-size: small">(12:23:30)</span> <b>lmichael:</b></span> I’m not suggesting we try to make all sites 8-core. I’m also not suggesting that we choose a specific mix to shoot for, but I don’t see a reason why we should switch existing 8-core pilots to single-core. <br/>
<span style="color: #5a4592"><span style="font-size: small">(12:24:41)</span> <b>lmichael:</b></span> We can decide on a specific mix if/when we have the job pressure to guide us, right?<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:25:44)</span> <b>rynge:</b></span> @dweitzel Yeah, I think we can mix. Probably good to have fewer 8 core idle jobs, but how many is not important<br/>
<span style="color: #43761b"><span style="font-size: small">(12:26:05)</span> <b>blin:</b></span> sure, though i'm wondering what mix of pilots we're sending and if we even have 8 core pilots for covid<br/>
<span style="color: #43761b"><span style="font-size: small">(12:30:03)</span> <b>blin:</b></span> but yeah, we can decide on a specific mix when we get the work<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:30:30)</span> <b>lmichael:</b></span> @brian see prior convo in this channel. We do have 8-core pilots for COVID. @dmason was asking either (now that I re-read his first email) if we wanted to convert some pilots to single-core (for F@h jobs), or if we can make those jobs multi-core for efficiency.<br/>
<span style="color: #43761b"><span style="font-size: small">(12:30:32)</span> <b>blin:</b></span> and maybe we should be nudging sites toward 8 core pilots if we know we'll need them and they can be configured as partitionable anyway?<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:31:48)</span> <b>lmichael:</b></span> It’s not clear to me that #2 is possible (not our jobs), plus multicore F@h jobs couldn’t match to single-core slots (and create more load-balancing complexity). I also don’t think we have reason yet to change the mix of 8-core and single core pilots.<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:33:39)</span> <b>lmichael:</b></span> @blin, yes. We have at least one on-deck project with 8-core needs (right @rynge?), and we will probably get another from the HPCC, which was reviewed and accepted yesterday. (I need to follow up on the provisioning committee’s decision - it may also get cloud credits.)<br/>
<span style="color: #43761b"><span style="font-size: small">(12:34:37)</span> <b>blin:</b></span> makes sense<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:35:12)</span> <b>rynge:</b></span> Here is the current breakdown of the glideins. Count, nrCores<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:35:19)</span> <b>rynge:</b></span> <pre>   9995 1<br/>      5 4<br/>    427 8<br/>     53 16<br/>     13 24<br/>     61 32<br/>     18 40<br/>     19 48<br/>     11 56<br/>     18 64</pre><br/><br/>
<span style="color: #5a4592"><span style="font-size: small">(12:36:49)</span> <b>lmichael:</b></span> For @dmason this is a matter of throughout versus performance. If we can get twice as many slots for F@h jobs by keeping them single-core, their individual job performance would have to be worse than 2X in that mode to not reap the benefit.<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:38:03)</span> <b>rynge:</b></span> I think it is also a way to shorten the jobs so that we don't end up with a straggling long job on those 8 core pilots<br/>
<span style="color: #5a4592"><span style="font-size: small">(12:40:49)</span> <b>lmichael:</b></span> We don’t care if individual jobs spend some time downloading stuff if it’s a minor part of each job’s runtime. Overall throughout across whole batches is more important than single-job efficiency. That’s HTC system-gaming.<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:42:42)</span> <b>rynge:</b></span> No that is not what I'm saying. When we get 8 core slots, and when the glidein retire, worst case is that 7 of the jobs finish, but that 1 last one runs for a long time (maybe until end of glidein). You are now having 7 cores sitting idle<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:43:07)</span> <b>rynge:</b></span> In general this is not a common problem for us (mixed workload, shorter jobs)<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:43:23)</span> <b>rynge:</b></span> But for F@H, we saw the average runtime go up to over 24 hours<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:43:55)</span> <b>rynge:</b></span> And started to see pressure being pulled back from the sites as gwms noticed the idle cores<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:47:09)</span> <b>rynge:</b></span> <br/>
<span style="color: #674b1b"><span style="font-size: small">(12:47:26)</span> <b>rynge:</b></span> Those UnmatchedCores is what we want to avoid<br/>
<span style="color: #5a4592"><span style="font-size: small">(17:00:11)</span> <b>lmichael:</b></span> @rynge if I’m understanding correctly, why are the other 7 cores not accepting new payload jobs in the meantime?<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:00:54)</span> <b>rynge:</b></span> When the glidein has reached retirement age, no new jobs are allowed to start<br/>
<span style="color: #5a4592"><span style="font-size: small">(17:01:37)</span> <b>lmichael:</b></span> So, what is the retirement age relative to ‘death’, and relative to the F@h jobs?<br/>
<span style="color: #5a4592"><span style="font-size: small">(17:01:55)</span> <b>lmichael:</b></span> and is it tunable?<br/>
<span style="color: #5a4592"><span style="font-size: small">(17:02:45)</span> <b>lmichael:</b></span> In other words, why is retirement so long before death that we have so many cores sitting around while a longer job finishes?<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:07:02)</span> <b>rynge:</b></span> It is lifetime - max job lenght<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:07:05)</span> <b>rynge:</b></span> <a href="https://glideinwms.fnal.gov/doc.prd/images/retire_times.png">https://glideinwms.fnal.gov/doc.prd/images/retire_times.png</a><br/>
<span style="color: #674b1b"><span style="font-size: small">(17:07:18)</span> <b>rynge:</b></span> Which is 8 hours for OSG VO<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:07:24)</span> <b>rynge:</b></span> (short in this context)<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:08:09)</span> <b>rynge:</b></span> So if we get a 48 hour glidein, we get 40 hours of starting new jobs, and then up to 8 hours for those jobs to finish<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:08:46)</span> <b>rynge:</b></span> Thinking about it, maybe we want max job length for the covid19 entry at something like 24 hours<br/>
</body>
</html>
