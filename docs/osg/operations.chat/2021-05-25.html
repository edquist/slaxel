<!DOCTYPE html>
<html>
<head>
<title>Tue May 25, 2021 : #operations (osg)</title>
</head>
<body>
<h3>Tue May 25, 2021 : #operations (osg)</h3>
<span style="color: #aba727"><span style="font-size: small">(12:58:53)</span> <b>moate:</b></span> @jthiltges Brian B wanted me to run something by you - this is in reference to the latest entries in <a href="https://support.opensciencegrid.org/a/tickets/66845">Freshdesk ticket 66845 "Switch GLOW glidein startds to use starter to run Singularity, not the USER_JOB_WRAPPER"</a> -  we're seeing glidein jobs going on hold at UNL as follows:<br/><pre>[moate@submit4 OSG_freshdesk66845.0]$ condor_q -hold 1668 -af 'strcat("LastMachine=", regexps("^.*@([^@]+)$", lastremotehost, "\1"), ", ShortHoldReason=", regexps("^[^:]+:\s+(.*)$", HoldReason, "\"\1\""))'  | sort | uniq -c<br/>...<br/>     28 LastMachine=<a href="http://glow-10006616.0-red-c5119.unl.edu">glow-10006616.0-red-c5119.unl.edu</a>, ShortHoldReason="Singularity test failed:ERROR  : No setuid installation found, for unprivileged installation use: ./mconfig --without-suid"<br/>     62 LastMachine=<a href="http://glow-10006843.0-red-c5119.unl.edu">glow-10006843.0-red-c5119.unl.edu</a>, ShortHoldReason="Singularity test failed:ERROR  : No setuid installation found, for unprivileged installation use: ./mconfig --without-suid"</pre><br/>(starting thread)<br/>
<blockquote>
<span style="color: #aba727"><span style="font-size: small">(12:59:30)</span> <b>moate:</b></span> Brian B posits that this is happening because UNL is running pilots inside docker containers<br/>
<span style="color: #aba727"><span style="font-size: small">(12:59:52)</span> <b>moate:</b></span> He says that CMS also runs pilots inside docker containers, but doesn't see this issue<br/>
<span style="color: #aba727"><span style="font-size: small">(13:00:31)</span> <b>moate:</b></span> To quote Brian B directly:<br/>&gt; anyhow, bring that up with the Nebraska folk. It's definitely working for CMS, might be a game of "spot the difference"<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:02:01)</span> <b>jthiltges:</b></span> Interesting. I'll take a look!<br/>
<span style="color: #aba727"><span style="font-size: small">(13:04:30)</span> <b>moate:</b></span> TY!  FYI We've seen the same thing on pilots landing in CHTC, but for a different reason - we temporarily ran a version of HTCondor that disabled setuid in all children of condor_master.  Because the setuid-disabling property is attached to the condor_master process itself and not the code inside condor_master, we've had to restart all condor_master processes older than a certain age.  That's *probably irrelevant* to you, but letting you know just in case.<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:31:35)</span> <b>jthiltges:</b></span> Ugh. Some nodes got a docker image intended for temporary testing. They must have been turned on or kickstarted during testing and I didn't realize. I was testing privileged singularity, and the singularity.conf included<br/><pre>allow setuid = yes</pre><br/>
<span style="color: #e06b56"><span style="font-size: small">(13:44:35)</span> <b>jthiltges:</b></span> Ah. And I think the difference is where CMS and GLOW look for singularity.<br/>I think CMS defaults to using the one on CVMFS, while GLOW seems to be using the local one, and it was failing due to my misconfig.<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:57:55)</span> <b>jthiltges:</b></span> Please let me know if I should dive further into the difference in behavior. Otherwise, I think it should be cleared up from the Nebraska side. I'm seeing new GLOW jobs coming through and getting <tt>HAS_SINGULARITY True</tt>.<br/>
<span style="color: #aba727"><span style="font-size: small">(15:21:58)</span> <b>moate:</b></span> Thanks @jthiltges!  Will let you know if I see any failures<br/>
<span style="color: #aba727"><span style="font-size: small">(15:24:07)</span> <b>moate:</b></span> So far I haven't seen a single failure in the last hour<br/>
<span style="color: #e06b56"><span style="font-size: small">(15:24:26)</span> <b>jthiltges:</b></span> Great!<br/>
</blockquote>
<span style="color: #5a4592"><span style="font-size: small">(13:23:56)</span> <b>lmichael:</b></span> anyone try to contact <a href="mailto:dcshrum@fsu.edu">dcshrum@fsu.edu</a>? <a href="https://support.opensciencegrid.org/a/tickets/67341">https://support.opensciencegrid.org/a/tickets/67341</a><br/>
<span style="color: #aba727"><span style="font-size: small">(15:23:32)</span> <b>moate:</b></span> I need to contact BNL (probably through Freshdesk) to ask for an upgrade to Singularity runtime on execute nodes that pilots land on;  What's the best way to determine the correct contact?<br/>
<span style="color: #43761b"><span style="font-size: small">(15:30:50)</span> <b>blin:</b></span> got any FQDNs? there a few groups at BNL<br/>
<span style="color: #aba727"><span style="font-size: small">(15:34:34)</span> <b>moate:</b></span> @blin generally <tt>acas****.usatlas.bnl.gove</tt>, but they don't resolve external to BNL:<br/><pre>[moate@submit4 OSG_freshdesk66845.0]$ condor_q -hold 1668 -af 'strcat("LastMachine=", regexps("^.*@([^@]+)$", lastremotehost, "\1"), ", ShortHoldReason=", regexps("^[^:]+:\s+(.*)$", HoldReason, "\"\1\""))'  | sort | uniq -c<br/>    175 LastMachine=<a href="http://acas0603.usatlas.bnl.gov">acas0603.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>     34 LastMachine=<a href="http://acas0616.usatlas.bnl.gov">acas0616.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>     32 LastMachine=<a href="http://acas0630.usatlas.bnl.gov">acas0630.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>    131 LastMachine=<a href="http://acas0631.usatlas.bnl.gov">acas0631.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>     87 LastMachine=<a href="http://acas0703.usatlas.bnl.gov">acas0703.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>    240 LastMachine=<a href="http://acas0708.usatlas.bnl.gov">acas0708.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>     80 LastMachine=<a href="http://acas0756.usatlas.bnl.gov">acas0756.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>     22 LastMachine=<a href="http://acas0770.usatlas.bnl.gov">acas0770.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>     78 LastMachine=<a href="http://acas0917.usatlas.bnl.gov">acas0917.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>    216 LastMachine=<a href="http://acas0920.usatlas.bnl.gov">acas0920.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>    196 LastMachine=<a href="http://acas0927.usatlas.bnl.gov">acas0927.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>      2 LastMachine=<a href="http://acas0957.usatlas.bnl.gov">acas0957.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>      2 LastMachine=<a href="http://acas0960.usatlas.bnl.gov">acas0960.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>     82 LastMachine=<a href="http://acas0963.usatlas.bnl.gov">acas0963.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>    149 LastMachine=<a href="http://acas1079.usatlas.bnl.gov">acas1079.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>      2 LastMachine=<a href="http://acas1087.usatlas.bnl.gov">acas1087.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"<br/>    142 LastMachine=<a href="http://acas1095.usatlas.bnl.gov">acas1095.usatlas.bnl.gov</a>, ShortHoldReason="Singularity test failed:ERROR: Unknown option: -S"</pre><br/>
<span style="color: #43761b"><span style="font-size: small">(15:39:32)</span> <b>blin:</b></span> ah ok if it's ATLAS we should reach out to @xzhao and Doug Benjamin<br/>
<span style="color: #aba727"><span style="font-size: small">(15:42:10)</span> <b>moate:</b></span> @blin thank you, will do<br/>
<span style="color: #43761b"><span style="font-size: small">(15:43:03)</span> <b>blin:</b></span> but for future reference, you can lookup contacts in Topology for a given site <a href="https://github.com/opensciencegrid/topology/blob/master/topology/Brookhaven%20National%20Laboratory/BNL%20ATLAS%20Tier1/BNL-ATLAS.yaml">https://github.com/opensciencegrid/topology/blob/master/topology/Brookhaven%20National%20Laboratory/BNL%20ATLAS%20Tier1/BNL-ATLAS.yaml</a><br/>
<span style="color: #aba727"><span style="font-size: small">(15:44:49)</span> <b>moate:</b></span> Ah, makes sense<br/>
</body>
</html>
