<!DOCTYPE html>
<html>
<head>
<title>Wed Jan 8, 2020 : #operations (osg)</title>
</head>
<body>
<h3>Wed Jan 8, 2020 : #operations (osg)</h3>
<span style="color: #e96699"><span style="font-size: small">(11:38:18)</span> <b>lincoln:</b></span> hi folks, some time back I was setting up a new Stash service and I had a problem getting <tt>/run/stash-origin/Authfile</tt> in order to start my origin<br/>
<span style="color: #e96699"><span style="font-size: small">(11:38:29)</span> <b>lincoln:</b></span> I've switched hostnames and now I think this server should fully replace <a href="http://stash.osgconnect.net">stash.osgconnect.net</a> with a new server<br/>
<span style="color: #e96699"><span style="font-size: small">(11:38:36)</span> <b>lincoln:</b></span> except we are now pushing out a new namespace (/public)<br/>
<span style="color: #e96699"><span style="font-size: small">(11:38:58)</span> <b>lincoln:</b></span> what do I need to do to get my origin running?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:39:04)</span> <b>lincoln:</b></span> as I recall it had something to do with topology<br/>
<span style="color: #e96699"><span style="font-size: small">(11:40:03)</span> <b>lincoln:</b></span> <pre>[root@stash config.d]# grep -v '#' 10-origin-site-local.cfg <br/><br/><br/>set originexport = /<br/>[root@stash config.d]# grep -v '#' 10-common-site-local.cfg <br/><br/><br/>set rootdir = /public<br/><br/>set resourcename = OSG_Connect_Stash-Origin</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:40:19)</span> <b>lincoln:</b></span> <pre>[root@stash config.d]# systemctl status xrootd@stash-origin.service<br/>● xrootd@stash-origin.service - XRootD xrootd daemon instance stash/origin<br/>   Loaded: loaded (/usr/lib/systemd/system/xrootd@.service; enabled; vendor preset: disabled)<br/>  Drop-In: /usr/lib/systemd/system/xrootd@stash-origin.service.d<br/>           └─10-stash-origin-overrides.conf<br/>   Active: failed (Result: exit-code) since Wed 2020-01-08 11:36:38 CST; 3min 35s ago<br/>     Docs: man:xrootd(8)<br/>           <a href="http://xrootd.org/docs.html">http://xrootd.org/docs.html</a><br/>  Process: 12664 ExecStart=/usr/bin/xrootd -l /var/log/xrootd/xrootd.log -c /etc/xrootd/xrootd-%i.cfg -k fifo -s /var/run/xrootd/xrootd-%i.pid -n %i (code=exited, status=1/FAILURE)<br/> Main PID: 12664 (code=exited, status=1/FAILURE)</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:40:49)</span> <b>lincoln:</b></span> <pre>++++++ Authorization system initialization started.<br/>200108 11:36:38 12664 acc_Config: Authorization system using configuration in /etc/xrootd/xrootd-stash-origin.cfg<br/>=====&gt; continue /etc/xrootd/config.d<br/>Config continuing with file /etc/xrootd/config.d/10-common-site-local.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/10-origin-site-local.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/10-xrootd-lcmaps.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/40-xcache-auth.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/40-xrootd-lcmaps.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/50-osg-http.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/50-osg-monitoring.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/50-osg-paths.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/50-stash-origin-authz.cfg ...<br/>=====&gt; acc.audit deny grant<br/>=====&gt; acc.authdb /run/stash-origin/Authfile<br/>Config continuing with file /etc/xrootd/config.d/50-stash-origin-paths.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/90-xcache-logging.cfg ...<br/>Config 2 authorization directives processed in /etc/xrootd/xrootd-stash-origin.cfg<br/>200108 11:36:38 12664 acc_AuthFile: Unable to find /run/stash-origin/Authfile; no such file or directory<br/>------ Authorization system initialization failed.<br/>++++++ Configuring server role. . .<br/>Config Manager <a href="http://redirector.osgstorage.org">redirector.osgstorage.org</a> -&gt; <a href="http://hcc-osg-redirector2.unl.edu">hcc-osg-redirector2.unl.edu</a><br/>Config Manager                              129.93.244.222<br/>Config Manager <a href="http://redirector.osgstorage.org">redirector.osgstorage.org</a> -&gt; <a href="http://hcc-osg-redirector1.unl.edu">hcc-osg-redirector1.unl.edu</a><br/>Config Manager                              129.93.175.53<br/>=====&gt; all.manager <a href="http://redirector.osgstorage.org">redirector.osgstorage.org</a>+ 1213<br/>=====&gt; continue /etc/xrootd/config.d<br/>Config continuing with file /etc/xrootd/config.d/10-common-site-local.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/10-origin-site-local.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/10-xrootd-lcmaps.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/40-xcache-auth.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/40-xrootd-lcmaps.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/50-osg-http.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/50-osg-monitoring.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/50-osg-paths.cfg ...<br/>=====&gt; all.adminpath /var/spool/xrootd<br/>Config continuing with file /etc/xrootd/config.d/50-stash-origin-authz.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/50-stash-origin-paths.cfg ...<br/>Config continuing with file /etc/xrootd/config.d/90-xcache-logging.cfg ...<br/>=====&gt; cms.trace all<br/>Config Global System Identification: <a href="mailto:s-stash-origin@stash.osgconnect.net">s-stash-origin@stash.osgconnect.net</a> <a href="http://1213hcc-osg-redirector11213hcc-osg-redirector2.unl.edu">1213hcc-osg-redirector11213hcc-osg-redirector2.unl.edu</a><br/>------ File system server initialization failed.<br/>200108 11:36:38 12664 XrootdConfig: Unable to load file system.<br/>------ xrootd protocol initialization failed.<br/>200108 11:36:38 12664 XrdProtocol: Protocol xrootd could not be loaded<br/>------ xrootd <a href="mailto:stash-origin@stash.osgconnect.net">stash-origin@stash.osgconnect.net</a>:1094 initialization failed.</pre><br/>
<span style="color: #c386df"><span style="font-size: small">(11:41:43)</span> <b>matyas:</b></span> you'll need to register the new hostname in topology<br/>
<span style="color: #c386df"><span style="font-size: small">(11:42:02)</span> <b>matyas:</b></span> otherwise the Authfile fetcher won't give you an Authfile<br/>
<span style="color: #e96699"><span style="font-size: small">(11:42:11)</span> <b>lincoln:</b></span> Hostname should be the same now<br/>
<span style="color: #e96699"><span style="font-size: small">(11:42:14)</span> <b>lincoln:</b></span> as the old one<br/>
<span style="color: #43761b"><span style="font-size: small">(11:42:29)</span> <b>blin:</b></span> &gt;  except we are now pushing out a new namespace (/public)<br/>that doesn't appear to be the case with<br/><pre>set originexport = /<br/>set rootdir = /public</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:42:29)</span> <b>lincoln:</b></span> maybe the old one was never registered? :slightly_smiling_face:<br/>
<span style="color: #e96699"><span style="font-size: small">(11:42:45)</span> <b>lincoln:</b></span> ah did i do it backwards or something?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:42:55)</span> <b>lincoln:</b></span> the literal directory on the filesystem is /public<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:42:57)</span> <b>rynge:</b></span> Shouldn't that be /osgconnect ?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:42:57)</span> <b>blin:</b></span> that means that all of your data lives locally in <tt>/public</tt> and you're exporting all of its contents<br/>
<span style="color: #e96699"><span style="font-size: small">(11:43:01)</span> <b>lincoln:</b></span> yes<br/>
<span style="color: #e96699"><span style="font-size: small">(11:43:03)</span> <b>lincoln:</b></span> thats what i want to do :slightly_smiling_face:<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:43:19)</span> <b>dweitzel:</b></span> I thought the namespace was going to be /osg-connect ?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:43:23)</span> <b>lincoln:</b></span> ok how do i do that<br/>
<span style="color: #e96699"><span style="font-size: small">(11:43:47)</span> <b>lincoln:</b></span> make a path on the FS called /osg-connect/public and have that symlinked to the right area?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:43:53)</span> <b>blin:</b></span> for the data federation though, that would mean you're exporting all of <tt>/</tt> and we're not going to give that to you :stuck_out_tongue:<br/>
<span style="color: #43761b"><span style="font-size: small">(11:44:01)</span> <b>blin:</b></span> so if you want the <tt>/osg-connect</tt> namespace, then you should do<br/><pre>set rootdir = /public<br/>set originexport = /osg-connect</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:44:28)</span> <b>lincoln:</b></span> wait what's stopping me from just paving over your / with my /? :)<br/>
<span style="color: #e96699"><span style="font-size: small">(11:44:48)</span> <b>lincoln:</b></span> well ill set that aside for now<br/>
<span style="color: #e96699"><span style="font-size: small">(11:44:48)</span> <b>lincoln:</b></span> ok<br/>
<span style="color: #c386df"><span style="font-size: small">(11:45:05)</span> <b>matyas:</b></span> well you're definitely not getting an Authfile, that's one of the errors. Check <tt>systemd status stash-origin-authfile.service</tt> and <tt>systemd status stash-origin-authfile.timer</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(11:45:24)</span> <b>blin:</b></span> and the above would mean that on your local FS, you'll want <tt>/public/osg-connect</tt><br/>
<span style="color: #e96699"><span style="font-size: small">(11:45:43)</span> <b>lincoln:</b></span> OK<br/>
<span style="color: #e96699"><span style="font-size: small">(11:45:53)</span> <b>lincoln:</b></span> i think i get it<br/>
<span style="color: #e96699"><span style="font-size: small">(11:46:27)</span> <b>lincoln:</b></span> osg-connect or osgconnect @rynge?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:46:33)</span> <b>lincoln:</b></span> my preference is the latter<br/>
<span style="color: #e96699"><span style="font-size: small">(11:46:51)</span> <b>lincoln:</b></span> <pre>Jan 08 11:36:38 <a href="http://stash.osgconnect.net">stash.osgconnect.net</a> authfile-update[12624]: # No resource registered for <a href="http://stash.osgconnect.net">stash.osgconnect.net</a><br/>Jan 08 11:36:38 <a href="http://stash.osgconnect.net">stash.osgconnect.net</a> authfile-update[12624]: # Please check your query or contact <a href="mailto:help@opensciencegrid.org">help@opensciencegrid.org</a><br/>Jan 08 11:36:38 <a href="http://stash.osgconnect.net">stash.osgconnect.net</a> authfile-update[12624]: Error fetching <a href="https://topology.opensciencegrid.org/stashcache/origin-authfile-public?fqdn=stash.osgconnect.net">https://topology.opensciencegrid.org/stashcache/origin-authfile-public?fqdn=stash.osgconnect.net</a><br/>Jan 08 11:36:38 <a href="http://stash.osgconnect.net">stash.osgconnect.net</a> authfile-update[12624]: File contents:<br/>Jan 08 11:36:38 <a href="http://stash.osgconnect.net">stash.osgconnect.net</a> authfile-update[12624]: # No resource registered for <a href="http://stash.osgconnect.net">stash.osgconnect.net</a></pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:46:53)</span> <b>lincoln:</b></span> :thinking_face:<br/>
<span style="color: #e96699"><span style="font-size: small">(11:47:14)</span> <b>lincoln:</b></span> okay this is what i set<br/>
<span style="color: #e96699"><span style="font-size: small">(11:47:15)</span> <b>lincoln:</b></span> <pre>[root@stash config.d]# grep -v '#' 10-common-site-local.cfg 10-origin-site-local.cfg <br/>10-common-site-local.cfg:<br/>10-common-site-local.cfg:<br/>10-common-site-local.cfg:set rootdir = /mnt/ceph/osg/public<br/>10-common-site-local.cfg:<br/>10-common-site-local.cfg:set resourcename = OSG_Connect_Stash-Origin<br/>10-origin-site-local.cfg:<br/>10-origin-site-local.cfg:<br/>10-origin-site-local.cfg:set originexport = /osgconnect</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:47:26)</span> <b>lincoln:</b></span> /mnt/ceph/osg/public is the actual path (/public was just a symlink)<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:47:50)</span> <b>rynge:</b></span> I think <tt>/osgconnect</tt><br/>
<span style="color: #674b1b"><span style="font-size: small">(11:47:54)</span> <b>rynge:</b></span> My only question is<br/>
<span style="color: #e96699"><span style="font-size: small">(11:47:57)</span> <b>lincoln:</b></span> ok<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:48:54)</span> <b>rynge:</b></span> Do we want <tt>/osgconnect</tt> -&gt; <tt>/public</tt>  or <tt>/osgconnect/public</tt> -&gt; <tt>/public</tt><br/>
<span style="color: #c386df"><span style="font-size: small">(11:49:00)</span> <b>matyas:</b></span> <pre>$ cd toplogy<br/>$ git grep <a href="http://stash.orgconnect.net">stash.orgconnect.net</a></pre><br/>nothing<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:49:05)</span> <b>rynge:</b></span> The latter give you a bigger space you can play with going forward<br/>
<span style="color: #43761b"><span style="font-size: small">(11:49:14)</span> <b>blin:</b></span> ^^ orgconnect :smile:<br/>
<span style="color: #e96699"><span style="font-size: small">(11:49:20)</span> <b>lincoln:</b></span> :thinking_face:<br/>
<span style="color: #e96699"><span style="font-size: small">(11:49:41)</span> <b>lincoln:</b></span> I'll defer to your preference Mats<br/>
<span style="color: #e96699"><span style="font-size: small">(11:49:52)</span> <b>lincoln:</b></span> whatever will be easier for users<br/>
<span style="color: #43761b"><span style="font-size: small">(11:49:57)</span> <b>blin:</b></span> though <a href="http://stash.osgconnect.net">stash.osgconnect.net</a> isn't there either<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:50:06)</span> <b>rynge:</b></span> I like to keep it open-ended, so that would be <tt>/osgconnect/public</tt><br/>
<span style="color: #e96699"><span style="font-size: small">(11:50:16)</span> <b>lincoln:</b></span> ok i will suffer through trying to make a PR to GitHub :disappointed:<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:50:16)</span> <b>rynge:</b></span> I mean you will export <tt>/osgconnect</tt><br/>
<span style="color: #674b1b"><span style="font-size: small">(11:50:53)</span> <b>rynge:</b></span> Just map it to an empty /osgconnect directory on your server<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:51:10)</span> <b>rynge:</b></span> And then a symlink /osgconnect/public to /public<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:51:17)</span> <b>rynge:</b></span> Does this make sense?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:51:28)</span> <b>lincoln:</b></span> it doesn't :slightly_smiling_face:<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:51:34)</span> <b>rynge:</b></span> Heh<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:52:31)</span> <b>rynge:</b></span> Ok, consider this. We have <tt>/osgconnect</tt> now. Let's say later that you want to put spt data on stash. All you would need is a symlink from /osgconnect then<br/>
<span style="color: #e96699"><span style="font-size: small">(11:52:32)</span> <b>lincoln:</b></span> I think i get it<br/>
<span style="color: #e96699"><span style="font-size: small">(11:52:33)</span> <b>lincoln:</b></span> hang on<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:52:50)</span> <b>rynge:</b></span> You own all of /osgconnect. We will only use /osgconnect/public for now<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:53:03)</span> <b>rynge:</b></span> And leave the rest of /osgconnect open-ended<br/>
<span style="color: #e96699"><span style="font-size: small">(11:53:23)</span> <b>lincoln:</b></span> <pre>[root@stash config.d]# grep -v '#' 10-common-site-local.cfg 10-origin-site-local.cfg <br/>10-common-site-local.cfg:<br/>10-common-site-local.cfg:<br/>10-common-site-local.cfg:set rootdir = /osgconnect<br/>10-common-site-local.cfg:<br/>10-common-site-local.cfg:set resourcename = OSG_Connect_Stash-Origin<br/>10-origin-site-local.cfg:<br/>10-origin-site-local.cfg:<br/>10-origin-site-local.cfg:set originexport = /osgconnect<br/>[root@stash config.d]# ls -l /osgconnect/<br/>total 0<br/>lrwxrwxrwx 1 root root 21 Jan  8 11:52 public -&gt; /mnt/ceph/osg/public/</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:53:24)</span> <b>lincoln:</b></span> ?<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:53:35)</span> <b>rynge:</b></span> Yes!<br/>
<span style="color: #e96699"><span style="font-size: small">(11:53:40)</span> <b>lincoln:</b></span> okie done<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:53:52)</span> <b>rynge:</b></span> We need the same thing for writable stash<br/>
<span style="color: #43761b"><span style="font-size: small">(11:54:04)</span> <b>blin:</b></span> er in that case you'll want<br/><pre>set rootdir = /osgconnect<br/>set originexport = /</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:54:52)</span> <b>lincoln:</b></span> &gt; for the data federation though, that would mean you're exporting all of <tt>/</tt> and we're not going to give that to you :stuck_out_tongue:<br/>&gt; <br/>&gt; [11:44 AM]<br/>
<span style="color: #e96699"><span style="font-size: small">(11:54:55)</span> <b>lincoln:</b></span> isnt that the same as before?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:55:01)</span> <b>lincoln:</b></span> except /osgconnect instead of public?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:55:08)</span> <b>blin:</b></span> oh, oops<br/>
<span style="color: #43761b"><span style="font-size: small">(11:55:12)</span> <b>blin:</b></span> you're right<br/>
<span style="color: #43761b"><span style="font-size: small">(11:55:27)</span> <b>blin:</b></span> i got it backwards so it should be:<br/><pre>set rootdir = /<br/>set originexport = /osgconnect</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:56:01)</span> <b>lincoln:</b></span> boy i love xrootd<br/>
<span style="color: #e96699"><span style="font-size: small">(11:56:30)</span> <b>lincoln:</b></span> ok done<br/>
<span style="color: #43761b"><span style="font-size: small">(12:00:29)</span> <b>blin:</b></span> you could just have <tt>set rootdir = /mnt/ceph/osg</tt> instead if you just plan on putting all the stash data in that dir longterm<br/>
<span style="color: #43761b"><span style="font-size: small">(12:01:16)</span> <b>blin:</b></span> and then having <tt>/mnt/ceph/osg/osgconnect/public</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(12:01:52)</span> <b>blin:</b></span> having <tt>/osgconnect</tt> filled with symlinks would allow you to have its contents point to different filesystems in the future though<br/>
<span style="color: #e96699"><span style="font-size: small">(12:02:54)</span> <b>lincoln:</b></span> yeah we can tweak it<br/>
<span style="color: #e96699"><span style="font-size: small">(12:03:02)</span> <b>lincoln:</b></span> right now I'm struggling through Topology :slightly_smiling_face:<br/>
<span style="color: #43761b"><span style="font-size: small">(12:03:32)</span> <b>blin:</b></span> struggle?? it's so intuitive<br/>
<span style="color: #43761b"><span style="font-size: small">(12:03:40)</span> <b>blin:</b></span> :expressionless:<br/>
<span style="color: #e96699"><span style="font-size: small">(12:04:56)</span> <b>lincoln:</b></span> you may think i'm crazy and uncool but uh<br/>
<span style="color: #e96699"><span style="font-size: small">(12:04:58)</span> <b>lincoln:</b></span> i dont like github as a database<br/>
<span style="color: #e96699"><span style="font-size: small">(12:05:08)</span> <b>lincoln:</b></span> <a href="https://github.com/opensciencegrid/topology/pull/952">https://github.com/opensciencegrid/topology/pull/952</a> just made a PR<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:33:45)</span> <b>rynge:</b></span> @lincoln I don't think the mapping is correct. I tried this one <tt>$ stashcp -d <a href="stash://osgconnect/public/rynge/test.data">stash://osgconnect/public/rynge/test.data</a> /tmp/data</tt><br/>
<span style="color: #674b1b"><span style="font-size: small">(12:34:38)</span> <b>rynge:</b></span> <br/>
<span style="color: #e96699"><span style="font-size: small">(12:46:10)</span> <b>lincoln:</b></span> i dont think ive started anythging yet<br/>
<span style="color: #e96699"><span style="font-size: small">(12:46:16)</span> <b>lincoln:</b></span> cant get the authfile til the PR is merged and i just stepped out for a few<br/>
<span style="color: #e96699"><span style="font-size: small">(13:11:09)</span> <b>lincoln:</b></span> @matyas added your ID suggestion<br/>
<span style="color: #c386df"><span style="font-size: small">(13:11:44)</span> <b>matyas:</b></span> ok, will merge once the CI passes<br/>
<span style="color: #e96699"><span style="font-size: small">(13:19:08)</span> <b>lincoln:</b></span> great<br/>
<span style="color: #e96699"><span style="font-size: small">(13:25:04)</span> <b>lincoln:</b></span> [root@stash ~]# curl <a href="https://topology.opensciencegrid.org/stashcache/origin-authfile-public?fqdn=stash.osgconnect.net">https://topology.opensciencegrid.org/stashcache/origin-authfile-public?fqdn=stash.osgconnect.net</a><br/># No resource registered for <a href="http://stash.osgconnect.net">stash.osgconnect.net</a><br/># Please check your query or contact <a href="mailto:help@opensciencegrid.org">help@opensciencegrid.org</a><br/>
<span style="color: #e96699"><span style="font-size: small">(13:25:09)</span> <b>lincoln:</b></span> how long does this take to update?<br/>
<span style="color: #c386df"><span style="font-size: small">(13:25:13)</span> <b>matyas:</b></span> up to 15 min<br/>
<span style="color: #c386df"><span style="font-size: small">(13:28:30)</span> <b>matyas:</b></span> We could probably drop that down to 5 now that the yaml no longer takes 15 seconds to parse<br/>
<span style="color: #e96699"><span style="font-size: small">(13:42:22)</span> <b>lincoln:</b></span> new error!!<br/>
<span style="color: #e96699"><span style="font-size: small">(13:42:25)</span> <b>lincoln:</b></span> [root@stash ~]# curl <a href="https://topology.opensciencegrid.org/stashcache/origin-authfile-public?fqdn=stash.osgconnect.net">https://topology.opensciencegrid.org/stashcache/origin-authfile-public?fqdn=stash.osgconnect.net</a><br/># Error generating authfile for this FQDN: No working StashCache resource/VO combinations found<br/># Please check configuration in OSG topology or contact <a href="mailto:help@opensciencegrid.org">help@opensciencegrid.org</a><br/>
<span style="color: #43761b"><span style="font-size: small">(13:44:15)</span> <b>blin:</b></span> i think that means we need to update this: <a href="https://github.com/opensciencegrid/topology/blob/master/virtual-organizations/OSG.yaml#L65-L72">https://github.com/opensciencegrid/topology/blob/master/virtual-organizations/OSG.yaml#L65-L72</a><br/>
<span style="color: #c386df"><span style="font-size: small">(13:45:22)</span> <b>matyas:</b></span> yeah that might help<br/>
<span style="color: #e96699"><span style="font-size: small">(14:02:02)</span> <b>lincoln:</b></span> do I need to do anything?<br/>
<span style="color: #43761b"><span style="font-size: small">(14:02:32)</span> <b>blin:</b></span> i'm working on it as we speak<br/>
<span style="color: #e96699"><span style="font-size: small">(14:05:46)</span> <b>lincoln:</b></span> @dweitzel for writeable stash we currently have<br/><pre>oss.localroot /stash<br/>all.export /</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(14:05:53)</span> <b>lincoln:</b></span> what does this need to get changed to in the new scheme?<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:06:39)</span> <b>dweitzel:</b></span> should be same thing as the origin, but we use variables.  Let me look how the variables map.<br/>
<span style="color: #43761b"><span style="font-size: small">(14:06:46)</span> <b>blin:</b></span> <a href="https://github.com/opensciencegrid/topology/pull/955">https://github.com/opensciencegrid/topology/pull/955</a><br/>
<span style="color: #235e5b"><span style="font-size: small">(14:09:07)</span> <b>dweitzel:</b></span> I think just change "/stash" to "/osgconnect"<br/>
<span style="color: #e96699"><span style="font-size: small">(14:09:37)</span> <b>lincoln:</b></span> and then mount the directories in the same way<br/>
<span style="color: #e96699"><span style="font-size: small">(14:09:38)</span> <b>lincoln:</b></span> ok<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:10:03)</span> <b>dweitzel:</b></span> yup<br/>
<span style="color: #e96699"><span style="font-size: small">(14:12:20)</span> <b>lincoln:</b></span> ok its restarted.. @rynge you might be able to try a writeable example?<br/>
<span style="color: #e96699"><span style="font-size: small">(14:12:44)</span> <b>lincoln:</b></span> @blin i assume i need to wait another ~15min?<br/>
<span style="color: #43761b"><span style="font-size: small">(14:13:05)</span> <b>blin:</b></span> yeah, i believe so<br/>
<span style="color: #c386df"><span style="font-size: small">(14:18:46)</span> <b>matyas:</b></span> seems to work now<br/>
<span style="color: #c386df"><span style="font-size: small">(14:18:59)</span> <b>matyas:</b></span> I bounced httpd because of another PR<br/>
<span style="color: #c386df"><span style="font-size: small">(14:19:05)</span> <b>matyas:</b></span> which invalidates the cache<br/>
<span style="color: #e96699"><span style="font-size: small">(14:19:22)</span> <b>lincoln:</b></span> <pre>[root@stash ~]#  curl <a href="https://topology.opensciencegrid.org/stashcache/origin-authfile-public?fqdn=stash.osgconnect.net">https://topology.opensciencegrid.org/stashcache/origin-authfile-public?fqdn=stash.osgconnect.net</a><br/><br/>u * /osgconnect/public lr /user lr<br/>[root@stash ~]# systemctl restart xrootd@stash-origin.service<br/>[root@stash ~]# systemctl status xrootd@stash-origin.service<br/>● xrootd@stash-origin.service - XRootD xrootd daemon instance stash/origin<br/>   Loaded: loaded (/usr/lib/systemd/system/xrootd@.service; enabled; vendor preset: disabled)<br/>  Drop-In: /usr/lib/systemd/system/xrootd@stash-origin.service.d<br/>           └─10-stash-origin-overrides.conf<br/>   Active: active (running) since Wed 2020-01-08 14:19:11 CST; 2s ago<br/>     Docs: man:xrootd(8)<br/>           <a href="http://xrootd.org/docs.html">http://xrootd.org/docs.html</a><br/> Main PID: 19480 (xrootd)<br/>   CGroup: /system.slice/system-xrootd.slice/xrootd@stash-origin.service<br/>           └─19480 /usr/bin/xrootd -l /var/log/xrootd/xrootd.log -c /etc/xrootd/xrootd-stash-origin.cfg -k fifo -s /var/run/xrootd/xrootd-stash-origin.pid -n stash-origin<br/><br/>Jan 08 14:19:11 <a href="http://stash.osgconnect.net">stash.osgconnect.net</a> systemd[1]: Started XRootD xrootd daemon instance stash/origin.</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(14:19:32)</span> <b>lincoln:</b></span> @rynge want to give things a try?<br/>
<span style="color: #e96699"><span style="font-size: small">(14:51:33)</span> <b>lincoln:</b></span> @dweitzel does the stash scanner need to be changed to look at our new namespace now?<br/>
<span style="color: #e96699"><span style="font-size: small">(14:51:45)</span> <b>lincoln:</b></span> I don't see any of those infamous bbockelm login spams in my xrootd logs now :slightly_smiling_face:<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:52:07)</span> <b>dweitzel:</b></span> yup, most definitely.  I think we discussed a clean wipe?<br/>
<span style="color: #e96699"><span style="font-size: small">(14:52:15)</span> <b>lincoln:</b></span> yes<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:56:04)</span> <b>dweitzel:</b></span> ok, I asked a sanity question to Dave to make sure I do it correct, but I'm about to "rm -rf" the CVMFS repo.<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:18:51)</span> <b>rynge:</b></span> @lincoln Not working for me<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:19:08)</span> <b>rynge:</b></span> Could it still be the caching?<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:19:43)</span> <b>rynge:</b></span> No, new files are failing as well<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:20:20)</span> <b>rynge:</b></span> <pre>[2020-01-08 15:19:31.120494 -0600][Debug  ][ExDbgMsg          ] [<a href="http://redirector.osgstorage.org:1094">redirector.osgstorage.org:1094</a>] Calling MsgHandler: 0x1e03560 (message: kXR_open (file: /public/rynge/test2.data?, mode: 00, flags: kXR_open_read kXR_async kXR_retstat ) ) with status: [ERROR] Error response: No such file or directory.</pre><br/><br/>
<span style="color: #674b1b"><span style="font-size: small">(15:20:30)</span> <b>rynge:</b></span> Should it really drop the osgconnect part like that?<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:20:46)</span> <b>rynge:</b></span> The command I tried: <tt>stashcp -d <a href="stash://osgconnect/public/rynge/test2.data">stash://osgconnect/public/rynge/test2.data</a> /tmp/data</tt><br/>
<span style="color: #235e5b"><span style="font-size: small">(15:26:22)</span> <b>dweitzel:</b></span> no, it shouldn't drop the osgconnect part.<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:26:30)</span> <b>dweitzel:</b></span> I think you need 3 <tt>///</tt> ?<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:26:41)</span> <b>dweitzel:</b></span> <tt>stashcp -d stash:///osgconnect/public/rynge/test2.data</tt><br/>
<span style="color: #674b1b"><span style="font-size: small">(15:28:57)</span> <b>rynge:</b></span> Ah, perfefct<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:29:00)</span> <b>rynge:</b></span> Thanks<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:29:35)</span> <b>bbockelm:</b></span> <tt>stash:///osgconnect/</tt> &lt;~ that's the most depressing URL I've seen in awhile!<br/>
<span style="color: #c386df"><span style="font-size: small">(15:36:33)</span> <b>matyas:</b></span> could be worse. IIRC the dcache srmclient required <tt>////</tt><br/>
<span style="color: #235e5b"><span style="font-size: small">(15:47:18)</span> <b>dweitzel:</b></span> @rynge should people already have data in their /osgconnect/public/&lt;username&gt; directory?<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:47:31)</span> <b>dweitzel:</b></span> you have some, and user <tt>cversoza</tt><br/>
<span style="color: #235e5b"><span style="font-size: small">(15:47:51)</span> <b>dweitzel:</b></span> cversoza's looks like workflow output and logs.<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:54:15)</span> <b>rynge:</b></span> No, the migration email we will send out as soon as the stashcp works well, has migration instructions<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:54:33)</span> <b>rynge:</b></span> Basically, copy what you want to keep from stash<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:55:18)</span> <b>dweitzel:</b></span> well, user <tt>cversoza</tt> already found it :slightly_smiling_face:<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:55:25)</span> <b>rynge:</b></span> <a href="https://support.opensciencegrid.org/support/solutions/articles/12000065909-transitioning-to-a-new-login-node">https://support.opensciencegrid.org/support/solutions/articles/12000065909-transitioning-to-a-new-login-node</a><br/>
<span style="color: #674b1b"><span style="font-size: small">(15:55:36)</span> <b>rynge:</b></span> Yeah we have a few we pushed early<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:55:43)</span> <b>dweitzel:</b></span> kk<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:08:14)</span> <b>dweitzel:</b></span> ok, you should see data in /cvmfs/stash.osgstorage.org now.<br/>
<span style="color: #e96699"><span style="font-size: small">(16:21:26)</span> <b>lincoln:</b></span> @rynge we should also state somewhere that the AUP has changed<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:26:10)</span> <b>rynge:</b></span> Ok, will that show up when the log in again? Is there a URL to view the AUP?<br/>
<span style="color: #e96699"><span style="font-size: small">(16:36:05)</span> <b>lincoln:</b></span> there is<br/>
<span style="color: #e96699"><span style="font-size: small">(16:36:24)</span> <b>lincoln:</b></span> <a href="https://www.osgconnect.net/aup">https://www.osgconnect.net/aup</a><br/>
<span style="color: #e96699"><span style="font-size: small">(16:36:29)</span> <b>lincoln:</b></span> and it shows up when you log in<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:14:53)</span> <b>rynge:</b></span> Great! I will add it to the email<br/>
</body>
</html>
