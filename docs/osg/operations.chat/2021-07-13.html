<!DOCTYPE html>
<html>
<head>
<title>Tue Jul 13, 2021 : #operations (osg)</title>
</head>
<body>
<h3>Tue Jul 13, 2021 : #operations (osg)</h3>
<span style="color: #9e3997"><span style="font-size: small">(11:51:09)</span> <b>bbockelm:</b></span> (FWIW - I'm almost 100% certain that we have the wrong email for Doug in that ticket)<br/>
<span style="color: #9e3997"><span style="font-size: small">(11:56:09)</span> <b>bbockelm:</b></span> @jdost321 - I just shelled into the Lamar CE and I'm not seeing any authentication failures (in fact, very very little activity).<br/>
<span style="color: #385a86"><span style="font-size: small">(11:56:37)</span> <b>jdost321:</b></span> the pilots are constantly going held with<br/><pre>5428519.2   gfactory        7/13 09:01 Error connecting to schedd <a href="http://lamar-cluster-ce1.svc.opensciencegrid.org">lamar-cluster-ce1.svc.opensciencegrid.org</a>: SECMAN:2007:Failed to received post-auth ClassAd</pre><br/>
<span style="color: #385a86"><span style="font-size: small">(11:56:40)</span> <b>jdost321:</b></span> on the factory side<br/>
<span style="color: #385a86"><span style="font-size: small">(11:56:49)</span> <b>jdost321:</b></span> maybe thye aren't even making it to the CE?<br/>
<span style="color: #385a86"><span style="font-size: small">(11:57:04)</span> <b>jdost321:</b></span> and this is the same prettymuch everywhere clas12 is submitting in the US<br/>
<span style="color: #385a86"><span style="font-size: small">(11:58:54)</span> <b>jdost321:</b></span> <pre>07/13/21 16:58:28 (D_ALWAYS) WARNING! X.509 certificate '/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://fejlab.svc.opensciencegrid.org">fejlab.svc.opensciencegrid.org</a>' has VOMS extensions that can't be verified. Ignoring them. (To silence this warning, set USE_VOMS_ATTRIBUTES=False)</pre><br/>
<span style="color: #385a86"><span style="font-size: small">(11:59:14)</span> <b>jdost321:</b></span> something missing from /etc/voms ?<br/>
<span style="color: #385a86"><span style="font-size: small">(11:59:39)</span> <b>jdost321:</b></span> i see that in <tt>/var/log/condor-ce/SchedLog</tt> on the CE<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:00:35)</span> <b>bbockelm:</b></span> weird.  Maybe I'm on the wrong container?<br/>
<span style="color: #385a86"><span style="font-size: small">(12:00:55)</span> <b>jdost321:</b></span> osg-hosted-ce-lamar-cluster-6566d7887c-vcrx2<br/>
<span style="color: #385a86"><span style="font-size: small">(12:02:21)</span> <b>jdost321:</b></span> <pre>voms-proxy-info -all -file /var/lib/gwms-factory/client-proxies/user_fejlab/glidein_gfactory_instance/credential_JLabVO-1_0.clas12_KSC4N7AS<br/>subject   : /DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://fejlab.svc.opensciencegrid.org/CN=1784447363">fejlab.svc.opensciencegrid.org/CN=1784447363</a><br/>issuer    : /DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://fejlab.svc.opensciencegrid.org">fejlab.svc.opensciencegrid.org</a><br/>identity  : /DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://fejlab.svc.opensciencegrid.org">fejlab.svc.opensciencegrid.org</a><br/>type      : RFC compliant proxy<br/>strength  : 1024 bits<br/>path      : /var/lib/gwms-factory/client-proxies/user_fejlab/glidein_gfactory_instance/credential_JLabVO-1_0.clas12_KSC4N7AS<br/>timeleft  : 22:27:07<br/>key usage : Digital Signature, Key Encipherment, Data Encipherment<br/>=== VO clas12 extension information ===<br/>VO        : clas12<br/>subject   : /DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://fejlab.svc.opensciencegrid.org">fejlab.svc.opensciencegrid.org</a><br/>issuer    : /DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://clas12.voms.opensciencegrid.org">clas12.voms.opensciencegrid.org</a><br/>attribute : /clas12/Role=NULL/Capability=NULL<br/>timeleft  : 22:27:07<br/>uri       : <a href="http://clas12.voms.opensciencegrid.org:15001">clas12.voms.opensciencegrid.org:15001</a></pre><br/>
<span style="color: #385a86"><span style="font-size: small">(12:02:33)</span> <b>jdost321:</b></span> thats the proxy from teh factory side<br/>
<span style="color: #385a86"><span style="font-size: small">(12:02:46)</span> <b>jdost321:</b></span> let me double check the ce config<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:03:17)</span> <b>bbockelm:</b></span> Ah - I see it now.<br/>
<span style="color: #385a86"><span style="font-size: small">(12:03:57)</span> <b>jdost321:</b></span> that should be matching this right?<br/><pre>"/clas12/Role=NULL/Capability=NULL": osg01</pre><br/>
<span style="color: #385a86"><span style="font-size: small">(12:04:09)</span> <b>jdost321:</b></span> <a href="https://github.com/opensciencegrid/hosted-ce-config/blob/310ece41ab720736419203d742e8a772d69e7474/Lamar-Cluster/hosted-ce.yaml#L74">https://github.com/opensciencegrid/hosted-ce-config/blob/310ece41ab720736419203d742e8a772d69e7474/Lamar-Cluster/hosted-ce.yaml#L74</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(12:04:35)</span> <b>bbockelm:</b></span> This is the giveaway:<br/><pre>07/13/21 16:58:28 (D_ALWAYS) WARNING! X.509 certificate '/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://fejlab.svc.opensciencegrid.org">fejlab.svc.opensciencegrid.org</a>' has VOMS extensions that can't be verified. Ignoring them. (To silence this warning, set USE_VOMS_ATTRIBUTES=False)</pre><br/>
<span style="color: #385a86"><span style="font-size: small">(12:06:31)</span> <b>jdost321:</b></span> what does it mean?<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:09:33)</span> <b>bbockelm:</b></span> "VOMS extensions that can't be verified" indicates a problem with the vo-client.<br/>
<span style="color: #43761b"><span style="font-size: small">(12:11:14)</span> <b>blin:</b></span> everything looks sane to me in the <tt>vo-client</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(12:11:39)</span> <b>blin:</b></span> we've also seen that error when the VOMS attrs have been signed with an expired cert<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:18:00)</span> <b>bbockelm:</b></span> Yeah, that looks reasonable:<br/><pre># openssl x509 -in /etc/grid-security/voms/vomscert.pem -noout -enddate<br/>notAfter=Jun 16 23:59:59 2022 GMT</pre><br/>
<span style="color: #9e3997"><span style="font-size: small">(12:19:05)</span> <b>bbockelm:</b></span> Ugh.  I wonder if this goes to the COMODO root CA thing again?<br/>
<blockquote>
<span style="color: #43761b"><span style="font-size: small">(12:20:21)</span> <b>blin:</b></span> oof, maybe? i'm not sure what the CA chain validation looks like for condor + voms<br/>
<span style="color: #43761b"><span style="font-size: small">(12:22:49)</span> <b>blin:</b></span> i'd be surprised, though, it looks like the VOMS proxy and the VOMS certs only contain the leaf certs<br/>
</blockquote>
<span style="color: #9d8eee"><span style="font-size: small">(12:19:28)</span> <b>cat:</b></span> 2022<br/>
<span style="color: #43761b"><span style="font-size: small">(12:19:41)</span> <b>blin:</b></span> ya, 2022 is when it expires<br/>
<span style="color: #43761b"><span style="font-size: small">(12:35:49)</span> <b>blin:</b></span> agh, the VO client _is_ bad<br/>
<span style="color: #43761b"><span style="font-size: small">(12:36:24)</span> <b>blin:</b></span> <pre>/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://clas12.voms.opensciencegrid.org">clas12.voms.opensciencegrid.org</a><br/>/C=US/O=Internet2/OU/=/InCommon/CN=InCommon IGTF Server CA</pre><br/>should be<br/><pre>/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://clas12.voms.opensciencegrid.org">clas12.voms.opensciencegrid.org</a><br/>/C=US/O=Internet2/OU=InCommon/CN=InCommon IGTF Server CA</pre><br/>
<span style="color: #43761b"><span style="font-size: small">(12:37:04)</span> <b>blin:</b></span> EIC has the same problem<br/>
<span style="color: #43761b"><span style="font-size: small">(12:41:06)</span> <b>blin:</b></span> <b>@edquist</b> please review<br/>• <a href="https://github.com/opensciencegrid/osg-vo-config/pull/96">https://github.com/opensciencegrid/osg-vo-config/pull/96</a> and<br/>• <a href="https://github.com/opensciencegrid/osg-vo-config/pull/95">https://github.com/opensciencegrid/osg-vo-config/pull/95</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(12:45:28)</span> <b>bbockelm:</b></span> Ah!  Good spot.<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:45:47)</span> <b>bbockelm:</b></span> I had done the character-by-character review of the DN but not the issuer DN...<br/>
<span style="color: #9d8eee"><span style="font-size: small">(13:29:21)</span> <b>cat:</b></span> What is the process for updating the VO client such that this could happen?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:33:55)</span> <b>blin:</b></span> in this case, Software got the certs and I screwed up the formatting<br/>
<span style="color: #43761b"><span style="font-size: small">(13:34:53)</span> <b>blin:</b></span> newer openssl versions dump data in a new format<br/><pre>$ openssl x509 -in incommon/2021/clas12_voms_opensciencegrid_org_cert.cer -noout -subject -issuer<br/>subject=DC = org, DC = incommon, C = US, ST = Wisconsin, L = Madison, O = University of Wisconsin-Madison, OU = OCIS, CN = <a href="http://clas12.voms.opensciencegrid.org">clas12.voms.opensciencegrid.org</a><br/>issuer=C = US, O = Internet2, OU = InCommon, CN = InCommon IGTF Server CA</pre><br/>
<blockquote>
<span style="color: #9d8eee"><span style="font-size: small">(13:56:48)</span> <b>cat:</b></span> So there’s a manual step involved in translating from the OpenSSL output to the format in the VO client data?<br/>
<span style="color: #9d8eee"><span style="font-size: small">(13:57:33)</span> <b>cat:</b></span> If so, is there a way that a simple tool could help check the translation?<br/>
<span style="color: #9d8eee"><span style="font-size: small">(13:57:45)</span> <b>cat:</b></span> Also, I can’t say I like that new format…<br/>
<span style="color: #9d8eee"><span style="font-size: small">(13:58:06)</span> <b>cat:</b></span> Is there a way to get OpenSSL to output the old format still?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:58:31)</span> <b>blin:</b></span> yes to validating the translation, probably?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:58:42)</span> <b>blin:</b></span> no to outputting the old format<br/>
<span style="color: #43761b"><span style="font-size: small">(13:59:15)</span> <b>blin:</b></span> <a href="https://github.com/openssl/openssl/issues/5605">https://github.com/openssl/openssl/issues/5605</a><br/>
<span style="color: #9d8eee"><span style="font-size: small">(14:26:47)</span> <b>cat:</b></span> Bummer<br/>
<span style="color: #43761b"><span style="font-size: small">(14:27:44)</span> <b>blin:</b></span> their response was super disappointing<br/>&gt; oh hey, the format _did_ change between versions. that sucks. oh well<br/>
<span style="color: #9d8eee"><span style="font-size: small">(14:28:27)</span> <b>cat:</b></span> :face_with_rolling_eyes:<br/>
<span style="color: #9d8eee"><span style="font-size: small">(14:28:40)</span> <b>cat:</b></span> Software people!<br/>
</blockquote>
<span style="color: #16569E"><span style="font-size: small">(13:42:52)</span> <b>edquist:</b></span> PRs merged<br/>
<span style="color: #43761b"><span style="font-size: small">(13:45:24)</span> <b>blin:</b></span> thanks<br/>
<span style="color: #aba727"><span style="font-size: small">(13:53:03)</span> <b>moate:</b></span> I've got a new <a href="https://support.opensciencegrid.org/a/tickets/67604">Freshdesk ticket</a> from Jeff Avila (CERN?) asking for gsiftp help.  I'm not seeing anything obvious in the service catalog.  Who should be agent?<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:53:13)</span> <b>bbockelm:</b></span> @blin - fwiw, I did change this in place on the Lamar CE to verify.<br/>
<span style="color: #9e3997"><span style="font-size: small">(13:54:07)</span> <b>bbockelm:</b></span> @moate - that's T3_US_Brown.  Would be good to redirect them perhaps to Carl Lundstedt.<br/>
<span style="color: #aba727"><span style="font-size: small">(13:55:10)</span> <b>moate:</b></span> OK;  Since he's not a PATh "agent", do I just put him on the CC list and act as moderator?<br/>
<span style="color: #aba727"><span style="font-size: small">(13:56:22)</span> <b>moate:</b></span> Or is this a complete redirect ("Please contact Carl Lundstedt email address foo@bar;  resolving ticket")?<br/>
<span style="color: #43761b"><span style="font-size: small">(14:00:07)</span> <b>blin:</b></span> in the past, we've generally done option 1<br/>
<span style="color: #aba727"><span style="font-size: small">(14:00:21)</span> <b>moate:</b></span> right-o<br/>
<span style="color: #53b759"><span style="font-size: small">(14:38:59)</span> <b>marian:</b></span> btw, Lamar seems to fail somewhere else now:<br/><pre>027 (5429320.004.000) 07/13 12:28:08 Job submitted to grid resource<br/>    GridResource: condor <a href="http://lamar-cluster-ce1.svc.opensciencegrid.org">lamar-cluster-ce1.svc.opensciencegrid.org</a> <a href="http://lamar-cluster-ce1.svc.opensciencegrid.org:9619">lamar-cluster-ce1.svc.opensciencegrid.org:9619</a><br/>    GridJobId: condor <a href="http://lamar-cluster-ce1.svc.opensciencegrid.org">lamar-cluster-ce1.svc.opensciencegrid.org</a> <a href="http://lamar-cluster-ce1.svc.opensciencegrid.org:9619">lamar-cluster-ce1.svc.opensciencegrid.org:9619</a> 95.0<br/>...<br/>012 (5429320.004.000) 07/13 12:34:10 Job was held.<br/>        status command failed: /home/osg01/bosco_slate/glite/libexec/slurm_status.sh: /home/osg01/bosco_slate/glite/libexec/slurm_status.py: /usr/bin/python3: bad interpreter: No such file or directory-/home/osg01/bosco_slate/glite/libexec/slurm_status.sh: line 2<br/>        Code 0 Subcode 0</pre><br/>good sign is there are no auth errors!<br/>
<span style="color: #53b759"><span style="font-size: small">(14:39:36)</span> <b>marian:</b></span> something to add to the deployment?<br/>
<span style="color: #53b759"><span style="font-size: small">(14:40:08)</span> <b>marian:</b></span> and, I found also typo in the <tt>condor_mapfile</tt> on the factory side:<br/>
<span style="color: #43761b"><span style="font-size: small">(14:40:10)</span> <b>blin:</b></span> yeah, we may have to add an override. we've done similar things with other Hosted CEs<br/>
<span style="color: #53b759"><span style="font-size: small">(14:40:59)</span> <b>marian:</b></span> <pre>GSI "^\/DC\=org\/DC\=incommon\/C\=US\/ST\=Wisconsin\/L\=Madison\/O\=University\ of\ Wisconsin\-Madison\/OU\=OCIS\/CN\=fejlab\.svc\.opensciencegrid.\org$" fejlab</pre><br/>who finds it?<br/>
<span style="color: #53b759"><span style="font-size: small">(14:42:42)</span> <b>marian:</b></span> strangely CNAF runs jobs without issues ... also, another clean up I did in frontend.xml, it probably didn't matter but I removed one line that shouldn't be there:<br/><a href="https://github.com/opensciencegrid/tiger-osg-config/commit/05db7de67fbf422d61c3563a1f1a730b26be4a0f">https://github.com/opensciencegrid/tiger-osg-config/commit/05db7de67fbf422d61c3563a1f1a730b26be4a0f</a><br/>
<span style="color: #53b759"><span style="font-size: small">(14:45:43)</span> <b>marian:</b></span> I fixed condo_mapfile earlier but for <a href="http://osg-ce-1.jlab.org">osg-ce-1.jlab.org</a> there are still same auth issues while for Lamar it seems like all will be good once you insert override, I believe<br/>
<span style="color: #385a86"><span style="font-size: small">(15:21:20)</span> <b>jdost321:</b></span> @blin looks like lamar only has python2 do we have a workaround for that?<br/><pre> python -V<br/>Python 2.7.5</pre><br/>
<span style="color: #43761b"><span style="font-size: small">(15:22:18)</span> <b>blin:</b></span> no <tt>module load python</tt>?<br/>
<span style="color: #385a86"><span style="font-size: small">(15:22:43)</span> <b>jdost321:</b></span> i just tried it, still gives us 2.7.5<br/>
<span style="color: #385a86"><span style="font-size: small">(15:25:30)</span> <b>jdost321:</b></span> ok i had to be more specific.. binary is python3.6<br/>
<span style="color: #385a86"><span style="font-size: small">(15:25:48)</span> <b>jdost321:</b></span> <pre> python3.6 -V<br/>Python 3.6.8</pre><br/>
<span style="color: #385a86"><span style="font-size: small">(15:36:44)</span> <b>jdost321:</b></span> not sure what the right workaround is, other than maybe askign the admins to create a symlink python3 -&gt; python3.6 in <tt>/cm/shared/apps/python/3.6.8/bin/</tt><br/>
<span style="color: #385a86"><span style="font-size: small">(15:44:25)</span> <b>jdost321:</b></span> or i could add one myself in /home/osg01/bin but that feels cludgy<br/>
<span style="color: #43761b"><span style="font-size: small">(15:45:00)</span> <b>blin:</b></span> i'm not sure that'll work since the shebang references <tt>/usr/bin/python3</tt><br/>
<span style="color: #385a86"><span style="font-size: small">(15:47:30)</span> <b>jdost321:</b></span> we're pinning bosco 1.3 on tcnj since it doesn't have python3, i don't like that route either but i could try it for lamar worst case<br/>
<span style="color: #385a86"><span style="font-size: small">(16:00:49)</span> <b>jdost321:</b></span> just found a crazy wrapper thing for stampede.. maybe i can try something ismilar here? <a href="https://github.com/opensciencegrid/hosted-ce-config/blob/master/TACC-Stampede2-CE1/bosco_override/glite/bin/slurm_status.py">https://github.com/opensciencegrid/hosted-ce-config/blob/master/TACC-Stampede2-CE1/bosco_override/glite/bin/slurm_status.py</a><br/>
<span style="color: #674b1b"><span style="font-size: small">(18:13:22)</span> <b>rynge:</b></span> @blin What was the resolution for the last time we had problem with broken containers are Purdue-Geddes?<br/>
<span style="color: #674b1b"><span style="font-size: small">(18:13:41)</span> <b>rynge:</b></span> <pre># condor_status -const 'GLIDEIN_ResourceName == "Purdue-Geddes"' -af Machine JobStarts <br/>Purdue-Geddes-osg-pilot-daemonset-zj2d6 18890 <br/>Purdue-Geddes-osg-pilot-daemonset-zj2d6 18890</pre><br/><br/>
<blockquote>
<span style="color: #43761b"><span style="font-size: small">(2021-07-14 07:34:42)</span> <b>blin:</b></span> hrm, i don't recall any particular solution<br/>
</blockquote>
</body>
</html>
