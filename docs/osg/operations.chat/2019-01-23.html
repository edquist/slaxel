<!DOCTYPE html>
<html>
<head>
<title>Wed Jan 23, 2019 : #operations (osg)</title>
</head>
<body>
<h3>Wed Jan 23, 2019 : #operations (osg)</h3>
<span style="color: #43761b"><span style="font-size: small">(09:12:48)</span> <b>blin:</b></span> @jdost321 should we add marco to the operations group in freshdesk since he does hosted ce ops?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:54:47)</span> <b>blin:</b></span> @marco.mascheroni concerning records not coming in for other CEs, is that you may need to <tt>systemctl restart condor-ce</tt> for the config from <tt>gratia-probe-htcondor-ce</tt> to take effect<br/>
<span style="color: #43761b"><span style="font-size: small">(13:55:08)</span> <b>blin:</b></span> <b>@edquist</b> is the software team point of contact for gratia probe so he may be able to help out<br/>
<span style="color: #43761b"><span style="font-size: small">(13:56:33)</span> <b>blin:</b></span> carl, the background is that we've updated to (or installed outright) the gratia probe that's in osg-testing for the hosted CEs, started and enabled <tt>gratia-probes-cron</tt>, and don't seem to see records coming in: <a href="https://gracc.opensciencegrid.org/kibana/app/kibana#/visualize/create?type=histogram&amp;indexPattern=gracc.osg.raw-*&amp;_g=(refreshInterval:('$$hashKey':'object:1037',display:'1%20hour',pause:!f,section:3,value:3600000),time:(from:now%2FM,mode:quick,to:now))&amp;_a=(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,lowercase_expanded_terms:!f,query:'ProbeName:htcondor-ce%5C:hosted-ce*.grid.uchicago.edu')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:ProbeName,order:desc,orderBy:'1',size:10),schema:group,type:terms),(enabled:!t,id:'3',params:(customInterval:'2h',extended_bounds:(),field:EndTime,interval:auto,min_doc_count:1),schema:segment,type:date_histogram)),listeners:(),params:(addLegend:!t,addTimeMarker:!f,addTooltip:!t,categoryAxes:!((id:CategoryAxis-1,labels:(show:!t,truncate:100),position:bottom,scale:(type:linear),show:!t,style:(),title:(text:'EndTime%20per%20week'),type:category)),grid:(categoryLines:!f,style:(color:%23eee)),legendPosition:right,seriesParams:!((data:(id:'1',label:Count),drawLinesBetweenPoints:!t,mode:stacked,show:true,showCircles:!t,type:histogram,valueAxis:ValueAxis-1)),times:!(),type:histogram,valueAxes:!((id:ValueAxis-1,labels:(filter:!f,rotate:0,show:!t,truncate:100),name:LeftAxis-1,position:left,scale:(mode:normal,type:linear),show:!t,style:(),title:(text:Count),type:value))),title:'New%20Visualization',type:histogram))">https://gracc.opensciencegrid.org/kibana/app/kibana#/visualize/create?type=histogram&amp;indexPattern=gracc.osg.raw-*&amp;_g=(refreshInterval:('$$hashKey':'object:1037',display:'1%20hour',pause:!f,section:3,value:3600000),time:(from:now%2FM,mode:quick,to:now))&amp;_a=(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,lowercase_expanded_terms:!f,query:'ProbeName:htcondor-ce%5C:hosted-ce*.grid.uchicago.edu')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:ProbeName,order:desc,orderBy:'1',size:10),schema:group,type:terms),(enabled:!t,id:'3',params:(customInterval:'2h',extended_bounds:(),field:EndTime,interval:auto,min_doc_count:1),schema:segment,type:date_histogram)),listeners:(),params:(addLegend:!t,addTimeMarker:!f,addTooltip:!t,categoryAxes:!((id:CategoryAxis-1,labels:(show:!t,truncate:100),position:bottom,scale:(type:linear),show:!t,style:(),title:(text:'EndTime%20per%20week'),type:category)),grid:(categoryLines:!f,style:(color:%23eee)),legendPosition:right,seriesParams:!((data:(id:'1',label:Count),drawLinesBetweenPoints:!t,mode:stacked,show:true,showCircles:!t,type:histogram,valueAxis:ValueAxis-1)),times:!(),type:histogram,valueAxes:!((id:ValueAxis-1,labels:(filter:!f,rotate:0,show:!t,truncate:100),name:LeftAxis-1,position:left,scale:(mode:normal,type:linear),show:!t,style:(),title:(text:Count),type:value))),title:'New%20Visualization',type:histogram))</a><br/>
<span style="color: #43761b"><span style="font-size: small">(13:56:58)</span> <b>blin:</b></span> some of these CEs were upgraded last week and seem to have jobs running through them but no records<br/>
<span style="color: #43761b"><span style="font-size: small">(13:57:41)</span> <b>blin:</b></span> and for some of the CEs that we just updated, they had thousands of history files in <tt>/var/lib/gratia/data</tt> (or w/e the path is)<br/>
<span style="color: #43761b"><span style="font-size: small">(13:58:13)</span> <b>blin:</b></span> so i would think that the gratia probe would start processing those records<br/>
<span style="color: #43761b"><span style="font-size: small">(13:58:41)</span> <b>blin:</b></span> oh and i just remembered that maybe the probes aren't configured...<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:58:49)</span> <b>dweitzel:</b></span> What's in the gratia logs on those on those nodes?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:59:25)</span> <b>blin:</b></span> in <tt>/etc/gratia-probe/condor/ProbeConfig</tt> -- @marco.mascheroni, <b>@edquist</b> should be able to help you configure each probe properly<br/>
<span style="color: #43761b"><span style="font-size: small">(13:59:41)</span> <b>blin:</b></span> dunno, we have to wait for marco to get back to us tomorrow<br/>
<span style="color: #16569E"><span style="font-size: small">(14:21:39)</span> <b>edquist:</b></span> who's going to account for all the snow in the midwest, that's what i wanna know<br/>
<span style="color: #16569E"><span style="font-size: small">(14:22:48)</span> <b>edquist:</b></span> yeah the probes need to be configured<br/>
<span style="color: #16569E"><span style="font-size: small">(14:22:59)</span> <b>edquist:</b></span> i forged if osg-configure takes care of that<br/>
<span style="color: #16569E"><span style="font-size: small">(14:23:03)</span> <b>edquist:</b></span> *forget<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:28:24)</span> <b>dweitzel:</b></span> @blin got the InCommon cert for <a href="http://redirector.osgstorage.org">redirector.osgstorage.org</a>.<br/>
<span style="color: #43761b"><span style="font-size: small">(15:28:39)</span> <b>blin:</b></span> nice! no hiccups?<br/>
<span style="color: #43761b"><span style="font-size: small">(15:29:04)</span> <b>blin:</b></span> did you have to set up the CNAME in cloudflare?<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:36:38)</span> <b>dweitzel:</b></span> Yup, just had to setup a CNAME in cloudflare to verify "domain ownership"<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:37:18)</span> <b>dweitzel:</b></span> The incommon Subjects are always very, very "accurate":<br/><pre>Subject: DC=org, DC=incommon, C=US/postalCode=68588, ST=NE, L=Lincoln/street=14th And R St., O=University of Nebraska-Lincoln, OU=Holland Computing Center, CN=<a href="http://redirector.osgstorage.org">redirector.osgstorage.org</a><br/></pre><br/>
<span style="color: #235e5b"><span style="font-size: small">(15:37:32)</span> <b>dweitzel:</b></span> Do we really need a mailing address in the subject?<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:37:38)</span> <b>dweitzel:</b></span> But anyways, it'll work.<br/>
<span style="color: #43761b"><span style="font-size: small">(15:41:37)</span> <b>blin:</b></span> i wish cloudflare had a way to write notes for various DNS entries<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:41:51)</span> <b>dweitzel:</b></span> indeed.<br/>
<span style="color: #43761b"><span style="font-size: small">(15:42:15)</span> <b>blin:</b></span> here i'll start up a spreadsheet that we'll eventually throw in the Ops drive (@jdost321)<br/>
<span style="color: #43761b"><span style="font-size: small">(15:42:24)</span> <b>blin:</b></span> because if we have to do a bunch of these we need to keep track of which ones are which<br/>
<span style="color: #235e5b"><span style="font-size: small">(17:14:44)</span> <b>dweitzel:</b></span> @blin that document you shared.  Should the URL be <tt><a href="http://osgstorage.org">osgstorage.org</a></tt> or <tt><a href="http://redirector.osgstorage.org">redirector.osgstorage.org</a></tt>.  I think we can issue for both.<br/>
<blockquote>
<span style="color: #43761b"><span style="font-size: small">(2019-01-24 08:57:29)</span> <b>blin:</b></span> isn't the CNAME validation specifically for redirector?<br/>
<span style="color: #43761b"><span style="font-size: small">(2019-01-24 08:57:49)</span> <b>blin:</b></span> we should also probably include a column for what UNL host it corresponds to<br/>
<span style="color: #235e5b"><span style="font-size: small">(2019-01-24 09:01:10)</span> <b>dweitzel:</b></span> Oh, i don't know.  I thought it was also for the whole *.<a href="http://osgstorage.org">osgstorage.org</a> domain.<br/>
<span style="color: #43761b"><span style="font-size: small">(2019-01-24 09:01:42)</span> <b>blin:</b></span> yeah, i think we're going to have to do CNAME validation for each host cert we request<br/>
<span style="color: #43761b"><span style="font-size: small">(2019-01-24 09:02:03)</span> <b>blin:</b></span> could you add the hostname column i was talking about and the UNL hostname for the redirector?<br/>
<span style="color: #235e5b"><span style="font-size: small">(2019-01-24 09:04:12)</span> <b>dweitzel:</b></span> There is already a "URL" column what <a href="http://redirector.osgstorage.org">redirector.osgstorage.org</a><br/>
<span style="color: #43761b"><span style="font-size: small">(2019-01-24 09:04:47)</span> <b>blin:</b></span> does redirector not also have a UNL hostname?<br/>
<span style="color: #43761b"><span style="font-size: small">(2019-01-24 09:05:06)</span> <b>blin:</b></span> i thought you were getting a cert with an alternative name<br/>
<span style="color: #235e5b"><span style="font-size: small">(2019-01-24 09:06:14)</span> <b>dweitzel:</b></span> Nope, don't care about alternative name.  Just want a cert that says <a href="http://redirector.osgstorage.org">redirector.osgstorage.org</a>.<br/>
<span style="color: #235e5b"><span style="font-size: small">(2019-01-24 09:06:22)</span> <b>dweitzel:</b></span> That's the only hostname I care about.<br/>
</blockquote>
</body>
</html>
