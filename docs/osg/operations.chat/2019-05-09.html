<!DOCTYPE html>
<html>
<head>
<title>Thu May 9, 2019 : #operations (osg)</title>
</head>
<body>
<h3>Thu May 9, 2019 : #operations (osg)</h3>
<span style="color: #e23f99"><span style="font-size: small">(06:18:05)</span> <b>marco.mascheroni:</b></span> @rynge pilots are going held at AMNH with:<br/>```<br/>
<span style="color: #e23f99"><span style="font-size: small">(06:19:32)</span> <b>marco.mascheroni:</b></span> Error connecting to schedd <a href="http://hosted-ce22.grid.uchicago.edu">hosted-ce22.grid.uchicago.edu</a>: AUTHENTICATE:1003:Failed to authenticate with any method|AUTHENTICATE:1004:Failed to authenticate using GSI|GSI:5002:Failed to authenticate because the remote (server) side was not able to acquire its credentials.|AUTHENTICATE:1004:Failed to authenticate using FS<br/>``<tt><br/></tt>vo-client<tt> is updated at 1.90.<br/>It's the entry with supported VO </tt>OSGVO_AMNH`<br/>Did you do anything to its certificate? Other hostedCEs are running fine<br/>
<span style="color: #674b1b"><span style="font-size: small">(09:12:33)</span> <b>rynge:</b></span> Hmm, we do have a new cert, but that should not cause a problem if you have the updated VO package. How about ca certs - do you have a recent setup?<br/>
<span style="color: #9e3997"><span style="font-size: small">(09:19:01)</span> <b>bbockelm:</b></span> <tt>GSI:5002:Failed to authenticate because the remote (server) side was not able to acquire its credentials</tt><br/>
<span style="color: #9e3997"><span style="font-size: small">(09:19:09)</span> <b>bbockelm:</b></span> That should have a very loud message on the CE side.<br/>
<span style="color: #9e3997"><span style="font-size: small">(09:19:23)</span> <b>bbockelm:</b></span> That means the CE couldn't find a hostcert.<br/>
<span style="color: #9e3997"><span style="font-size: small">(09:19:44)</span> <b>bbockelm:</b></span> (or something else bad happened when the CE was trying to read a hostcert - could possibly by CA / CRL as well)<br/>
<span style="color: #43761b"><span style="font-size: small">(09:20:35)</span> <b>blin:</b></span> @marco.mascheroni perhaps another openstack hostname issue?<br/>
<span style="color: #e23f99"><span style="font-size: small">(09:44:05)</span> <b>marco.mascheroni:</b></span> turned out the hostcert was expired. We probably need to get this puppetized @jlstephen and @lincoln<br/>
<span style="color: #e96699"><span style="font-size: small">(10:13:15)</span> <b>lincoln:</b></span> hi, we can definitely puppetize the certs if they aren't already although that of course will not alert us to expired ones :slightly_smiling_face:<br/>
<span style="color: #e96699"><span style="font-size: small">(10:13:34)</span> <b>lincoln:</b></span> we can go through and request IGTF certs from UChicago for each CE<br/>
<span style="color: #e23f99"><span style="font-size: small">(10:14:02)</span> <b>marco.mascheroni:</b></span> with letsencrypt I just had to run <tt>certbot renew</tt>. It can be easily become a cronjob: <a href="https://opensciencegrid.org/docs/security/host-certs/#renewing-lets-encrypt-host-certificates">https://opensciencegrid.org/docs/security/host-certs/#renewing-lets-encrypt-host-certificates</a><br/>
<span style="color: #e23f99"><span style="font-size: small">(10:14:28)</span> <b>marco.mascheroni:</b></span> but if you prefer IGTF certs it's finer for me<br/>
<span style="color: #e23f99"><span style="font-size: small">(10:14:50)</span> <b>marco.mascheroni:</b></span> *fine<br/>
<span style="color: #ea2977"><span style="font-size: small">(10:15:04)</span> <b>jlstephen:</b></span> we can do either<br/>
<span style="color: #ea2977"><span style="font-size: small">(10:15:19)</span> <b>jlstephen:</b></span> if they're already using certbot we probably already have something usable in our puppet manifests<br/>
<span style="color: #e23f99"><span style="font-size: small">(10:15:45)</span> <b>marco.mascheroni:</b></span> some are, some are not<br/>
<span style="color: #e96699"><span style="font-size: small">(10:16:21)</span> <b>lincoln:</b></span> yeah we can do certbot as well<br/>
<span style="color: #e23f99"><span style="font-size: small">(10:16:38)</span> <b>marco.mascheroni:</b></span> we should probably do a campain to renew all of them. I know they will expire in a bit<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:18:42)</span> <b>bbockelm:</b></span> Certbot = auto-renewal, no hassle.  IGTF = hassle<br/>
<span style="color: #e23f99"><span style="font-size: small">(10:19:44)</span> <b>marco.mascheroni:</b></span> <br/>
<span style="color: #e23f99"><span style="font-size: small">(10:19:59)</span> <b>marco.mascheroni:</b></span> Then I'd vote certbot :slightly_smiling_face:<br/>
<span style="color: #e06b56"><span style="font-size: small">(11:23:16)</span> <b>jthiltges:</b></span> I'm seeing some odd koji/mash behavior with i386 RPMs in an x86_64 repo. @matyas<br/>In our mash-generated mirror of the hcc-el6-release repo, there are 14 <tt>*.i386.rpm</tt> files.<br/>In the repodata/*-primary.xml.gz, there's references to 24 <tt>*.i386.rpm</tt> files.<br/><a href="http://t2.unl.edu/store/repos/hcc/6/hcc-el6/x86_64/">http://t2.unl.edu/store/repos/hcc/6/hcc-el6/x86_64/</a><br/><br/>This is causing a downstream <tt>reposync</tt> mirror to fail, as some of the RPMs aren't present.<br/><br/>Missing files which are in the xml:<br/><pre>ganglia-gmetad-3.7.2-2.20160328.hcc.el6.i386.rpm<br/>ganglia-gmond-3.7.2-2.20160328.hcc.el6.i386.rpm<br/>ganglia-gmond-python-3.7.2-2.20160328.hcc.el6.i386.rpm<br/>ganglia-web-3.7.1-2.20160328.hcc.el6.i386.rpm<br/>megaraid-cli-8.07.10-1.hcc.el6.i386.rpm<br/>python2-xrootd-4.8.5-0.experimental.491811.b490c5d6.hcc.el6.i386.rpm<br/>xrootd-4.8.5-0.experimental.491811.b490c5d6.hcc.el6.i386.rpm<br/>xrootd-client-4.8.5-0.experimental.491811.b490c5d6.hcc.el6.i386.rpm<br/>xrootd-fuse-4.8.5-0.experimental.491811.b490c5d6.hcc.el6.i386.rpm<br/>xrootd-server-4.8.5-0.experimental.491811.b490c5d6.hcc.el6.i386.rpm</pre><br/><br/>I'm not clear on what triggers an i386 RPM to be included in a x86_64 repo, and why we'd be missing just a few.<br/>Any debugging suggestions?<br/>
<span style="color: #c386df"><span style="font-size: small">(11:26:54)</span> <b>matyas:</b></span> generally if the package has any compiled binaries in /usr/lib, the i386 rpm will be included in the x86_64 repos too (in case it needs to be used as a dependency for other i386 rpms)<br/>
<span style="color: #c386df"><span style="font-size: small">(11:28:34)</span> <b>matyas:</b></span> i'm not sure why you're missing stuff. i didn't touch the hcc-el6-release or hcc-el6-testing tags so those should still contain all the i386 rpms you had previously built<br/>
<span style="color: #c386df"><span style="font-size: small">(11:31:33)</span> <b>matyas:</b></span> we have some patches to the osg version of mash to also include i386 versions of lcmaps plugins (<tt>/usr/lib*/lcmaps/*.mod</tt>) and python libraries (<tt>/usr/lib*/python*/site-packages/*.so*</tt>)<br/>
<span style="color: #c386df"><span style="font-size: small">(11:32:12)</span> <b>matyas:</b></span> so if you had previously been using the osg version of mash but then upgraded to the epel version of mash, that might cause it<br/>
<span style="color: #e06b56"><span style="font-size: small">(11:32:26)</span> <b>jthiltges:</b></span> Using <tt>mash-0.5.22-3.osg34.el7.noarch</tt><br/>
<span style="color: #c386df"><span style="font-size: small">(11:34:02)</span> <b>matyas:</b></span> can you try regenerating from scratch? (i.e. moving the repo out of the way then rerunning mash)<br/>
<span style="color: #e06b56"><span style="font-size: small">(11:35:02)</span> <b>jthiltges:</b></span> Sure. I'll give it a try.<br/>If that doesn't help, I'll try to workaround my immediate reposync issue, then do more debugging later. Thanks for the help.<br/>
<span style="color: #c386df"><span style="font-size: small">(11:35:12)</span> <b>matyas:</b></span> sure<br/>
<span style="color: #e06b56"><span style="font-size: small">(11:38:35)</span> <b>jthiltges:</b></span> Identical results. Ah, well. I'll work on it later and follow up with you. Thanks!<br/>
<span style="color: #c386df"><span style="font-size: small">(11:58:22)</span> <b>matyas:</b></span> if you're OK with dropping i386 altogether, try editing the mash config and changing <tt>arches=i386 x86_64</tt> to just <tt>arches=x86_64</tt><br/>
<span style="color: #c386df"><span style="font-size: small">(11:58:58)</span> <b>matyas:</b></span> or if you just don't want to see i386 rpms in your x86_64 repos, set <tt>multilib=False</tt><br/>
<span style="color: #e06b56"><span style="font-size: small">(12:36:36)</span> <b>jthiltges:</b></span> Dropping <tt>i386</tt> from <tt>arches</tt> wasn't enough (still showing up in the XML), but <tt>multilib = False</tt> did the trick! Thanks!<br/>
</body>
</html>
