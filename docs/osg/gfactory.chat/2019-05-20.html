<!DOCTYPE html>
<html>
<head>
<title>Mon May 20, 2019 : #gfactory (osg)</title>
</head>
<body>
<h3>Mon May 20, 2019 : #gfactory (osg)</h3>
<span style="color: #a63024"><span style="font-size: small">(13:09:30)</span> <b>efajardo:</b></span> Hi Factory Ops<br/>
<span style="color: #a63024"><span style="font-size: small">(13:09:42)</span> <b>efajardo:</b></span> I need some help with<br/>
<span style="color: #a63024"><span style="font-size: small">(13:09:48)</span> <b>efajardo:</b></span> glow itb FE<br/>
<span style="color: #a63024"><span style="font-size: small">(13:10:11)</span> <b>efajardo:</b></span> it cannot query the factory<br/>
<span style="color: #a63024"><span style="font-size: small">(13:10:43)</span> <b>efajardo:</b></span> <pre>Failed to talk to factory_pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> for entry info: <br/>Traceback (most recent call last):<br/>  File "/usr/sbin/glideinFrontendElement.py", line 1543, in query_entries<br/>    factory_constraint)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/frontend/glideinFrontendInterface.py", line 206, in findGlideins<br/>    status.load(status_constraint)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/lib/condorMonitor.py", line 506, in load<br/>    self.stored_data = self.fetch(constraint, format_list)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/lib/condorMonitor.py", line 607, in fetch<br/>    format_list=format_list)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/lib/condorMonitor.py", line 439, in fetch<br/>    format_list=format_list)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/lib/condorMonitor.py", line 627, in fetch_using_bindings<br/>    results = collector.query(adtype, constraint, attrs)<br/></pre><br/>
<span style="color: #a63024"><span style="font-size: small">(13:11:00)</span> <b>efajardo:</b></span> However when I ran<br/>
<span style="color: #a63024"><span style="font-size: small">(13:11:01)</span> <b>efajardo:</b></span> manually<br/>
<span style="color: #a63024"><span style="font-size: small">(13:11:04)</span> <b>efajardo:</b></span> <pre> sudo -u frontend _CONDOR_CERTIFICATE_MAPFILE=/var/lib/gwms-frontend/vofrontend/group_main/group.mapfile CONDOR_CONFIG=/var/lib/gwms-frontend/vofrontend/frontend.condor_config X509_USER_PROXY=/etc/condor/certs/glidein.proxy GRIDMAP=/etc/condor/certs/grid-mapfile condor_status -pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> -any -debug</pre><br/>
<span style="color: #e23f99"><span style="font-size: small">(13:30:34)</span> <b>marco.mascheroni:</b></span> is there more in the logs?<br/>
<span style="color: #a63024"><span style="font-size: small">(13:43:29)</span> <b>efajardo:</b></span> nop<br/>
<span style="color: #a63024"><span style="font-size: small">(13:44:09)</span> <b>efajardo:</b></span> I even tested this<br/>
<span style="color: #a63024"><span style="font-size: small">(13:44:09)</span> <b>efajardo:</b></span> <a href="https://cdcvs.fnal.gov/redmine/issues/22245#change-69902">https://cdcvs.fnal.gov/redmine/issues/22245#change-69902</a><br/>
<span style="color: #a63024"><span style="font-size: small">(13:44:14)</span> <b>efajardo:</b></span> and this fixed doing it by hand<br/>
<span style="color: #a63024"><span style="font-size: small">(13:44:27)</span> <b>efajardo:</b></span> ```QueryError: Error executing htcondor query to pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> with constraint (GlideinMyType=?="glidefactoryglobal") and format_list None: Error querying pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> using python bindings: Failed communication with collector.. Env is {'LANG': 'en_US.UTF-8', 'X509_USER_PROXY': '/etc/condor/certs/glidein.proxy', 'TERM': 'xterm-256color', 'SHELL': '/bin/bash', 'SHLVL': '2', 'X509_CERT_DIR': '/etc/grid-security/certificates', 'PWD': '/', 'LOGNAME': 'frontend', 'USER': 'frontend', 'HOME': '/var/lib/gwms-frontend', 'PATH': '/sbin:/usr/sbin:/bin:/usr/bin', '_CONDOR_CERTIFICATE_MAPFILE': '/var/lib/gwms-frontend/vofrontend/group_main/group.mapfile', 'CONDOR_CONFIG': '/var/lib/gwms-frontend/vofrontend/frontend.condor_config', '_': '/usr/sbin/glideinFrontend', 'GRIDMAP': '/etc/condor/certs/grid-mapfile'}<br/>[2019-05-20 13:42:50,687] ERROR: glideinFrontendElement:1548: Failed to talk to factory_pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> for entry info: <br/>Traceback (most recent call last):<br/>  File "/usr/sbin/glideinFrontendElement.py", line 1543, in query_entries<br/>    factory_constraint)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/frontend/glideinFrontendInterface.py", line 206, in findGlideins<br/>    status.load(status_constraint)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/lib/condorMonitor.py", line 506, in load<br/>    self.stored_data = self.fetch(constraint, format_list)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/lib/condorMonitor.py", line 607, in fetch<br/>    format_list=format_list)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/lib/condorMonitor.py", line 439, in fetch<br/>    format_list=format_list)<br/>  File "/usr/lib/python2.6/site-packages/glideinwms/lib/condorMonitor.py", line 627, in fetch_using_bindings<br/>    results = collector.query(adtype, constraint, attrs)<br/>QueryError: Error executing htcondor query to pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> with constraint (GlideinMyType=?="glidefactory") &amp;&amp; stringListMember("sha1",SupportedSignTypes) &amp;&amp; ((True) &amp;&amp; ((stringListMember("GLOWITB", GLIDEIN_Supported_VOs) || stringListMember("glowVO", GLIDEIN_Supported_VOs)) &amp;&amp; GLIDEIN_ResourceName =!= "GLOW")) and format_list None: Error querying pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> using python bindings: Failed communication with collector.. Env is {'LANG': 'en_US.UTF-8', 'X509_USER_PROXY': '/etc/condor/certs/glidein.proxy', 'TERM': 'xterm-256color', 'SHELL': '/bin/bash', 'SHLVL': '2', 'X509_CERT_DIR': '/etc/grid-security/certificates', 'PWD': '/', 'LOGNAME': 'frontend', 'USER': 'frontend', 'HOME': '/var/lib/gwms-frontend', 'PATH': '/sbin:/usr/sbin:/bin:/usr/bin', '_CONDOR_CERTIFICATE_MAPFILE': '/var/lib/gwms-frontend/vofrontend/group_main/group.mapfile', 'CONDOR_CONFIG': '/var/lib/gwms-frontend/vofrontend/frontend.condor_config', '_': '/usr/sbin/glideinFrontend', 'GRIDMAP': '/etc/condor/certs/grid-mapfile'}<br/>[2019-05-20 13:42:50,954] DEBUG: glideinFrontendElement:847: Ignoring schedd <a href="http://test-012.t2.ucsd.edu">test-012.t2.ucsd.edu</a> for this group based on the configuration<br/>[2019-05-20 13:42:50,954] DEBUG: glideinFrontendElement:859: Schedd <a href="http://glidein3.chtc.wisc.edu">glidein3.chtc.wisc.edu</a> has 1 running with max 5700<br/>[2019-05-20 13:42:50,954] DEBUG: glideinFrontendElement:870: Schedd <a href="http://glidein3.chtc.wisc.edu">glidein3.chtc.wisc.edu</a> has 0 uploading with max 95<br/>[2019-05-20 13:42:51,041] ERROR: glideinFrontendMonitoring:97: Failed to update /var/lib/gwms-frontend/vofrontend/monitor/group_main/total/Status_Attributes.rrd<br/>[2019-05-20 13:42:51,041] ERROR: glideinFrontendMonitoring:97: Failed to update /var/lib/gwms-frontend/vofrontend/monitor/group_main/state_MatchedUp/Status_Attributes.rrd<br/>
<span style="color: #a63024"><span style="font-size: small">(13:44:27)</span> <b>efajardo:</b></span> [2019-05-20 13:42:51,041] ERROR: glideinFrontendMonitoring:97: Failed to update /var/lib/gwms-frontend/vofrontend/monitor/group_main/state_Unmatched/Status_Attributes.rrd<br/>[2019-05-20 13:42:51,042] ERROR: glideinFrontendMonitoring:97: Failed to update /var/lib/gwms-frontend/vofrontend/monitor/group_main/state_MatchedDown/Status_Attributes.rr```<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:47:04)</span> <b>marco.mascheroni:</b></span> so you think it still the same issue√π?<br/>
<span style="color: #a63024"><span style="font-size: small">(13:47:12)</span> <b>efajardo:</b></span> no<br/>
<span style="color: #a63024"><span style="font-size: small">(13:47:19)</span> <b>efajardo:</b></span> so what I did was the following<br/>
<span style="color: #a63024"><span style="font-size: small">(13:47:27)</span> <b>efajardo:</b></span> I modified this file<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:48:03)</span> <b>marco.mascheroni:</b></span> (BTW the real error from condor is <tt>Failed communication with collecto</tt>)<br/>
<span style="color: #a63024"><span style="font-size: small">(13:48:07)</span> <b>efajardo:</b></span> <tt>/var/lib/gwms-frontend/vofrontend/frontend.condor_config</tt><br/>
<span style="color: #a63024"><span style="font-size: small">(13:48:13)</span> <b>efajardo:</b></span> I added this<br/>
<span style="color: #a63024"><span style="font-size: small">(13:48:32)</span> <b>efajardo:</b></span> <pre>SEC_CLIENT_AUTHENTICATION = OPTIONAL<br/>SEC_CLIENT_INTEGRITY = OPTIONAL<br/>SEC_CLIENT_AUTHENTICATION = OPTIONAL<br/>SEC_CLIENT_AUTHENTICATION_METHODS = FS, PASSWORD, GSI, SSL, CLAIMTOBE<br/>SEC_CLIENT_ENCRYPTION = OPTIONAL<br/>SEC_CLIENT_INTEGRITY = OPTIONAL</pre><br/>
<span style="color: #a63024"><span style="font-size: small">(13:48:49)</span> <b>efajardo:</b></span> and with that I can run this command by hand<br/>
<span style="color: #a63024"><span style="font-size: small">(13:49:08)</span> <b>efajardo:</b></span> <pre>sudo -u frontend _CONDOR_CERTIFICATE_MAPFILE=/var/lib/gwms-frontend/vofrontend/group_main/group.mapfile CONDOR_CONFIG=/var/lib/gwms-frontend/vofrontend/frontend.condor_config X509_USER_PROXY=/etc/condor/certs/glidein.proxy GRIDMAP=/etc/condor/certs/grid-mapfile condor_status -pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> -any -debug </pre><br/>
<span style="color: #a63024"><span style="font-size: small">(13:49:15)</span> <b>efajardo:</b></span> so basically the same thing a FE does<br/>
<span style="color: #a63024"><span style="font-size: small">(13:49:18)</span> <b>efajardo:</b></span> without des<br/>
<span style="color: #a63024"><span style="font-size: small">(13:49:24)</span> <b>efajardo:</b></span> the above command fails<br/>
<span style="color: #a63024"><span style="font-size: small">(13:49:31)</span> <b>efajardo:</b></span> but I still cannot get gwms<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:50:01)</span> <b>marco.mascheroni:</b></span> what's the ip?<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:50:50)</span> <b>marco.mascheroni:</b></span> I can give you the fsctory collecotnk it is helpful log if oyu thi<br/>
<span style="color: #43761b"><span style="font-size: small">(13:51:01)</span> <b>blin:</b></span> glidein3: 128.104.100.46<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:51:02)</span> <b>marco.mascheroni:</b></span> *factory collector log<br/>
<span style="color: #a63024"><span style="font-size: small">(13:52:08)</span> <b>efajardo:</b></span> I have access to it<br/>
<span style="color: #a63024"><span style="font-size: small">(13:52:12)</span> <b>efajardo:</b></span> but the CollectorLog<br/>
<span style="color: #a63024"><span style="font-size: small">(13:52:24)</span> <b>efajardo:</b></span> just gives me a very undescritive GSI error<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:56:48)</span> <b>marco.mascheroni:</b></span> just to make sur, have you restarted condor on the node?<br/>
<span style="color: #a63024"><span style="font-size: small">(14:02:39)</span> <b>efajardo:</b></span> yes<br/>
<span style="color: #a63024"><span style="font-size: small">(14:02:54)</span> <b>efajardo:</b></span> but it hould not matter<br/>
<span style="color: #a63024"><span style="font-size: small">(14:03:10)</span> <b>efajardo:</b></span> cause the config is read each time you call condor_status<br/>
<span style="color: #a63024"><span style="font-size: small">(14:03:14)</span> <b>efajardo:</b></span> I restaeted gwms too<br/>
<span style="color: #e23f99"><span style="font-size: small">(14:09:38)</span> <b>marco.mascheroni:</b></span> restarted and not configured, right<br/>
<span style="color: #a63024"><span style="font-size: small">(14:22:39)</span> <b>efajardo:</b></span> right<br/>
<span style="color: #a63024"><span style="font-size: small">(14:22:43)</span> <b>efajardo:</b></span> cause if I reconfigure<br/>
<span style="color: #a63024"><span style="font-size: small">(14:22:49)</span> <b>efajardo:</b></span> I loose the changes to the config file<br/>
<span style="color: #a63024"><span style="font-size: small">(14:22:52)</span> <b>efajardo:</b></span> but I can reconfig<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:40:17)</span> <b>rynge:</b></span> @jdost321 Does <tt>my_identity</tt> update as well?<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:40:20)</span> <b>rynge:</b></span> <pre><br/>&lt;collector DN="/DC=org/DC=incommon/C=US/ST=WI/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://gfactory-2.opensciencegrid.org">gfactory-2.opensciencegrid.org</a>" comment="Open Science Grid Factory 2" factory_identity="<a href="mailto:gfactory@gfactory-2.opensciencegrid.org">gfactory@gfactory-2.opensciencegrid.org</a>" my_identity="<a href="mailto:feosgflock@gfactory-1.t2.ucsd.edu">feosgflock@gfactory-1.t2.ucsd.edu</a>" node="<a href="http://gfactory-2.opensciencegrid.org">gfactory-2.opensciencegrid.org</a>"/&gt;<br/></pre><br/>
<span style="color: #674b1b"><span style="font-size: small">(16:40:50)</span> <b>rynge:</b></span> Or:<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:40:54)</span> <b>rynge:</b></span> <pre><br/>&lt;collector DN="/DC=org/DC=incommon/C=US/ST=WI/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=<a href="http://gfactory-2.opensciencegrid.org">gfactory-2.opensciencegrid.org</a>" comment="Open Science Grid Factory 2" factory_identity="<a href="mailto:gfactory@gfactory-2.opensciencegrid.org">gfactory@gfactory-2.opensciencegrid.org</a>" my_identity="<a href="mailto:feosgflock@factory-2.opensciencegrid.org">feosgflock@factory-2.opensciencegrid.org</a>" node="<a href="http://gfactory-2.opensciencegrid.org">gfactory-2.opensciencegrid.org</a>"/&gt;<br/></pre><br/>
<span style="color: #385a86"><span style="font-size: small">(16:53:02)</span> <b>jdost321:</b></span> @rynge yes, identity changes, 2nd one<br/>
<span style="color: #385a86"><span style="font-size: small">(16:53:17)</span> <b>jdost321:</b></span> but the gfactory-1 one should remain unchanged if you want to talk to both<br/>
<span style="color: #385a86"><span style="font-size: small">(16:53:38)</span> <b>jdost321:</b></span> the gfactory-1 <pre>&lt;collector ... </pre> line<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:55:27)</span> <b>rynge:</b></span> Right - just checking<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:55:43)</span> <b>rynge:</b></span> We are now requesting from both<br/>
</body>
</html>
