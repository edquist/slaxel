<!DOCTYPE html>
<html>
<head>
<title>Tue Dec 20, 2016 : #gfactory (osg)</title>
</head>
<body>
<h3>Tue Dec 20, 2016 : #gfactory (osg)</h3>
<span style="color: #bd9336"><span style="font-size: small">(12:11:33)</span> <b>mkandes:</b></span> Hi Krista! Glad you could join us. :wink:<br/>
<span style="color: #e7392d"><span style="font-size: small">(12:23:01)</span> <b>klarson1:</b></span> Thanks :slightly_smiling_face:<br/>
<span style="color: #53b759"><span style="font-size: small">(14:55:46)</span> <b>marian:</b></span> Hi guys ... what relevant CERN factory to look at? Is it still vocms0342 or was it migrated to other machine?<br/>
<span style="color: #385a86"><span style="font-size: small">(15:15:58)</span> <b>jdost321:</b></span> the new one is vocms0805<br/>
<span style="color: #53b759"><span style="font-size: small">(15:22:47)</span> <b>marian:</b></span> ok, should I care only about 0805 correct?<br/>
<span style="color: #53b759"><span style="font-size: small">(15:24:03)</span> <b>marian:</b></span> just checked 0342 is 'not running' service anyway, so I assume so...<br/>
<span style="color: #53b759"><span style="font-size: small">(15:25:16)</span> <b>marian:</b></span> we know we run gWMS 3.2.14 there right?<br/>
<span style="color: #53b759"><span style="font-size: small">(15:25:22)</span> <b>marian:</b></span> on 0805<br/>
<span style="color: #53b759"><span style="font-size: small">(15:28:15)</span> <b>marian:</b></span> @marian uploaded a file: <a href="https://opensciencegrid.slack.com/files/marian/F3HB8K51B/-.txt">Untitled</a><br/>
<span style="color: #53b759"><span style="font-size: small">(15:28:39)</span> <b>marian:</b></span> quick trick to avoid this?<br/>
<span style="color: #385a86"><span style="font-size: small">(15:37:52)</span> <b>jdost321:</b></span> who owns the repo? _gfactory or root?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:00:44)</span> <b>marian:</b></span> yeah I thought of it<br/>
<span style="color: #53b759"><span style="font-size: small">(16:00:47)</span> <b>marian:</b></span> but it's _gfactory<br/>
<span style="color: #53b759"><span style="font-size: small">(16:00:54)</span> <b>marian:</b></span> so I assume it's right<br/>
<span style="color: #385a86"><span style="font-size: small">(16:03:57)</span> <b>jdost321:</b></span> hmm maybe we never generated / added a deploy key for the new factory<br/>
<span style="color: #53b759"><span style="font-size: small">(16:04:43)</span> <b>marian:</b></span> well there is .git directory ... so some pull has had happened already<br/>
<span style="color: #53b759"><span style="font-size: small">(16:05:06)</span> <b>marian:</b></span> but that could be also some rsync, I don't know<br/>
<span style="color: #53b759"><span style="font-size: small">(16:06:05)</span> <b>marian:</b></span> though, .ssh/ of _gfactory has no key<br/>
<span style="color: #385a86"><span style="font-size: small">(16:06:05)</span> <b>jdost321:</b></span> i'm checking from the github side, 1 sec<br/>
<span style="color: #53b759"><span style="font-size: small">(16:06:09)</span> <b>marian:</b></span> ok<br/>
<span style="color: #53b759"><span style="font-size: small">(16:06:39)</span> <b>marian:</b></span> nor authorized_keys but that is I guess somewhere in the puppet<br/>
<span style="color: #385a86"><span style="font-size: small">(16:08:20)</span> <b>jdost321:</b></span> vassil has the ssh key set up from the root account<br/>
<span style="color: #385a86"><span style="font-size: small">(16:08:35)</span> <b>jdost321:</b></span> you'll have to be the root user to pull from cern<br/>
<span style="color: #53b759"><span style="font-size: small">(16:08:57)</span> <b>marian:</b></span> shouldn't I just copy that key over to _gfactory/.ssh ?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:09:25)</span> <b>marian:</b></span> we want eventually manage things as user rather than root<br/>
<span style="color: #53b759"><span style="font-size: small">(16:09:54)</span> <b>marian:</b></span> but I don't care if you tell do as root and then switch users back when reconfiguring etc<br/>
<span style="color: #385a86"><span style="font-size: small">(16:10:08)</span> <b>jdost321:</b></span> vassil had a reason for doing it differently at cern but i forget no<br/>
<span style="color: #385a86"><span style="font-size: small">(16:10:10)</span> <b>jdost321:</b></span> now<br/>
<span style="color: #385a86"><span style="font-size: small">(16:10:13)</span> <b>jdost321:</b></span> we can ask him tomorrow<br/>
<span style="color: #53b759"><span style="font-size: small">(16:10:17)</span> <b>marian:</b></span> ok<br/>
<span style="color: #385a86"><span style="font-size: small">(16:10:24)</span> <b>jdost321:</b></span> in the meantime can you pull as root?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:10:35)</span> <b>marian:</b></span> we should eliminate ops steps if we can :slightly_smiling_face:<br/>
<span style="color: #53b759"><span style="font-size: small">(16:10:45)</span> <b>marian:</b></span> I'll try, sec<br/>
<span style="color: #385a86"><span style="font-size: small">(16:10:56)</span> <b>jdost321:</b></span> cern is diff than all the ohter factories though because may people can log in<br/>
<span style="color: #e7392d"><span style="font-size: small">(16:11:45)</span> <b>klarson1:</b></span> i thought there was some limits based on groups there so not everyone could access anymore<br/>
<span style="color: #e7392d"><span style="font-size: small">(16:11:46)</span> <b>klarson1:</b></span> ?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:12:07)</span> <b>marian:</b></span> yeah, that should be limited per group in puppet config<br/>
<span style="color: #53b759"><span style="font-size: small">(16:12:14)</span> <b>marian:</b></span> I can pull as root<br/>
<span style="color: #e7392d"><span style="font-size: small">(16:12:20)</span> <b>klarson1:</b></span> if there isn't it may be worth trying to set up, at least on the prod factory<br/>
<span style="color: #53b759"><span style="font-size: small">(16:12:30)</span> <b>marian:</b></span> doing so for now and switching back to _gfactory user do reconfig etc<br/>
<span style="color: #53b759"><span style="font-size: small">(16:12:37)</span> <b>marian:</b></span> tomorrow we can discuss<br/>
<span style="color: #385a86"><span style="font-size: small">(16:12:51)</span> <b>jdost321:</b></span> that part doesn't make sense though, we should just be root for reconfig, restart<br/>
<span style="color: #53b759"><span style="font-size: small">(16:13:06)</span> <b>marian:</b></span> I mean sudo<br/>
<span style="color: #53b759"><span style="font-size: small">(16:13:35)</span> <b>marian:</b></span> be honest, I don't want to be root on that host do everything ... several practical reasons on production host<br/>
<span style="color: #385a86"><span style="font-size: small">(16:14:00)</span> <b>jdost321:</b></span> but reconfigs require runnign service stop / reconfig / start<br/>
<span style="color: #53b759"><span style="font-size: small">(16:14:30)</span> <b>marian:</b></span> sudo<br/>
<span style="color: #53b759"><span style="font-size: small">(16:14:35)</span> <b>marian:</b></span> should be possible<br/>
<span style="color: #385a86"><span style="font-size: small">(16:15:14)</span> <b>jdost321:</b></span> yeah thats how we do it on the other factories.. are you saying sudo doesn't work?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:16:07)</span> <b>marian:</b></span> will try now ... I had main concern we can't pull as _gfactory<br/>
<span style="color: #53b759"><span style="font-size: small">(16:17:20)</span> <b>marian:</b></span> if you pull as root all updated files become root owned ... you need to chown and then go back under _gfactory user profile<br/>
<span style="color: #53b759"><span style="font-size: small">(16:17:23)</span> <b>marian:</b></span> it's annoying ...<br/>
<span style="color: #385a86"><span style="font-size: small">(16:17:33)</span> <b>jdost321:</b></span> yeah i don't think the repose should ever be owned by _gfactory at cern<br/>
<span style="color: #385a86"><span style="font-size: small">(16:17:54)</span> <b>jdost321:</b></span> but like i said we have to double check with vassil, i thought there was good reason for it this way.. maybe not<br/>
<span style="color: #53b759"><span style="font-size: small">(16:18:35)</span> <b>marian:</b></span> ok, let's talk tomorrow<br/>
<span style="color: #53b759"><span style="font-size: small">(16:19:48)</span> <b>marian:</b></span> btw, from bash history I see he is doing then "chown _gfactory:_gfactory *"<br/>
<span style="color: #53b759"><span style="font-size: small">(16:19:59)</span> <b>marian:</b></span> so really there are few things we should make easier imo<br/>
<span style="color: #385a86"><span style="font-size: small">(16:22:29)</span> <b>jdost321:</b></span> yeah that shouldn't be necessary.  its set up for being owned by root so those files should only be owned by root, no reason to switch back<br/>
<span style="color: #385a86"><span style="font-size: small">(16:22:50)</span> <b>jdost321:</b></span> i thought the whole point was we have a ton of people who can log in as _gfactory at cern but a more controlled subset as root<br/>
<span style="color: #385a86"><span style="font-size: small">(16:23:00)</span> <b>jdost321:</b></span> and we don't want just anyone to be able to push to the github repos<br/>
<span style="color: #53b759"><span style="font-size: small">(16:23:19)</span> <b>marian:</b></span> I don't think it's case but we check with Vassil<br/>
<span style="color: #53b759"><span style="font-size: small">(16:24:24)</span> <b>marian:</b></span> such things at CERN one can set access per specific e-group for example ... and that can be just Ops people ... I have that for AAA stuff etc ...<br/>
<span style="color: #53b759"><span style="font-size: small">(16:25:21)</span> <b>marian:</b></span> maybe current e-group they use really has plenty people in and noone wants to clean it up :slightly_smiling_face:<br/>
<span style="color: #e7392d"><span style="font-size: small">(16:26:45)</span> <b>klarson1:</b></span> i thought he talked about a limited subset of people having access.  but access to what user i don't know<br/>
<span style="color: #e7392d"><span style="font-size: small">(16:27:22)</span> <b>klarson1:</b></span> you can also temp revoke push access to the repo for the cern factory.  they can pull the configs from there without it<br/>
<span style="color: #e7392d"><span style="font-size: small">(16:28:03)</span> <b>klarson1:</b></span> depending on how factory operations go at cern, you can figure out how to add limited access later<br/>
<span style="color: #53b759"><span style="font-size: small">(16:39:03)</span> <b>marian:</b></span> @marian uploaded a file: <a href="https://opensciencegrid.slack.com/files/marian/F3J0GGC1M/-.txt">Untitled</a> and commented: anyone was removing LIGO_US_Caltech_ldas-grid? I'm doing -force_delete ... so just for the record<br/>
<span style="color: #53b759"><span style="font-size: small">(16:41:34)</span> <b>marian:</b></span> or adding it and didn't commit changes ... sorry, it's out, let me know if it should be added<br/>
</body>
</html>
