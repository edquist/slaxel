<!DOCTYPE html>
<html>
<head>
<title>Wed Feb 13, 2019 : #gfactory (osg)</title>
</head>
<body>
<h3>Wed Feb 13, 2019 : #gfactory (osg)</h3>
<span style="color: #a63024"><span style="font-size: small">(12:38:24)</span> <b>efajardo:</b></span> <b>@here</b> Dear Factory ops<br/>
<span style="color: #a63024"><span style="font-size: small">(12:38:46)</span> <b>efajardo:</b></span> I wanted to know how can I detect if an entry is in downtime for example <tt>LIGO_UK_RAL_arc_ce05</tt><br/>
<span style="color: #a63024"><span style="font-size: small">(12:39:00)</span> <b>efajardo:</b></span> if it is enabled in the config <a href="https://github.com/opensciencegrid/osg-gfactory/blob/master/10-noncms-osg.xml#L4720">https://github.com/opensciencegrid/osg-gfactory/blob/master/10-noncms-osg.xml#L4720</a><br/>
<span style="color: #a63024"><span style="font-size: small">(12:39:04)</span> <b>efajardo:</b></span> does it mean it is not in downtime?<br/>
<span style="color: #53b759"><span style="font-size: small">(12:40:09)</span> <b>marian:</b></span> Hi Edgra. That attribute just specifies if the entry is "really enabled" downtimes are defined in the glideinWMS.downtimes<br/>
<span style="color: #53b759"><span style="font-size: small">(12:40:59)</span> <b>marian:</b></span> if enabled="False" entry is basically decomissioned for good, no matter if downtime is specified that entry is not visible to factory itself<br/>
<span style="color: #a63024"><span style="font-size: small">(12:41:04)</span> <b>efajardo:</b></span> ahh ok<br/>
<span style="color: #a63024"><span style="font-size: small">(12:41:14)</span> <b>efajardo:</b></span> and this glideinWMS.downtimes is where?<br/>
<span style="color: #53b759"><span style="font-size: small">(12:41:30)</span> <b>marian:</b></span> so you should usually see enabled="True" no matter in what downtime status is the entry<br/>
<span style="color: #53b759"><span style="font-size: small">(12:42:14)</span> <b>marian:</b></span> on the factory host, do you want path?<br/>
<span style="color: #a63024"><span style="font-size: small">(12:42:39)</span> <b>efajardo:</b></span> Sure<br/>
<span style="color: #a63024"><span style="font-size: small">(12:42:44)</span> <b>efajardo:</b></span> or if you have it on github<br/>
<span style="color: #a63024"><span style="font-size: small">(12:42:49)</span> <b>efajardo:</b></span> that aworks too<br/>
<span style="color: #53b759"><span style="font-size: small">(12:42:51)</span> <b>marian:</b></span> also, entry can be either "up" or "down", that independent of downtimes<br/>
<span style="color: #53b759"><span style="font-size: small">(12:43:12)</span> <b>marian:</b></span> downtime file is maintained locally<br/>
<span style="color: #385a86"><span style="font-size: small">(12:43:21)</span> <b>jdost321:</b></span> ideally if the site is enabled but we put it in downtime you can tell here <a href="http://gfactory-1.t2.ucsd.edu/factory/monitor/factoryStatusNow.html">http://gfactory-1.t2.ucsd.edu/factory/monitor/factoryStatusNow.html</a><br/>
<span style="color: #385a86"><span style="font-size: small">(12:43:26)</span> <b>jdost321:</b></span> that's what the red arrows are supposed to be<br/>
<span style="color: #53b759"><span style="font-size: small">(12:43:38)</span> <b>marian:</b></span> yeah<br/>
<span style="color: #385a86"><span style="font-size: small">(12:43:45)</span> <b>jdost321:</b></span> but in practice it doesn't work well, when pressure is 0 at sites we tend to get red arrows too<br/>
<span style="color: #a63024"><span style="font-size: small">(12:44:32)</span> <b>efajardo:</b></span> So this entry is up and running<br/>
<span style="color: #a63024"><span style="font-size: small">(12:44:33)</span> <b>efajardo:</b></span> <tt>LIGO_UK_RAL_arc_ce05</tt><br/>
<span style="color: #a63024"><span style="font-size: small">(12:44:40)</span> <b>efajardo:</b></span> and not in downtime right?<br/>
<span style="color: #385a86"><span style="font-size: small">(12:45:52)</span> <b>jdost321:</b></span> right, that one is not in downtiem<br/>
<span style="color: #e23f99"><span style="font-size: small">(12:46:48)</span> <b>marco.mascheroni:</b></span> It does say that in the condor activity log<br/>
<span style="color: #e23f99"><span style="font-size: small">(12:46:53)</span> <b>marco.mascheroni:</b></span> <br/>
<span style="color: #e23f99"><span style="font-size: small">(12:47:23)</span> <b>marco.mascheroni:</b></span> and no ping<br/>
<span style="color: #e23f99"><span style="font-size: small">(12:47:32)</span> <b>marco.mascheroni:</b></span> <br/>
<span style="color: #a63024"><span style="font-size: small">(12:47:39)</span> <b>efajardo:</b></span> I am trying to figure out if hte new version of glideinwm<br/>
<span style="color: #a63024"><span style="font-size: small">(12:47:42)</span> <b>efajardo:</b></span> on the frontend<br/>
<span style="color: #a63024"><span style="font-size: small">(12:47:44)</span> <b>efajardo:</b></span> is broken<br/>
<span style="color: #385a86"><span style="font-size: small">(12:47:49)</span> <b>jdost321:</b></span> just figured out a way you can tell this from the outside<br/>
<span style="color: #a63024"><span style="font-size: small">(12:47:56)</span> <b>efajardo:</b></span> or it is doing what it is supposed to<br/>
<span style="color: #e23f99"><span style="font-size: small">(12:48:00)</span> <b>marco.mascheroni:</b></span> no the entry is<br/>
<span style="color: #385a86"><span style="font-size: small">(12:48:22)</span> <b>jdost321:</b></span> <pre> condor_status -pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> -any -const 'mytype=?="glidefactory" &amp;&amp; GLIDEIN_In_Downtime'  -af entryname</pre><br/>
<span style="color: #385a86"><span style="font-size: small">(12:49:04)</span> <b>jdost321:</b></span> ok, well marco is showing the CE looks down even though the site didn't register a downtime for it<br/>
<span style="color: #53b759"><span style="font-size: small">(12:49:17)</span> <b>marian:</b></span> yeah, that is nice way to figure if the entry is in downtime<br/>
<span style="color: #53b759"><span style="font-size: small">(12:49:40)</span> <b>marian:</b></span> for earlier question where downtime file lives: <tt>/etc/gwms-factory/glideinWMS.downtimes</tt><br/>
<span style="color: #385a86"><span style="font-size: small">(12:49:43)</span> <b>jdost321:</b></span> interestingly they did register this entry as down  condor_status -pool <a href="http://gfactory-1.t2.ucsd.edu">gfactory-1.t2.ucsd.edu</a> -any -const 'mytype=?="glidefactory" &amp;&amp; GLIDEIN_In_Downtime'  -af entryname<br/>
<span style="color: #385a86"><span style="font-size: small">(12:49:47)</span> <b>jdost321:</b></span> sorry<br/>
<span style="color: #385a86"><span style="font-size: small">(12:49:48)</span> <b>jdost321:</b></span> LIGO_UK_RAL_arc_ce03<br/>
<span style="color: #385a86"><span style="font-size: small">(12:50:09)</span> <b>jdost321:</b></span> but not ce05<br/>
<span style="color: #a63024"><span style="font-size: small">(12:50:11)</span> <b>efajardo:</b></span> From the FE I feel we are requesting<br/>
<span style="color: #a63024"><span style="font-size: small">(12:50:12)</span> <b>efajardo:</b></span> to RAL<br/>
<span style="color: #53b759"><span style="font-size: small">(12:50:21)</span> <b>marian:</b></span> and command line to check up/down will be:<br/><pre><br/>service gwms-factory statusdown -entry LIGO_UK_RAL_arc_ce05<br/>LIGO_UK_RAL_arc_ce05           Up       All:All<br/></pre><br/>
<span style="color: #a63024"><span style="font-size: small">(12:50:28)</span> <b>efajardo:</b></span> <pre>[2019-02-13 10:49:44,205] INFO:   125(  624   125   125     0)     8(    0 10000) |     0     0     0     0 |     0     0     0 |    26   316 | Up   LIGO_UK_RAL_arc_ce01@gfactory_instance@SDSC@gfactory-1.t2.ucsd.edu<br/>[2019-02-13 10:49:44,206] INFO:   125(  624   125   125     0)     8(    0 10000) |     0     0     0     0 |     0     0     0 |    26   316 | Up   LIGO_UK_RAL_arc_ce02@gfactory_instance@SDSC@gfactory-1.t2.ucsd.edu<br/>[2019-02-13 10:49:44,207] INFO:   125(  624   125   125     0)     8(    0 10000) |     0     0     0     0 |     0     0     0 |    26   316 | Up   LIGO_UK_RAL_arc_ce03@gfactory_instance@SDSC@gfactory-1.t2.ucsd.edu<br/>[2019-02-13 10:49:44,208] INFO:   125(  624   125   125     0)     8(    0 10000) |     0     0     0     0 |     0     0     0 |    26   316 | Up   LIGO_UK_RAL_arc_ce04@gfactory_instance@SDSC@gfactory-1.t2.ucsd.edu<br/>[2019-02-13 10:49:44,209] INFO:   125(  624   125   125     0)     8(    0 10000) |     0     0     0     0 |     0     0     0 |    26   316 | Up   LIGO_UK_RAL_arc_ce05@gfactory_instance@SDSC@gfactory-1.t2.ucsd.edu<br/></pre><br/>
<span style="color: #a63024"><span style="font-size: small">(12:50:33)</span> <b>efajardo:</b></span> but<br/>
<span style="color: #a63024"><span style="font-size: small">(12:50:42)</span> <b>efajardo:</b></span> once I upgrade to the new version of glideinwms<br/>
<span style="color: #a63024"><span style="font-size: small">(12:50:45)</span> <b>efajardo:</b></span> 3.4.3<br/>
<span style="color: #a63024"><span style="font-size: small">(12:50:49)</span> <b>efajardo:</b></span> it stops matching<br/>
<span style="color: #a63024"><span style="font-size: small">(12:51:02)</span> <b>efajardo:</b></span> so I was wondering if glideinwms 3.4.4 is just very smart<br/>
<span style="color: #385a86"><span style="font-size: small">(12:51:04)</span> <b>jdost321:</b></span> that was a coincidence<br/>
<span style="color: #a63024"><span style="font-size: small">(12:51:09)</span> <b>efajardo:</b></span> and knows the entries are broken<br/>
<span style="color: #385a86"><span style="font-size: small">(12:51:12)</span> <b>jdost321:</b></span> marco showed this in the gridmanager log <pre>Detected Down Grid Resource<br/><br/>    GridResource: nordugrid <a href="http://arc-ce05.gridpp.rl.ac.uk">arc-ce05.gridpp.rl.ac.uk</a></pre><br/>
<span style="color: #a63024"><span style="font-size: small">(12:51:17)</span> <b>efajardo:</b></span> or if it is broken<br/>
<span style="color: #385a86"><span style="font-size: small">(12:51:20)</span> <b>jdost321:</b></span> the ce is not reachable for whatever reason<br/>
<span style="color: #a63024"><span style="font-size: small">(12:52:18)</span> <b>efajardo:</b></span> ok then indeed<br/>
<span style="color: #a63024"><span style="font-size: small">(12:52:25)</span> <b>efajardo:</b></span> there are two things to follow up:<br/>
<span style="color: #a63024"><span style="font-size: small">(12:52:39)</span> <b>efajardo:</b></span> 1. Why we all LIGO RAL entries are not working<br/>
<span style="color: #a63024"><span style="font-size: small">(12:53:02)</span> <b>efajardo:</b></span> 2. If the CE is down why the factory shows it as up<br/>
<span style="color: #385a86"><span style="font-size: small">(12:53:44)</span> <b>jdost321:</b></span> well the factory only reports if factory operators put it down<br/>
<span style="color: #a63024"><span style="font-size: small">(12:53:51)</span> <b>efajardo:</b></span> ahh ok<br/>
<span style="color: #385a86"><span style="font-size: small">(12:53:56)</span> <b>jdost321:</b></span> and our auto dowtnimes script didn't put ce5 down<br/>
<span style="color: #385a86"><span style="font-size: small">(12:54:08)</span> <b>jdost321:</b></span> becaseu RAL didn't mark it as down in EGI GOCDB<br/>
<span style="color: #385a86"><span style="font-size: small">(12:54:13)</span> <b>jdost321:</b></span> but they did put ce3 down<br/>
<span style="color: #a63024"><span style="font-size: small">(12:54:18)</span> <b>efajardo:</b></span> ok<br/>
<span style="color: #a63024"><span style="font-size: small">(12:54:21)</span> <b>efajardo:</b></span> that solves<br/>
<span style="color: #a63024"><span style="font-size: small">(12:54:22)</span> <b>efajardo:</b></span> 2<br/>
<span style="color: #a63024"><span style="font-size: small">(12:54:24)</span> <b>efajardo:</b></span> what about 1<br/>
<span style="color: #385a86"><span style="font-size: small">(12:54:37)</span> <b>jdost321:</b></span> i suspect tey are doing maintenance and forgot to flag ce5 as down but we can contact them for you if you want<br/>
<span style="color: #a63024"><span style="font-size: small">(12:55:07)</span> <b>efajardo:</b></span> Well yes please I would like to understand if we are indeed submitting piltos<br/>
<span style="color: #a63024"><span style="font-size: small">(12:55:14)</span> <b>efajardo:</b></span> and why are all of the stuck at the CE<br/>
<span style="color: #a63024"><span style="font-size: small">(12:55:28)</span> <b>efajardo:</b></span> I just cannot tell if we are submitting pilots<br/>
<span style="color: #a63024"><span style="font-size: small">(12:55:39)</span> <b>efajardo:</b></span> the factory Status now<br/>
<span style="color: #a63024"><span style="font-size: small">(12:55:46)</span> <b>efajardo:</b></span> says 7 Idle<br/>
<span style="color: #a63024"><span style="font-size: small">(12:55:53)</span> <b>efajardo:</b></span> for an entry that cannot even be pinged<br/>
<span style="color: #a63024"><span style="font-size: small">(12:55:59)</span> <b>efajardo:</b></span> probably decomissioend long time ago<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:06:33)</span> <b>marco.mascheroni:</b></span> the pilots are going into the queue since the entry is not in downtime. Then condor cannot submit and in the condor acitvity logs it says the entry is idle<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:07:06)</span> <b>marco.mascheroni:</b></span> about the LIGO entries not working, not sure. I know Lorena was working on something about downtimes in the frontend<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:07:34)</span> <b>marco.mascheroni:</b></span> is this the production LIGO frontend or itb?<br/>
<span style="color: #a63024"><span style="font-size: small">(13:07:49)</span> <b>efajardo:</b></span> production<br/>
<span style="color: #a63024"><span style="font-size: small">(13:08:00)</span> <b>efajardo:</b></span> But I can see that the new release 3.4.3 is broken<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:08:02)</span> <b>marco.mascheroni:</b></span> brave man<br/>
<span style="color: #a63024"><span style="font-size: small">(13:08:05)</span> <b>efajardo:</b></span> <a href="https://opensciencegrid.atlassian.net/browse/SOFTWARE-3545">https://opensciencegrid.atlassian.net/browse/SOFTWARE-3545</a><br/>
<span style="color: #e23f99"><span style="font-size: small">(13:12:47)</span> <b>marco.mascheroni:</b></span> Any chance I can get a login to the production ligo frontend and have a look live at what happens?<br/>
<span style="color: #a63024"><span style="font-size: small">(13:12:54)</span> <b>efajardo:</b></span> nop<br/>
<span style="color: #a63024"><span style="font-size: small">(13:12:56)</span> <b>efajardo:</b></span> I already<br/>
<span style="color: #a63024"><span style="font-size: small">(13:12:58)</span> <b>efajardo:</b></span> downgraded<br/>
<span style="color: #a63024"><span style="font-size: small">(13:13:05)</span> <b>efajardo:</b></span> and I am not feeling that brave<br/>
<span style="color: #a63024"><span style="font-size: small">(13:13:13)</span> <b>efajardo:</b></span> hehheehe<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:13:17)</span> <b>marco.mascheroni:</b></span> yeah, maybe you can upgrade again.. :stuck_out_tongue:<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:13:21)</span> <b>marco.mascheroni:</b></span> ahahaha<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:13:22)</span> <b>marco.mascheroni:</b></span> ok<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:13:25)</span> <b>marco.mascheroni:</b></span> no problem<br/>
<span style="color: #a63024"><span style="font-size: small">(13:13:36)</span> <b>efajardo:</b></span> Well If you want to take a look<br/>
<span style="color: #a63024"><span style="font-size: small">(13:13:40)</span> <b>efajardo:</b></span> I can upgrade again<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:14:21)</span> <b>marco.mascheroni:</b></span> let me ping Marco Mambelli<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:14:32)</span> <b>marco.mascheroni:</b></span> ph, actually he is on holyday -_-<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:15:24)</span> <b>marco.mascheroni:</b></span> until Monday<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:16:13)</span> <b>marco.mascheroni:</b></span> I'll tell you if I need access<br/>
<span style="color: #a63024"><span style="font-size: small">(13:16:59)</span> <b>efajardo:</b></span> ok<br/>
<span style="color: #a63024"><span style="font-size: small">(13:18:39)</span> <b>efajardo:</b></span> Meanwhile should I open a ggus ticket to RAL folks or you take care of it?<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:19:26)</span> <b>marco.mascheroni:</b></span> go ahead pls :slightly_smiling_face:<br/>
<span style="color: #8d4b84"><span style="font-size: small">(13:21:26)</span> <b>kherner:</b></span> I thought ce5 was new, actually<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:23:10)</span> <b>marco.mascheroni:</b></span> ah yes, it is<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:23:16)</span> <b>marco.mascheroni:</b></span> <br/>
<span style="color: #e23f99"><span style="font-size: small">(13:23:20)</span> <b>marco.mascheroni:</b></span> ops<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:23:27)</span> <b>marco.mascheroni:</b></span> Thanks ken<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:24:39)</span> <b>marco.mascheroni:</b></span> I'll follow up with Edita tomorrow, she should have made some tests in ITB..<br/>
<span style="color: #8d4b84"><span style="font-size: small">(13:24:50)</span> <b>kherner:</b></span> Could it be specific to LIGO?<br/>
<span style="color: #8d4b84"><span style="font-size: small">(13:24:53)</span> <b>kherner:</b></span> The issue, I mean<br/>
<span style="color: #8d4b84"><span style="font-size: small">(13:25:09)</span> <b>kherner:</b></span> I was talking to Raja about it the other day from the DUNE point of view<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:25:13)</span> <b>marco.mascheroni:</b></span> no the CE does not answer to pings<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:25:20)</span> <b>marco.mascheroni:</b></span> ce5<br/>
<span style="color: #8d4b84"><span style="font-size: small">(13:25:22)</span> <b>kherner:</b></span> Got it<br/>
<span style="color: #8d4b84"><span style="font-size: small">(13:25:34)</span> <b>kherner:</b></span> I will let Raja know; sometime he checks in during the evening<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:33:06)</span> <b>marco.mascheroni:</b></span> @efajardo why were you asking about glideins in downtime? Were you reading something in the logs? I found this scary change from Lorena:<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:33:11)</span> <b>marco.mascheroni:</b></span> <br/>
<span style="color: #e23f99"><span style="font-size: small">(13:33:29)</span> <b>marco.mascheroni:</b></span> notice how the string became a bool..<br/>
<span style="color: #a63024"><span style="font-size: small">(13:33:29)</span> <b>efajardo:</b></span> Because I saw womething<br/>
<span style="color: #a63024"><span style="font-size: small">(13:33:38)</span> <b>efajardo:</b></span> in the releae notes<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:33:44)</span> <b>marco.mascheroni:</b></span> ah okok<br/>
<span style="color: #a63024"><span style="font-size: small">(13:33:47)</span> <b>efajardo:</b></span> about downtimes<br/>
<span style="color: #de5f24"><span style="font-size: small">(13:42:00)</span> <b>tiradani:</b></span> @marco.mascheroni what is scary about that?<br/>
<span style="color: #a63024"><span style="font-size: small">(13:42:34)</span> <b>efajardo:</b></span> @tiradani I think he was referring to running it on the production frontend<br/>
<span style="color: #a63024"><span style="font-size: small">(13:42:37)</span> <b>efajardo:</b></span> from the testing repo<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:42:42)</span> <b>marco.mascheroni:</b></span> no nothing<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:42:59)</span> <b>marco.mascheroni:</b></span> That was acutally the fix<br/>
<span style="color: #de5f24"><span style="font-size: small">(13:43:29)</span> <b>tiradani:</b></span> oh, sorry, I misinterpreted your statement<br/>
<span style="color: #de5f24"><span style="font-size: small">(13:43:49)</span> <b>tiradani:</b></span> and was wondering what I missed :slightly_smiling_face:<br/>
<span style="color: #e23f99"><span style="font-size: small">(13:44:23)</span> <b>marco.mascheroni:</b></span> I was doing a diff between 343 and 342 and saw that. And with the quesitons from Edgar about the wdowntime I thought that could be the cause. But I traced the redmine and that seems legit (changing True to 'True')<br/>
<span style="color: #53b759"><span style="font-size: small">(14:05:10)</span> <b>marian:</b></span> wasn't it other way around? <tt>'True'</tt> to <tt>is True</tt>?<br/>
<span style="color: #e23f99"><span style="font-size: small">(14:08:49)</span> <b>marco.mascheroni:</b></span> yes<br/>
<span style="color: #a63024"><span style="font-size: small">(14:48:13)</span> <b>efajardo:</b></span> @marco.mascheroni I created a ticket<br/>
<span style="color: #a63024"><span style="font-size: small">(14:48:13)</span> <b>efajardo:</b></span> <a href="https://ggus.eu/index.php?mode=ticket_info&amp;ticket_id=139672">https://ggus.eu/index.php?mode=ticket_info&amp;ticket_id=139672</a><br/>
<span style="color: #a63024"><span style="font-size: small">(14:48:28)</span> <b>efajardo:</b></span> But I am not sure I included all the information<br/>
<span style="color: #a63024"><span style="font-size: small">(14:48:37)</span> <b>efajardo:</b></span> since I usually do not debug Arc Ce sites<br/>
<span style="color: #e23f99"><span style="font-size: small">(14:54:31)</span> <b>marco.mascheroni:</b></span> So, ce5 is not the only one with issues, right?<br/>
<span style="color: #a63024"><span style="font-size: small">(16:02:17)</span> <b>efajardo:</b></span> all of them I gues have issues<br/>
</body>
</html>
