<!DOCTYPE html>
<html>
<head>
<title>Fri Feb 10, 2017 : #gfactory (osg)</title>
</head>
<body>
<h3>Fri Feb 10, 2017 : #gfactory (osg)</h3>
<span style="color: #5b89d5"><span style="font-size: small">(11:09:48)</span> <b>sthapa:</b></span> Factory question, the glideins from the glidein-int factory are failing when trying to access the factory, is there a quick fix here?  Looks like there’s a misconfiguration for the apache settings:<br/>
<span style="color: #5b89d5"><span style="font-size: small">(11:09:53)</span> <b>sthapa:</b></span> @sthapa uploaded a file: <a href="https://opensciencegrid.slack.com/files/sthapa/F4371QUGY/-.txt">Untitled</a><br/>
<span style="color: #5b89d5"><span style="font-size: small">(11:10:35)</span> <b>sthapa:</b></span> Here’s the glidein error:<br/>
<span style="color: #5b89d5"><span style="font-size: small">(11:10:48)</span> <b>sthapa:</b></span> @sthapa uploaded a file: <a href="https://opensciencegrid.slack.com/files/sthapa/F440RC2AG/-.txt">Untitled</a><br/>
<span style="color: #5b89d5"><span style="font-size: small">(11:13:08)</span> <b>sthapa:</b></span> actually, think I might have found the error<br/>
<span style="color: #5b89d5"><span style="font-size: small">(11:18:54)</span> <b>sthapa:</b></span> fixed<br/>
<span style="color: #bd9336"><span style="font-size: small">(11:23:54)</span> <b>mkandes:</b></span> Yeah, that's usually a problem with the squid server.<br/>
<span style="color: #bd9336"><span style="font-size: small">(11:24:34)</span> <b>mkandes:</b></span> that is, the "failed to load file" error is usually associated with a squid problem<br/>
<span style="color: #674b1b"><span style="font-size: small">(13:48:50)</span> <b>rynge:</b></span> @mkandes Re the held question from yesterday, I was mostly wondering what all the orange is in : <a href="http://gfactory-1.t2.ucsd.edu/factory/monitor/factoryCompletedStats.html?entry=total&amp;frontend=OSG_Flock_frontend&amp;infoGroup=Lasted">http://gfactory-1.t2.ucsd.edu/factory/monitor/factoryCompletedStats.html?entry=total&amp;frontend=OSG_Flock_frontend&amp;infoGroup=Lasted</a><br/>
<span style="color: #bd9336"><span style="font-size: small">(14:00:29)</span> <b>mkandes:</b></span> @mats: Oh, those aren't held glideins. They are short-lived glideins. i.e., they are glideins that likely never get used and shutdown after 20 minutes.<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:01:52)</span> <b>rynge:</b></span> Ok, but I usually get logs (remember the rsync?) which allows me to figure the problem. However, I don't see anything currently, but the graph shows we have a huge number failing. How can we debug?<br/>
<span style="color: #bd9336"><span style="font-size: small">(14:02:55)</span> <b>mkandes:</b></span> Where do you see them failing?<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:03:31)</span> <b>rynge:</b></span> I mean in that graph. About half of all our glideins are only running for minutes<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:03:38)</span> <b>rynge:</b></span> I want to know why<br/>
<span style="color: #bd9336"><span style="font-size: small">(14:03:51)</span> <b>mkandes:</b></span> Because there are no user jobs running on them ...<br/>
<span style="color: #bd9336"><span style="font-size: small">(14:03:53)</span> <b>mkandes:</b></span> <a href="http://gfactory-1.t2.ucsd.edu/factory/monitor/factoryCompletedStats.html?entry=total&amp;frontend=OSG_Flock_frontend&amp;infoGroup=JobsNr">http://gfactory-1.t2.ucsd.edu/factory/monitor/factoryCompletedStats.html?entry=total&amp;frontend=OSG_Flock_frontend&amp;infoGroup=JobsNr</a><br/>
<span style="color: #bd9336"><span style="font-size: small">(14:04:08)</span> <b>mkandes:</b></span> so if no one is using them, they will shut themselves down.<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:05:18)</span> <b>rynge:</b></span> Fine, but we have a lot of jobs pending, so then the question is why are there no jobs on them?<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:05:40)</span> <b>rynge:</b></span> I would like to see at least what sites that happens on so we can start digging<br/>
<span style="color: #bd9336"><span style="font-size: small">(14:07:29)</span> <b>mkandes:</b></span> That's probably a harder question to answer. Then we need to know what the pending user jobs resource requirements are. They could simply not match the resources available at the sites of those short-lived glideins. But we can look around. Can you give me an idea of the typical requirements in the pending jobs on the front-end?<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:08:52)</span> <b>rynge:</b></span> We have all kinds - I have a hard time believing this would be to user job requirements. I think it more likely that these glideins are never registering so we never get to see them<br/>
<span style="color: #bd9336"><span style="font-size: small">(14:09:37)</span> <b>mkandes:</b></span> Okay, I'll try to find if there are any sites with that kind of problem.<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:10:44)</span> <b>rynge:</b></span> Thanks, in the mean time I will look for bad numbers in the daily emails and see if I can find something standing out<br/>
<span style="color: #bd9336"><span style="font-size: small">(14:10:53)</span> <b>mkandes:</b></span> Sounds good.<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:17:24)</span> <b>rynge:</b></span> The 0-job sites are:<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:17:26)</span> <b>rynge:</b></span> OSG_US_Utah_CHPC_osggate_el6<br/>OSG_US_Stanford_Proclus<br/>CMS_T2_US_Nebraska_sandhills_ce1<br/>CMS_T2_US_Nebraska_Red_gw1_op<br/>CMSHTPC_T2_US_UCSD_gw6<br/>CMSHTPC_T2_US_UCSD_gw2<br/>CMSHTPC_T2_US_Caltech_cit2<br/>CMSHTPC_T2_US_Caltech_cit<br/>CMSHTPC_T2_US_UCSD_gw7<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:18:09)</span> <b>rynge:</b></span> First, let's disable the Utah entries - there is something wrong with that sites and filesystems<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:18:47)</span> <b>rynge:</b></span> Secondly, some of rest - we had some really old glideins which started to show up, for example from UCSDT2<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:19:09)</span> <b>rynge:</b></span> Must have sat in a queue forever<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:22:20)</span> <b>rynge:</b></span> If you look at logs, check OSG_GLIDEIN_VERSION<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:22:28)</span> <b>rynge:</b></span> Any number under 150 is old<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:23:54)</span> <b>rynge:</b></span> And re Eric's email - Yes, please add OSG VO to the EL7 SU entry<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:23:56)</span> <b>rynge:</b></span> Thanks!<br/>
<span style="color: #bd9336"><span style="font-size: small">(14:25:41)</span> <b>mkandes:</b></span> Will do after lunch.<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:25:58)</span> <b>rynge:</b></span> Great<br/>
<span style="color: #bd9336"><span style="font-size: small">(15:39:34)</span> <b>mkandes:</b></span> @rynge: I'm seeing plenty of running glideins at Stanford. You don't see any at the frontend?<br/>
<span style="color: #bd9336"><span style="font-size: small">(15:39:36)</span> <b>mkandes:</b></span> 2017-02-10 21:38:33 UTC [gfactory@glidein:/var/log/gwms-factory/client/user_feosgflock/glidein_gfactory_instance/entry_OSG_US_Stanford_Proclus]$ entry_q OSG_US_Stanford_Proclus<br/><br/><br/>-- Schedd: <a href="mailto:schedd_glideins9@glidein.grid.iu.edu">schedd_glideins9@glidein.grid.iu.edu</a> : &lt;129.79.53.27:24395?...<br/> ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD               <br/>4028757.1   feosgflock      2/9  04:44   1+15:22:23 R  0   0.1  glidein_startup.sh<br/>4028905.0   feosgflock      2/9  06:26   1+13:24:04 R  0   0.1  glidein_startup.sh<br/>4029287.0   feosgflock      2/9  09:37   1+09:16:15 R  0   0.1  glidein_startup.sh<br/>4029596.0   feosgflock      2/9  12:30   1+06:21:23 R  0   0.1  glidein_startup.sh<br/>4030329.0   feosgflock      2/9  19:59   1+01:27:41 R  0   0.1  glidein_startup.sh<br/>4030352.0   feosgflock      2/9  20:08   1+01:13:11 R  0   0.1  glidein_startup.sh<br/>4030352.1   feosgflock      2/9  20:08   1+01:12:05 R  0   0.1  glidein_startup.sh<br/>4030352.3   feosgflock      2/9  20:08   1+01:12:06 R  0   0.1  glidein_startup.sh<br/>4030352.4   feosgflock      2/9  20:08   1+01:11:02 R  0   0.1  glidein_startup.sh<br/>4030353.0   feosgflock      2/9  20:08   1+01:11:01 R  0   0.1  glidein_startup.sh<br/>4030353.3   feosgflock      2/9  20:08   1+01:14:15 R  0   0.1  glidein_startup.sh<br/>4030353.4   feosgflock      2/9  20:08   1+01:12:07 R  0   0.1  glidein_startup.sh<br/>4030409.0   feosgflock      2/9  20:33   1+00:39:04 R  0   0.1  glidein_startup.sh<br/>4030439.1   feosgflock      2/9  20:49   1+00:20:12 R  0   0.1  glidein_startup.sh<br/>4030453.0   feosgflock      2/9  21:01   0+23:49:57 R  0   0.1  glidein_startup.sh<br/>4030477.1   feosgflock      2/9  21:16   0+22:59:50 R  0   0.1  glidein_startup.sh<br/>4030620.0   feosgflock      2/9  22:44   0+21:50:43 R  0   0.1  glidein_startup.sh<br/>4030692.0   feosgflock      2/9  23:30   0+21:41:09 R  0   0.1  glidein_startup.sh<br/>4030692.1   feosgflock      2/9  23:30   0+21:41:55 R  0   0.1  glidein_startup.sh<br/>4030719.0   feosgflock      2/9  23:49   0+21:23:11 R  0   0.1  glidein_startup.sh<br/>4030722.0   feosgflock      2/9  23:52   0+21:22:05 R  0   0.1  glidein_startup.sh<br/>4030737.1   feosgflock      2/10 00:01   0+21:05:34 R  0   0.1  glidein_startup.sh<br/>4030737.2   feosgflock      2/10 00:01   0+21:08:50 R  0   0.1  glidein_startup.sh<br/>4030828.0   feosgflock      2/10 01:15   0+19:41:01 R  0   0.1  glidein_startup.sh<br/>4030828.1   feosgflock      2/10 01:15   0+19:26:46 R  0   0.1  glidein_startup.sh<br/>4030828.2   feosgflock      2/10 01:15   0+19:26:45 R  0   0.1  glidein_startup.sh<br/>4030828.3   feosgflock      2/10 01:15   0+19:26:45 R  0   0.1  glidein_startup.sh<br/>4030828.4   feosgflock      2/10 01:15   0+19:25:40 R  0   0.1  glidein_startup.sh<br/>4030829.0   feosgflock      2/10 01:15   0+19:48:47 R  0   0.1  glidein_startup.sh<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:40:10)</span> <b>rynge:</b></span> Yes I get those - at least some of them<br/>
<span style="color: #bd9336"><span style="font-size: small">(15:41:21)</span> <b>mkandes:</b></span> Okay. Anything you'd like me to check here? Or I'll move on down the list. Also, Utah entries are now out of production.<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:44:08)</span> <b>rynge:</b></span> Please look at the UCSDT2 ones - are they just old glideins?<br/>
<span style="color: #bd9336"><span style="font-size: small">(15:44:59)</span> <b>mkandes:</b></span> They are probably messed up gldieins. I think Edgar broke something yesterday and things go out of whack. I'll make sure to clear out any problematic glideins I spot.<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:45:27)</span> <b>rynge:</b></span> Ok - feel free to remove old ones if you find them<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:45:56)</span> <b>rynge:</b></span> Other than that, we don't have to look. I want to see if removing Utah impacts that graph<br/>
<span style="color: #bd9336"><span style="font-size: small">(15:48:11)</span> <b>mkandes:</b></span> Yeah, it should bring down the numbers. There were a lot of glideins simply failing to startup, with new ones starting up and trying again shortly thereafter.<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:50:28)</span> <b>rynge:</b></span> @mkandes Wow, that made a huge improvement on the graph!<br/>
<span style="color: #bd9336"><span style="font-size: small">(16:58:39)</span> <b>mkandes:</b></span> @marian: Any idea what's up with CMS_T2_US_Nebraska_sandhills_ce1? Are you all draining the site?<br/>
<span style="color: #bd9336"><span style="font-size: small">(16:58:43)</span> <b>mkandes:</b></span> <a href="http://glidein.grid.iu.edu/factory/monitor/factoryStatus.html?entry=CMS_T2_US_Nebraska_sandhills_ce1">http://glidein.grid.iu.edu/factory/monitor/factoryStatus.html?entry=CMS_T2_US_Nebraska_sandhills_ce1</a><br/>
<span style="color: #bd9336"><span style="font-size: small">(16:58:53)</span> <b>mkandes:</b></span> <a href="http://gfactory-1.t2.ucsd.edu/factory/monitor/factoryStatus.html?entry=CMS_T2_US_Nebraska_sandhills_ce1">http://gfactory-1.t2.ucsd.edu/factory/monitor/factoryStatus.html?entry=CMS_T2_US_Nebraska_sandhills_ce1</a><br/>
<span style="color: #53b759"><span style="font-size: small">(16:59:12)</span> <b>marian:</b></span> let me check<br/>
<span style="color: #bd9336"><span style="font-size: small">(17:01:29)</span> <b>mkandes:</b></span> @rynge: Oh, yeah. It looks like Utah was the only problem. I've found very little else that would have been contributing. That's the big problem with the way these "completed stats" graphs are organized. It's all relative. So when you get a broken site like this sucking in glideins it really skews the results.<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:01:52)</span> <b>rynge:</b></span> Understood. Thanks for looking!<br/>
<span style="color: #bd9336"><span style="font-size: small">(17:01:57)</span> <b>mkandes:</b></span> No problem.<br/>
<span style="color: #bd9336"><span style="font-size: small">(17:02:57)</span> <b>mkandes:</b></span> And you were probably right about the "older" glideins ... many of the other sites appear to have have glideins pending for some time due to depth of back queues lately.<br/>
<span style="color: #bd9336"><span style="font-size: small">(17:05:28)</span> <b>mkandes:</b></span> e.g., Suchandra and I saw this at Stanford last week too I think.<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:05:29)</span> <b>rynge:</b></span> What is funny about that is that we try to clear them every time we reconfig the frontend<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:06:20)</span> <b>rynge:</b></span> ./frontend/tools/remove_requested_glideins -d /var/lib/gwms-frontend/vofrontend<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:06:23)</span> <b>rynge:</b></span> That is what we do<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:06:53)</span> <b>rynge:</b></span> Maybe it doesn't do it well on the boscoce sites (or whatever the setup is at stanford)<br/>
<span style="color: #bd9336"><span style="font-size: small">(17:07:16)</span> <b>mkandes:</b></span> Ah, yeah, that would sounds like a good policy. But yeah, assuming you'll get perfect clearing is probably optimistic depending on communication between frontend and CE/glideins.<br/>
<span style="color: #bd9336"><span style="font-size: small">(17:07:34)</span> <b>mkandes:</b></span> Ah, that's probably true for the Bosco sites.<br/>
<span style="color: #bd9336"><span style="font-size: small">(17:08:38)</span> <b>mkandes:</b></span> I don't think there is a mechanism to clear jobs from local batch once they are submitted.<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:08:48)</span> <b>rynge:</b></span> Ok<br/>
<span style="color: #bd9336"><span style="font-size: small">(17:08:59)</span> <b>mkandes:</b></span> Probably only works while they are idle or held in CE queue.<br/>
<span style="color: #53b759"><span style="font-size: small">(19:45:59)</span> <b>marian:</b></span> @mkandes: sorry for getting back late on question about Nebraska... there is nothing strange we're aware of actually... looks like a bunch of stuff came back to life... let me know if you think something is heading to trouble...<br/>
</body>
</html>
