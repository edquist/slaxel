<!DOCTYPE html>
<html>
<head>
<title>Wed Sep 23, 2020 : #software (osg)</title>
</head>
<body>
<h3>Wed Sep 23, 2020 : #software (osg)</h3>
<span style="color: #e96699"><span style="font-size: small">(11:57:37)</span> <b>lincoln:</b></span> <pre>[root@login ~]# yum install --enablerepo=osg-upcoming condor-8.9.6 python2-condor-8.9.6 blahp-1.18.46-1.osgup.el7.x86_64 python2-scitokens-credmon-0.4<br/>Loaded plugins: fastestmirror, priorities, versionlock<br/>Loading mirror speeds from cached hostfile<br/> * base: <a href="http://mirror.grid.uchicago.edu">mirror.grid.uchicago.edu</a><br/> * epel: <a href="http://mirror.grid.uchicago.edu">mirror.grid.uchicago.edu</a><br/> * extras: <a href="http://centos.mirror.constant.com">centos.mirror.constant.com</a><br/> * updates: <a href="http://ftpmirror.your.org">ftpmirror.your.org</a><br/>50 packages excluded due to repository priority protections<br/>Excluding 1 update due to versionlock (use "yum versionlock status" to show it)<br/>Package condor-8.9.6-1.osgup.el7.x86_64 already installed and latest version<br/>Package python2-condor-8.9.6-1.osgup.el7.x86_64 already installed and latest version<br/>Package blahp-1.18.46-1.osgup.el7.x86_64 already installed and latest version<br/>No package python2-scitokens-credmon-0.4 available.</pre><br/>@bbockelm<br/>
<span style="color: #43761b"><span style="font-size: small">(12:00:36)</span> <b>blin:</b></span> hrm, that should be available in the osg 3.5 release<br/>
<span style="color: #c386df"><span style="font-size: small">(12:01:43)</span> <b>matyas:</b></span> yah it's right there: <a href="http://repo.opensciencegrid.org/osg/3.5/el7/release/x86_64/python2-scitokens-credmon-0.4-2.osg35.el7.noarch.rpm">http://repo.opensciencegrid.org/osg/3.5/el7/release/x86_64/python2-scitokens-credmon-0.4-2.osg35.el7.noarch.rpm</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(12:03:29)</span> <b>bbockelm:</b></span> maybe give the full version?  I destroyed the docker container so I can't entirely confirm but I'd give <tt>python2-scitokens-credmon-0.4-2.osg35.el7.noarch</tt> a try<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:04:49)</span> <b>bbockelm:</b></span> Wait, it's a container.  I can recreate.<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:05:06)</span> <b>bbockelm:</b></span> Here's what I get with that exact command line:<br/><pre>========================================================================================================================================================<br/> Package                                      Arch                      Version                                   Repository                       Size<br/>========================================================================================================================================================<br/>Installing:<br/> blahp                                        x86_64                    1.18.46-1.osgup.el7                       osg-upcoming                    308 k<br/> condor                                       x86_64                    8.9.6-1.osgup.el7                         osg-upcoming                    5.3 M<br/> python2-condor                               x86_64                    8.9.6-1.osgup.el7                         osg-upcoming                    534 k<br/> python2-scitokens-credmon                    noarch                    0.4-2.osg35.el7                           osg                              43 k</pre><br/>
<span style="color: #9e3997"><span style="font-size: small">(12:05:43)</span> <b>bbockelm:</b></span> hm - missing the <tt>osg</tt> repo maybe?<br/>
<span style="color: #e96699"><span style="font-size: small">(12:23:02)</span> <b>lincoln:</b></span> should be enabled, maybe i manually disabled it<br/>
<span style="color: #e96699"><span style="font-size: small">(12:23:02)</span> <b>lincoln:</b></span> hang on<br/>
<span style="color: #e96699"><span style="font-size: small">(12:23:47)</span> <b>lincoln:</b></span> <pre>[root@login ~]# yum install --enablerepo=osg --enablerepo=osg-upcoming condor-8.9.6 python2-condor-8.9.6 blahp-1.18.46-1.osgup.el7.x86_64 python2-scitokens-credmon-0.4<br/>Loaded plugins: fastestmirror, priorities, versionlock<br/>Loading mirror speeds from cached hostfile<br/> * base: <a href="http://mirror.grid.uchicago.edu">mirror.grid.uchicago.edu</a><br/> * epel: <a href="http://mirror.grid.uchicago.edu">mirror.grid.uchicago.edu</a><br/> * extras: <a href="http://centos.mirror.constant.com">centos.mirror.constant.com</a><br/> * updates: <a href="http://ftpmirror.your.org">ftpmirror.your.org</a><br/>50 packages excluded due to repository priority protections<br/>Excluding 1 update due to versionlock (use "yum versionlock status" to show it)<br/>Package condor-8.9.6-1.osgup.el7.x86_64 already installed and latest version<br/>Package python2-condor-8.9.6-1.osgup.el7.x86_64 already installed and latest version<br/>Package blahp-1.18.46-1.osgup.el7.x86_64 already installed and latest version<br/>No package python2-scitokens-credmon-0.4 available.<br/>Nothing to do</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(12:23:50)</span> <b>lincoln:</b></span> THE MYSTERIES OF YUM<br/>
<span style="color: #e96699"><span style="font-size: small">(12:24:21)</span> <b>lincoln:</b></span> let me try removing them all ..<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:24:22)</span> <b>bbockelm:</b></span> hm.  Other things to check ... maybe horribly outdated <tt>osg</tt> repo mirror?<br/>
<span style="color: #e96699"><span style="font-size: small">(12:24:29)</span> <b>lincoln:</b></span> could be<br/>
<span style="color: #e96699"><span style="font-size: small">(12:24:44)</span> <b>lincoln:</b></span> I think i'm set to use the roundrobin<br/>
<span style="color: #e96699"><span style="font-size: small">(12:26:44)</span> <b>lincoln:</b></span> jeez<br/>
<span style="color: #e96699"><span style="font-size: small">(12:26:50)</span> <b>lincoln:</b></span> condor really does not want to stop nicely with the pythonized daemons<br/>
<span style="color: #c386df"><span style="font-size: small">(12:28:52)</span> <b>matyas:</b></span> why, what's happening?<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:34:09)</span> <b>bbockelm:</b></span> Something else you could do is <tt>yum provides python2-scitokens-credmon</tt> to see what repo it is picking up...<br/>
<span style="color: #e96699"><span style="font-size: small">(12:38:25)</span> <b>lincoln:</b></span> when I run <tt>systemctl stop condor</tt> it seems to take an exceptionally long time<br/>
<span style="color: #e96699"><span style="font-size: small">(12:38:37)</span> <b>lincoln:</b></span> running <tt>killall -u condor</tt> also does nothing<br/>
<span style="color: #e96699"><span style="font-size: small">(12:38:44)</span> <b>lincoln:</b></span> so i have to kill -9 the thing<br/>
<span style="color: #e96699"><span style="font-size: small">(12:39:17)</span> <b>lincoln:</b></span> <pre>[root@login ~]# yum provides python2-scitokens-credmon<br/>Loaded plugins: fastestmirror, priorities, versionlock<br/>Loading mirror speeds from cached hostfile<br/> * base: <a href="http://mirror.grid.uchicago.edu">mirror.grid.uchicago.edu</a><br/> * epel: <a href="http://mirror.grid.uchicago.edu">mirror.grid.uchicago.edu</a><br/> * extras: <a href="http://centos.mirror.constant.com">centos.mirror.constant.com</a><br/> * updates: <a href="http://ftpmirror.your.org">ftpmirror.your.org</a><br/>50 packages excluded due to repository priority protections<br/>Excluding 1 update due to versionlock (use "yum versionlock status" to show it)<br/>python2-scitokens-credmon-0.7-1.osg35.el7.noarch : SciTokens credential monitor for use with HTCondor<br/>Repo        : osg</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(12:39:46)</span> <b>lincoln:</b></span> i guess i should remove the versionlock as well<br/>
<span style="color: #c386df"><span style="font-size: small">(12:41:48)</span> <b>matyas:</b></span> Hmm. If you want the old version, it _is_ in the osg repo.<br/>Edit /etc/yum.repos.d/osg.repo; comment out the "metalink" line and uncomment the "baseurl" line<br/>
<span style="color: #e96699"><span style="font-size: small">(12:42:08)</span> <b>lincoln:</b></span> okay, im definitely getting osg-upcoming only from mirror.grid<br/>
<span style="color: #e96699"><span style="font-size: small">(12:42:10)</span> <b>lincoln:</b></span> let me see if its outdated<br/>
<span style="color: #e96699"><span style="font-size: small">(12:42:14)</span> <b>lincoln:</b></span> or otherwise screwed up<br/>
<span style="color: #e96699"><span style="font-size: small">(12:43:21)</span> <b>lincoln:</b></span> hasn't complained in my logs<br/>
<span style="color: #e96699"><span style="font-size: small">(12:43:50)</span> <b>lincoln:</b></span> basically all im doing to sync the osg repo is<br/>
<span style="color: #e96699"><span style="font-size: small">(12:43:51)</span> <b>lincoln:</b></span> <pre><br/>rsync -aSH --delete --delete-after --delay-updates <a href="rsync://repo.opensciencegrid.org/osg">rsync://repo.opensciencegrid.org/osg</a> /tank/pub/osg/</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(12:44:09)</span> <b>lincoln:</b></span> anyhow i dont know that it is a problem<br/>
<span style="color: #c386df"><span style="font-size: small">(12:46:54)</span> <b>matyas:</b></span> Weird. Try it anyway?<br/>
<span style="color: #e96699"><span style="font-size: small">(12:46:57)</span> <b>lincoln:</b></span> yeah, am<br/>
<span style="color: #c386df"><span style="font-size: small">(12:48:04)</span> <b>matyas:</b></span> osg.repo, not osg-upcoming.repo<br/>
<span style="color: #e96699"><span style="font-size: small">(12:49:36)</span> <b>lincoln:</b></span> okay so i uh just pointed them both to the main repo<br/>
<span style="color: #e96699"><span style="font-size: small">(12:49:42)</span> <b>lincoln:</b></span> <pre><br/>[osg]<br/>name=OSG Software for Enterprise Linux 7 - $basearch<br/>baseurl=<a href="http://repo.opensciencegrid.org/osg/3.5/el7/rolling/$basearch">http://repo.opensciencegrid.org/osg/3.5/el7/rolling/$basearch</a><br/>#mirrorlist=<a href="http://repo.opensciencegrid.org/mirror/osg/3.5/el7/rolling/$basearch">http://repo.opensciencegrid.org/mirror/osg/3.5/el7/rolling/$basearch</a><br/>failovermethod=priority<br/>priority=98<br/>enabled=1<br/>gpgcheck=1<br/>gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-OSG<br/>consider_as_osg=yes</pre><br/>
<span style="color: #c386df"><span style="font-size: small">(12:49:43)</span> <b>matyas:</b></span> yep<br/>
<span style="color: #e96699"><span style="font-size: small">(12:49:47)</span> <b>lincoln:</b></span> <pre>[osg-upcoming]<br/>name=OSG Software for Enterprise Linux 7 - $basearch<br/>baseurl=<a href="http://repo.opensciencegrid.org/osg/upcoming/el7/release/$basearch">http://repo.opensciencegrid.org/osg/upcoming/el7/release/$basearch</a><br/>failovermethod=priority<br/>priority=98<br/>enabled=0<br/>gpgcheck=1<br/>gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-OSG<br/>consider_as_osg=yes</pre><br/>
<span style="color: #c386df"><span style="font-size: small">(12:49:52)</span> <b>matyas:</b></span> oh, it's pointed at rolling<br/>
<span style="color: #e96699"><span style="font-size: small">(12:50:02)</span> <b>lincoln:</b></span> it is<br/>
<span style="color: #e96699"><span style="font-size: small">(12:50:05)</span> <b>lincoln:</b></span> should i not be rolling<br/>
<span style="color: #e96699"><span style="font-size: small">(12:50:09)</span> <b>lincoln:</b></span> should i unroll<br/>
<span style="color: #c386df"><span style="font-size: small">(12:50:19)</span> <b>matyas:</b></span> yeah rolling is apparently configured to only have the latest<br/>
<span style="color: #e96699"><span style="font-size: small">(12:50:24)</span> <b>lincoln:</b></span> ah<br/>
<span style="color: #e96699"><span style="font-size: small">(12:50:31)</span> <b>lincoln:</b></span> that seems to be the crux of the issue then i'd expect<br/>
<span style="color: #e96699"><span style="font-size: small">(12:50:47)</span> <b>lincoln:</b></span> ok so can i just s/rolling/release ?<br/>
<span style="color: #c386df"><span style="font-size: small">(12:50:56)</span> <b>matyas:</b></span> yes<br/>
<span style="color: #e96699"><span style="font-size: small">(12:51:34)</span> <b>lincoln:</b></span> et voila<br/>
<span style="color: #e96699"><span style="font-size: small">(12:51:56)</span> <b>lincoln:</b></span> OK, now its installed :sweat:<br/>
<span style="color: #e96699"><span style="font-size: small">(12:51:59)</span> <b>lincoln:</b></span> thanks guys<br/>
<span style="color: #e96699"><span style="font-size: small">(12:52:06)</span> <b>lincoln:</b></span> lets do this again some time!<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:52:19)</span> <b>bbockelm:</b></span> yum!  You so crazy...<br/>
<span style="color: #e96699"><span style="font-size: small">(12:53:04)</span> <b>lincoln:</b></span> i should've known that rolling release would be a thorn in my side :wink:<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:53:41)</span> <b>bbockelm:</b></span> <tt>s/rolling/burn-the-ships/</tt><br/>
<span style="color: #e96699"><span style="font-size: small">(12:56:45)</span> <b>lincoln:</b></span> so I think my problem with condor hanging on stop is related, in some way, to the credmon being unhappy. I _think_ what's happening is that it's trying to clean up the children, but the credmon is in an unhappy state and won't exit without being sigkilled<br/>
<span style="color: #e96699"><span style="font-size: small">(12:57:01)</span> <b>lincoln:</b></span> ill let you know if i can reproduce it at some point<br/>
<span style="color: #c386df"><span style="font-size: small">(13:00:13)</span> <b>matyas:</b></span> yeah, please do!<br/>
<span style="color: #43761b"><span style="font-size: small">(13:52:43)</span> <b>jpatton:</b></span> This is fixed in 8.9.9 but I'll also port it back with the other fixes to the credmon... For now, if you hand kill the credmon with the higher pid, that should consistently work to bring it down<br/>
</body>
</html>
