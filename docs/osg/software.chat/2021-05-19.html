<!DOCTYPE html>
<html>
<head>
<title>Wed May 19, 2021 : #software (osg)</title>
</head>
<body>
<h3>Wed May 19, 2021 : #software (osg)</h3>
<span style="color: #a72f79"><span style="font-size: small">(00:23:54)</span> <b>andrew.melo:</b></span> This is probably not the exact right place to ask, but is there a way with the xroot client library to emit a readv and then get callbacks for each returned range instead of a single callback once all the bytes have been read?<br/>
<span style="color: #9e3997"><span style="font-size: small">(08:32:56)</span> <b>bbockelm:</b></span> Nope - don't believe so.  For a large part, the ReadV comes back as one large message from the server.<br/>
<span style="color: #a72f79"><span style="font-size: small">(09:17:14)</span> <b>andrew.melo:</b></span> Yeah, I figured as such. Oh well :slightly_smiling_face:<br/>
<span style="color: #43761b"><span style="font-size: small">(13:41:24)</span> <b>blin:</b></span> oh that's sorta annoying. first time contributors to a GitHub repo have to get approval to run any workflow runs<br/>
<span style="color: #43761b"><span style="font-size: small">(13:42:12)</span> <b>blin:</b></span> so downtime requests may not be automatically merged. <b>@edquist</b> do you know if we can auto-approve running workflows via webhook?<br/>
<span style="color: #16569E"><span style="font-size: small">(13:42:36)</span> <b>edquist:</b></span> whew<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:44:22)</span> <b>dweitzel:</b></span> Thanks miners!<br/>
<span style="color: #16569E"><span style="font-size: small">(13:44:57)</span> <b>edquist:</b></span> i do not know off hand - but github has ways to automate pretty much everything so it wouldn't surprise me if they do.  i guess the two questions are, (1) can github send webhooks for a new contributor, and (2) is there a github api that we can call to approve it<br/>
<span style="color: #16569E"><span style="font-size: small">(13:47:19)</span> <b>edquist:</b></span> there is a specific type of webhook for "Team added or modified on a repository."<br/>
<span style="color: #43761b"><span style="font-size: small">(13:48:04)</span> <b>blin:</b></span> hrm, i don't think that's what we want<br/>
<span style="color: #16569E"><span style="font-size: small">(13:48:46)</span> <b>edquist:</b></span> i guess a random contributor does not become a member of a team<br/>
<span style="color: #16569E"><span style="font-size: small">(13:49:08)</span> <b>edquist:</b></span> what makes someone a "first time contributor"<br/>
<span style="color: #16569E"><span style="font-size: small">(13:49:10)</span> <b>edquist:</b></span> ?<br/>
<span style="color: #16569E"><span style="font-size: small">(13:49:14)</span> <b>edquist:</b></span> making a PR?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:49:38)</span> <b>blin:</b></span> yeah, first time making a PR, i think<br/>
<span style="color: #c386df"><span style="font-size: small">(13:49:46)</span> <b>matyas:</b></span> @blin is this what happened with plaurens just now?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:49:54)</span> <b>blin:</b></span> yup<br/>
<span style="color: #43761b"><span style="font-size: small">(13:50:13)</span> <b>blin:</b></span> there were issues with the PR but the GHA didn't kick off until I allowed them to run<br/>
<span style="color: #16569E"><span style="font-size: small">(13:50:17)</span> <b>edquist:</b></span> ok well, we can definitely get notified when there is a PR<br/>
<span style="color: #16569E"><span style="font-size: small">(13:50:38)</span> <b>edquist:</b></span> what did you have to do to add them?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:52:15)</span> <b>blin:</b></span> there was a button or link i had to click to approve the contribution (but not merge the PR) so that it could run GHA<br/>
<blockquote>
<span style="color: #c386df"><span style="font-size: small">(13:53:39)</span> <b>matyas:</b></span> how did you know that you had to do that? did you just see a downtime PR come in and notice the lack of osg-bot action?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:55:23)</span> <b>blin:</b></span> Fred pinged me about not seeing a downtime in CRIC so I looked at the PR<br/>
<span style="color: #43761b"><span style="font-size: small">(13:55:37)</span> <b>blin:</b></span> the message/workflow is pretty obvious when you  go to the PR<br/>
<span style="color: #c386df"><span style="font-size: small">(13:56:19)</span> <b>matyas:</b></span> yep<br/>
<span style="color: #c386df"><span style="font-size: small">(13:56:25)</span> <b>matyas:</b></span> although it doesn't seem to leave any evidence<br/>
<span style="color: #43761b"><span style="font-size: small">(13:57:08)</span> <b>blin:</b></span> there may be some in the audit log<br/>
<span style="color: #16569E"><span style="font-size: small">(14:00:02)</span> <b>edquist:</b></span> which PR is it?<br/>
<span style="color: #43761b"><span style="font-size: small">(14:00:39)</span> <b>blin:</b></span> <a href="https://github.com/opensciencegrid/topology/pull/1830">https://github.com/opensciencegrid/topology/pull/1830</a><br/>
</blockquote>
<span style="color: #16569E"><span style="font-size: small">(13:53:31)</span> <b>edquist:</b></span> was it in the settings for a repository?<br/>
<blockquote>
<span style="color: #43761b"><span style="font-size: small">(13:54:55)</span> <b>blin:</b></span> nope, it shows up in the PR where the "checks" normally are, right above "merge PR". I assume anyone that has WRITE to the repo is allowed to approve it<br/>
</blockquote>
<span style="color: #9d8eee"><span style="font-size: small">(13:53:42)</span> <b>cat:</b></span> We got caught on this new behavior a few times in the IRIS-HEP website repo.<br/>
<span style="color: #43761b"><span style="font-size: small">(13:59:53)</span> <b>blin:</b></span> hrm there are some interaction "cooldowns" in the moderation section of the repo settings but that may just be for issues. it's not super clear<br/>
<span style="color: #16569E"><span style="font-size: small">(14:57:14)</span> <b>edquist:</b></span> @blin (and anyone else interested)<br/><br/>i found these in the topology logs<br/><br/><pre><br/>[Wed May 19 18:29:25.949670 2021] [wsgi:error] [pid 26037] [remote 192.168.13.172:36180] [2021-05-19 18:29:25,949] DEBUG in webhook_app: Got check_suite hook 'action_required' for '3a6d1e875b999d262429de85e4ab95f7014e2834'<br/><br/>[Wed May 19 18:29:26.474283 2021] [wsgi:error] [pid 26037] [remote 192.168.13.172:36180] [2021-05-19 18:29:26,474] INFO in webhook_app: Ignoring GitHub Actions 'action_required' check_suite hook<br/></pre><br/><br/>and checking out the webhook sent at the same time, i see in the payload<br/><br/><pre><br/>{<br/>  "action": "completed",<br/>  "check_suite": {<br/>    "id": 2781938203,<br/>    "node_id": "MDEwOkNoZWNrU3VpdGUyNzgxOTM4MjAz",<br/>    "head_branch": "patch-1",<br/>    "head_sha": "3a6d1e875b999d262429de85e4ab95f7014e2834",<br/>    "status": "completed",<br/>    "conclusion": "action_required",   &lt;---- HERE<br/>    "url": "<a href="https://api.github.com/repos/opensciencegrid/topology/check-suites/2781938203">https://api.github.com/repos/opensciencegrid/topology/check-suites/2781938203</a>",<br/>    "before": "0036098c15503e6d126f5f98ccde163da008b785",<br/>    "after": "3a6d1e875b999d262429de85e4ab95f7014e2834",<br/>    ...<br/></pre><br/><br/>The topology webhook app only OKs PRs when the <tt>check_suite</tt> comes back <tt>success</tt>; so that explains the initial posting.  I suppose we can use this <tt>action_required</tt> conclusion to have osg-bot approve (via the github api) the requester of the PR for whatever GHA access is needed.  I am just unclear what setting/permission is required in order for the workflow run to be triggered by a new contributor<br/>
</body>
</html>
