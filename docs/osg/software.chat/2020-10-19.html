<!DOCTYPE html>
<html>
<head>
<title>Mon Oct 19, 2020 : #software (osg)</title>
</head>
<body>
<h3>Mon Oct 19, 2020 : #software (osg)</h3>
<span style="color: #43761b"><span style="font-size: small">(08:45:21)</span> <b>blin:</b></span> @bockjoo could you open a ggus or freshdesk ticket and attach the <tt>osg-system-profiler</tt> output?<br/>
<blockquote>
<span style="color: #7d414c"><span style="font-size: small">(11:38:33)</span> <b>bockjoo:</b></span> The GGUS ticket is <a href="https://ggus.eu/index.php?mode=ticket_info&amp;ticket_id=149115">https://ggus.eu/index.php?mode=ticket_info&amp;ticket_id=149115</a><br/>
</blockquote>
<span style="color: #235e5b"><span style="font-size: small">(10:32:57)</span> <b>dweitzel:</b></span> <b>@edquist</b> is this your test node? osg-pilot-container:<a href="http://cm3000.chtc.wisc.edu">cm3000.chtc.wisc.edu</a><br/>
<span style="color: #16569E"><span style="font-size: small">(10:33:16)</span> <b>edquist:</b></span> it's where i was running tests from yes<br/>
<span style="color: #16569E"><span style="font-size: small">(10:33:42)</span> <b>edquist:</b></span> i had intended these to be marked as ITB records<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:34:51)</span> <b>dweitzel:</b></span> ok, no worries.  When you submit the usage, all vo's are supposed to be lower case.  The usage was coming in with VOName: OSG<br/>
<span style="color: #16569E"><span style="font-size: small">(10:34:58)</span> <b>edquist:</b></span> oh<br/>
<span style="color: #16569E"><span style="font-size: small">(10:35:00)</span> <b>edquist:</b></span> interesting<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:35:03)</span> <b>dweitzel:</b></span> Just saw it in my weekly "VO's to correct in GRACC"<br/>
<span style="color: #16569E"><span style="font-size: small">(10:35:11)</span> <b>edquist:</b></span> that is good to know<br/>
<span style="color: #16569E"><span style="font-size: small">(10:35:19)</span> <b>edquist:</b></span> thank you!<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:35:21)</span> <b>dweitzel:</b></span> Also, for whatever reason, it's getting ReportableVOName: N/A<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:35:33)</span> <b>dweitzel:</b></span> Which may mean that the ReportableVOName isn't set correctly on the raw record.<br/>
<span style="color: #16569E"><span style="font-size: small">(10:35:46)</span> <b>edquist:</b></span> i don't think i was setting ReportableVOName at all<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:35:49)</span> <b>dweitzel:</b></span> setting that also to osg would be good.<br/>
<span style="color: #16569E"><span style="font-size: small">(10:35:53)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:36:04)</span> <b>dweitzel:</b></span> It's not used for much, but it's used in corrections.<br/>
<span style="color: #16569E"><span style="font-size: small">(10:36:13)</span> <b>edquist:</b></span> (somewhat discussed in SOFTWARE-4169) do you know what the right setting for <tt>Grid</tt> should be?<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:36:36)</span> <b>dweitzel:</b></span> Also, all the usage looks to be marked as "Local"  At least the usage I saw at first.<br/>
<span style="color: #16569E"><span style="font-size: small">(10:36:59)</span> <b>edquist:</b></span> yeah i think this is because i was not explicitly setting Grid<br/>
<span style="color: #16569E"><span style="font-size: small">(10:37:07)</span> <b>edquist:</b></span> should i set it to <tt>OSG</tt> ?<br/>
<span style="color: #16569E"><span style="font-size: small">(10:37:20)</span> <b>edquist:</b></span> and, for testing, is it correct to set it to <tt>OSG-ITB</tt> ?<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:39:15)</span> <b>dweitzel:</b></span> Yes, OSG in production.  And OSG-ITB in testing.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:39:23)</span> <b>dweitzel:</b></span> Though... we don't really split out the testing data anywhere.<br/>
<span style="color: #16569E"><span style="font-size: small">(10:39:51)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(10:39:55)</span> <b>edquist:</b></span> relatedly -<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:41:18)</span> <b>dweitzel:</b></span> actually, we do have an ITB testing endpoing<br/>
<span style="color: #16569E"><span style="font-size: small">(10:41:19)</span> <b>edquist:</b></span> i had thought that setting Grid="OSG-ITB" in ProbeConfigs was the right way to configure a probe for itb/testing, but as far as i can tell most of the probes (eg condor) ignore this setting<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:41:21)</span> <b>dweitzel:</b></span> and it appears to be working.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:41:36)</span> <b>dweitzel:</b></span> The ProbeConfig should point to the endpoint: <a href="http://gratia-osg-itb.opensciencegrid.org">gratia-osg-itb.opensciencegrid.org</a><br/>
<span style="color: #16569E"><span style="font-size: small">(10:41:55)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(10:42:07)</span> <b>edquist:</b></span> and, Grid="OSG" or "OSG-ITB" ?<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:42:47)</span> <b>dweitzel:</b></span> OSG-ITB<br/>
<span style="color: #16569E"><span style="font-size: small">(10:42:51)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(10:43:01)</span> <b>edquist:</b></span> thank you, just wanted to verify<br/>
<span style="color: #16569E"><span style="font-size: small">(10:44:18)</span> <b>edquist:</b></span> is there a kibana for gracc itb also?<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:45:21)</span> <b>dweitzel:</b></span> Nope, but I could add an index to the current kibana to see ITB usage.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:45:25)</span> <b>dweitzel:</b></span> let me do that quick.<br/>
<span style="color: #16569E"><span style="font-size: small">(10:49:12)</span> <b>edquist:</b></span> ok, thanks!<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:49:21)</span> <b>dweitzel:</b></span> ok, new index pattern added to kibana.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:49:28)</span> <b>dweitzel:</b></span> Search for "ITB" in the index listing.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:49:35)</span> <b>dweitzel:</b></span> sorry, lowercase, "itb"<br/>
<span style="color: #16569E"><span style="font-size: small">(10:50:23)</span> <b>edquist:</b></span> there it is!<br/>
<span style="color: #16569E"><span style="font-size: small">(10:50:36)</span> <b>edquist:</b></span> great, thanks .. !<br/>
<span style="color: #16569E"><span style="font-size: small">(10:52:16)</span> <b>edquist:</b></span> looks like there is surprisingly somewhat regular traffic to the itb endpoint<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:57:09)</span> <b>dweitzel:</b></span> I agree, I'm asking what's up?<br/>
<span style="color: #16569E"><span style="font-size: small">(10:58:09)</span> <b>edquist:</b></span> i wasn't aware that anybody was sending stuff to the itb endpoint<br/>
<span style="color: #16569E"><span style="font-size: small">(10:58:24)</span> <b>edquist:</b></span> i haven't personally<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:58:46)</span> <b>dweitzel:</b></span> Yup, investigating now<br/>
<span style="color: #43761b"><span style="font-size: small">(11:02:31)</span> <b>blin:</b></span> @dweitzel <b>@edquist</b> meeting time!<br/>
<span style="color: #16569E"><span style="font-size: small">(11:02:50)</span> <b>edquist:</b></span> thanks !<br/>
<span style="color: #a72f79"><span style="font-size: small">(11:18:58)</span> <b>andrew.melo:</b></span> In the CE, we occasionally get timeouts from when our local scheduler is overloaded and not replying on time:<br/><pre>HoldReason = "no jobId in submission script's output (stdout:) (stderr: execute_cmd: 30 seconds timeout expired, killing child process.-)"</pre><br/>Is there a knob we can use to bump that up?<br/>
<span style="color: #7d414c"><span style="font-size: small">(11:31:50)</span> <b>bockjoo:</b></span> @andrew.melo I don't know the knob, but I always suspect there is some with the SLURM in this case. So I would submit a job  to the slurm from the CE as the user in question.<br/>
<span style="color: #a72f79"><span style="font-size: small">(11:32:52)</span> <b>andrew.melo:</b></span> The user works, it's just that it temporarily will take more than 30 secs to get the scheduler to reply back. We've got a lot of jobs in the queue<br/>
<span style="color: #7d414c"><span style="font-size: small">(11:34:12)</span> <b>bockjoo:</b></span> If the knob exists, it must be in the blah.conf.<br/>
<span style="color: #43761b"><span style="font-size: small">(11:36:42)</span> <b>blin:</b></span> i think that'd be the CE Gridmanager timeout, let me see if there's a knob for it<br/>
<span style="color: #a72f79"><span style="font-size: small">(11:41:49)</span> <b>andrew.melo:</b></span> could it possibly be <tt>GRIDMANAGER_JM_EXIT_LIMIT</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(11:46:10)</span> <b>blin:</b></span> ah that is actually coming from the blahp<br/>
<span style="color: #43761b"><span style="font-size: small">(11:48:18)</span> <b>blin:</b></span> could be <tt>blah_child_poll_timeout</tt> in the config<br/>
<span style="color: #43761b"><span style="font-size: small">(11:49:16)</span> <b>blin:</b></span> in seconds<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:40:11)</span> <b>dweitzel:</b></span> I need osg-configure help in <a href="https://support.opensciencegrid.org/a/tickets/65881">https://support.opensciencegrid.org/a/tickets/65881</a><br/>
<span style="color: #235e5b"><span style="font-size: small">(13:40:21)</span> <b>dweitzel:</b></span> @matyas ^<br/>
<span style="color: #c386df"><span style="font-size: small">(13:43:10)</span> <b>matyas:</b></span> He's right, changing 'group' in 40-siteinfo.ini is probably what you want to do. That will configure the gratia probes to report to <a href="http://gratia-osg-prod.opensciencegrid.org">gratia-osg-prod.opensciencegrid.org</a> instead of <a href="http://gratia-osg-itb.opensciencegrid.org">gratia-osg-itb.opensciencegrid.org</a>.<br/>
<span style="color: #c386df"><span style="font-size: small">(13:44:30)</span> <b>matyas:</b></span> It will also configure HTCondor-CE to report OSG_ResourceCatalog info to <a href="http://collector1.opensciencegrid.org">collector1.opensciencegrid.org</a> and <a href="http://collector2.opensciencegrid.org">collector2.opensciencegrid.org</a> (instead of <a href="http://collector-itb.opensciencegrid.org">collector-itb.opensciencegrid.org</a>)<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:45:10)</span> <b>dweitzel:</b></span> Great!  Thanks.<br/>
<span style="color: #a63024"><span style="font-size: small">(19:21:25)</span> <b>efajardo:</b></span> <b>@here</b> I have been trying to find why this <a href="https://osg-sw-submit.chtc.wisc.edu/tests/20201019-1209/012/osg-test-20201019.log">tests</a> on EL8 fail. For example XRootD:<br/><br/><pre>======================================================================<br/>FAIL: test_03_start_xrootd (osgtest.tests.test_158_xrootd_tpc.TestStartXrootdTPC)<br/>----------------------------------------------------------------------<br/>Traceback (most recent call last):<br/>  File "/usr/lib/python3.6/site-packages/osgtest/library/osgunittest.py", line 196, in run<br/>    testMethod()<br/>  File "/usr/lib/python3.6/site-packages/osgtest/tests/test_158_xrootd_tpc.py", line 105, in test_03_start_xrootd<br/>    service.check_start(core.config['xrootd_tpc_service_1'], log_to_check = '/var/log/xrootd/third-party-copy-1/xrootd.log', min_up_time = 5)<br/>  File "/usr/lib/python3.6/site-packages/osgtest/library/service.py", line 48, in check_start<br/>    assert is_running(service_name, timeout=10, log_to_check = log_to_check), "%s is not running" % service_name<br/>AssertionError: xrootd-privileged@third-party-copy-1 is not running</pre><br/>
<span style="color: #a63024"><span style="font-size: small">(19:21:32)</span> <b>efajardo:</b></span> But In the log<br/>
<span style="color: #a63024"><span style="font-size: small">(19:21:50)</span> <b>efajardo:</b></span> <tt>/osgtest/runs/run-20201019-1209/jobs/output-012/output/system-files/var/log/xrootd/third-party-copy-1/xrootd.log</tt><br/>
<span style="color: #a63024"><span style="font-size: small">(19:22:30)</span> <b>efajardo:</b></span> In fact I do not see it failing to start at all<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(19:25:26)</span> <b>didavila:</b></span> well, it looks like the logs are either incomplete or XRootD was just preempted without logging any error<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(19:25:46)</span> <b>didavila:</b></span> it doesn’t look like the initialization was finished<br/>
<span style="color: #a63024"><span style="font-size: small">(19:26:48)</span> <b>efajardo:</b></span> I do not think it was preempted maybe the assert was too impatient<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(19:27:11)</span> <b>didavila:</b></span> and the logs are incomplete then?<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(19:27:20)</span> <b>didavila:</b></span> I normally see something like:<br/><pre>------ xrootd <a href="mailto:tpc@fermicloud345.fnal.gov">tpc@fermicloud345.fnal.gov</a>:1094 initialization completed.</pre><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(19:27:26)</span> <b>didavila:</b></span> at the end of the initialization<br/>
<span style="color: #a63024"><span style="font-size: small">(19:27:32)</span> <b>efajardo:</b></span> right<br/>
<span style="color: #a63024"><span style="font-size: small">(19:27:34)</span> <b>efajardo:</b></span> I can try<br/>
<span style="color: #a63024"><span style="font-size: small">(19:31:02)</span> <b>efajardo:</b></span> to increaset<br/>
</body>
</html>
