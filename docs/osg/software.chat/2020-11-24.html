<!DOCTYPE html>
<html>
<head>
<title>Tue Nov 24, 2020 : #software (osg)</title>
</head>
<body>
<h3>Tue Nov 24, 2020 : #software (osg)</h3>
<span style="color: #235e5b"><span style="font-size: small">(10:20:58)</span> <b>dweitzel:</b></span> What's the best way to open a pull request to change this file: <a href="https://github.com/opensciencegrid/Software-Redhat/blob/trunk/osg-xrootd/osg/50-osg-monitoring.cfg">https://github.com/opensciencegrid/Software-Redhat/blob/trunk/osg-xrootd/osg/50-osg-monitoring.cfg</a> ?<br/>
<span style="color: #c386df"><span style="font-size: small">(10:30:57)</span> <b>matyas:</b></span> Make a JIRA ticket and attach a patch to it.<br/>
<span style="color: #235e5b"><span style="font-size: small">(10:32:28)</span> <b>dweitzel:</b></span> <a href="https://opensciencegrid.atlassian.net/browse/SOFTWARE-4376">https://opensciencegrid.atlassian.net/browse/SOFTWARE-4376</a><br/>
<span style="color: #e96699"><span style="font-size: small">(16:02:36)</span> <b>lincoln:</b></span> hi folks, Judith and I are still scratching our heads over the failed TPC smoke tests at MWT2, failing due to CRLs.<br/><br/><br/> We're using certs from oasis, typically, but we've moved one server to using certs from the normal packages. Just comparing them we see:<br/><pre><br/>Files /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/1db3b27f.r0 and /etc/grid-security/certificates/1db3b27f.r0 differ<br/>Only in /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates: 4b2783ac.r0<br/>Files /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/62c4a178.r0 and /etc/grid-security/certificates/62c4a178.r0 differ<br/>Only in /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates: 7f4db168.r0<br/>Files /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/82c2b224.r0 and /etc/grid-security/certificates/82c2b224.r0 differ<br/>Files /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/8dd53007.r0 and /etc/grid-security/certificates/8dd53007.r0 differ<br/>Files /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/c7a717ce.r0 and /etc/grid-security/certificates/c7a717ce.r0 differ<br/>Files /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/dbf09133.r0 and /etc/grid-security/certificates/dbf09133.r0 differ<br/>Files /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/e523eeaa.r0 and /etc/grid-security/certificates/e523eeaa.r0 differ<br/>Files /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/e732ef10.r0 and /etc/grid-security/certificates/e732ef10.r0 differ</pre><br/>just looking at these files they don't see all that different, just different lastupdate/nextupdate<br/><pre><br/>[root@uct2-s32 ~]# openssl crl -in /cvmfs/oasis.opensciencegrid.org/osg-software/osg-wn-client/certificates/82c2b224.r0 -lastupdate -nextupdate -noout<br/>lastUpdate=Nov 23 19:04:15 2020 GMT<br/>nextUpdate=Dec 23 19:04:15 2020 GMT<br/>[root@uct2-s32 ~]# openssl crl -in /etc/grid-security/certificates/82c2b224.r0 -lastupdate -nextupdate -noout<br/>lastUpdate=Nov 24 19:04:23 2020 GMT<br/>nextUpdate=Dec 24 19:04:23 2020 GMT</pre><br/>how frequently is <tt>fetch-crl</tt> run on OASIS? does anyone have an inkling as to whether or not the above may be causing us to flap TPC tests?<br/>
<span style="color: #e96699"><span style="font-size: small">(16:04:11)</span> <b>lincoln:</b></span> perhaps there is some negative effect from caching at play? we _often_ but not _always_ pass the smoke tests, and when we fail, we get errors of the type:<br/><pre>Initiating a macaroon authz HTTP PULL, authz with macaroon to<br/>target: FAILED:  java.security.cert.CertificateException: The peer's<br/>certificate with subject's DN<br/>CN=<a href="http://prometheus.desy.de">prometheus.desy.de</a>,OU=DESY,O=GermanGrid,C=DE was rejected. The peer's<br/>certificate status is: FAILED The following validation errors were<br/>found:;error at position 0 in chain, problematic certificate subject:<br/>CN=<a href="http://prometheus.desy.de">prometheus.desy.de</a>,OU=DESY,O=GermanGrid,C=DE (category: CRL):<br/>Signature of a CRL corresponding to this certificates CA is invalid<br/>     Deleting target with macaroon: SKIPPED: third-party transfer failed</pre><br/><br/>
<span style="color: #c386df"><span style="font-size: small">(17:17:11)</span> <b>matyas:</b></span> fetch-crl runs every 6 hours<br/>
<span style="color: #c386df"><span style="font-size: small">(17:21:04)</span> <b>matyas:</b></span> The two crl files you're missing come from PSC which is the site that you have to install perl-LWP-Protocol-https for<br/>
<span style="color: #c386df"><span style="font-size: small">(17:21:34)</span> <b>matyas:</b></span> but that has nothing to do with the DESY certificate you see in the TPC error<br/>
<span style="color: #9e3997"><span style="font-size: small">(18:06:29)</span> <b>bbockelm:</b></span> If you do openssl s_client, it should tell you the immediate CA.<br/>
<span style="color: #e96699"><span style="font-size: small">(18:12:51)</span> <b>lincoln:</b></span> yeah, im not too concerned about the missing PSC ones.<br/>
</body>
</html>
