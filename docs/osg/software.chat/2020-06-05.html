<!DOCTYPE html>
<html>
<head>
<title>Fri Jun 5, 2020 : #software (osg)</title>
</head>
<body>
<h3>Fri Jun 5, 2020 : #software (osg)</h3>
<span style="color: #73769d"><span style="font-size: small">(09:24:18)</span> <b>tim.theisen:</b></span> My apologies for your trouble. I have pulled HTCondor 8.9.7 from the upcoming repositories. In HTCondor 8.9.7, changes were made to allow both Kerberos and OAUTH credmons to work side by side. Unfortunately, you need a newer version of scitokens-credmon and some manual steps need to be performed before upgrade. We will prepare the documentation and try again next week.<br/>
<span style="color: #d1707d"><span style="font-size: small">(13:37:41)</span> <b>gattebury:</b></span> Just to be clear, the above implies 8.9.7 is broken only in the sense of kerberos and OAUTH users? We had a power outage last night and I have a bunch of nodes that were freshly updated to it this morning.<br/>
<span style="color: #43761b"><span style="font-size: small">(13:50:22)</span> <b>blin:</b></span> the brokenness may just be limited to OAUTH users. basically 8.9.7 needs the new scitokens-creddmon in <tt>osg-testing</tt> and some manual updates<br/>
<span style="color: #43761b"><span style="font-size: small">(13:53:31)</span> <b>jpatton:</b></span> The main breaking change is that <tt>SEC_CREDENTIAL_DIRECTORY</tt> has no meaning anymore as each of <tt>KRB</tt> and <tt>OAUTH</tt> must have their own creddir knobs defined now. Upgrading to the new credmon is not strictly necessary *if* you only use one or the other (KRB or OAUTH) and you set e.g. <tt>SEC_CREDENTIAL_DIRECTORY_OAUTH = $(SEC_CREDENTIAL_DIRECTORY)</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(13:56:38)</span> <b>jpatton:</b></span> However, the recommendation is to move the oauth-related contents of the current creddir to <tt>/var/lib/condor/oauth_credentials</tt> (automatically created with the correct permissions in the 8.9.7 rpm) and point <tt>SEC_CREDENTIAL_DIRECTORY_OAUTH</tt> there (and do similar for kerberos if using that)<br/>
<span style="color: #43761b"><span style="font-size: small">(13:57:11)</span> <b>jpatton:</b></span> If you're not using oauth or krb you should be fine<br/>
<span style="color: #73769d"><span style="font-size: small">(13:57:25)</span> <b>tim.theisen:</b></span> If you're not having problems, I'd just leave it alone.<br/>
<span style="color: #d1707d"><span style="font-size: small">(14:50:55)</span> <b>gattebury:</b></span> Might be that my yum-fu is weak today, but I think the osg-upcoming repoo is currently broken for condor install after the removal of 8.9.7:<br/><pre>---&gt; Package condor.x86_64 0:8.9.6-1.osgup.el7 will be installed<br/>--&gt; Processing Dependency: condor-procd = 8.9.6-1.osgup.el7 for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Processing Dependency: condor-classads = 8.9.6-1.osgup.el7 for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Processing Dependency: blahp &gt;= 1.16.1 for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Processing Dependency: python-requests for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Processing Dependency: libclassad.so.11()(64bit) for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Running transaction check<br/>---&gt; Package blahp.x86_64 0:1.18.46-1.osg35.el7 will be installed<br/>--&gt; Processing Dependency: libclassad.so.10()(64bit) for package: blahp-1.18.46-1.osg35.el7.x86_64<br/>---&gt; Package condor-classads.x86_64 0:8.9.6-1.osgup.el7 will be installed<br/>---&gt; Package condor-procd.x86_64 0:8.9.6-1.osgup.el7 will be installed<br/>---&gt; Package python-requests.noarch 0:2.6.0-9.el7_8 will be installed<br/>--&gt; Processing Dependency: python-urllib3 &gt;= 1.10.2-1 for package: python-requests-2.6.0-9.el7_8.noarch<br/>--&gt; Running transaction check<br/>---&gt; Package blahp.x86_64 0:1.18.46-1.osg35.el7 will be installed<br/>--&gt; Processing Dependency: libclassad.so.10()(64bit) for package: blahp-1.18.46-1.osg35.el7.x86_64<br/>---&gt; Package python-urllib3.noarch 0:1.10.2-7.el7 will be installed<br/>--&gt; Finished Dependency Resolution<br/>Error: Package: blahp-1.18.46-1.osg35.el7.x86_64 (osg)<br/>           Requires: libclassad.so.10()(64bit)</pre><br/>I don’t know where <tt>blahp-1.18.46-1</tt> is coming from. I looked at all four mirrors from <a href="http://repo.opensciencegrid.org/mirror/osg/upcoming/el7/release/x86_64">http://repo.opensciencegrid.org/mirror/osg/upcoming/el7/release/x86_64</a> and all are sync’d up with <tt>blahp-1.18.45-1.1</tt> which is what it should be for the previous set of condor packages.<br/>
<span style="color: #d1707d"><span style="font-size: small">(14:51:19)</span> <b>gattebury:</b></span> (the above is with a fresh <tt>yum --enablerepo=osg-upcoming install condor</tt> for EL7 and OSG 3.5 for the record)<br/>
<span style="color: #43761b"><span style="font-size: small">(14:53:03)</span> <b>blin:</b></span> blahp-1.18.46 is in the release, i suspect we missed pulling that, too<br/>
<span style="color: #43761b"><span style="font-size: small">(14:53:08)</span> <b>blin:</b></span> @tim.theisen ^^<br/>
<span style="color: #43761b"><span style="font-size: small">(14:54:09)</span> <b>blin:</b></span> oh wait, koji's telling me some conflicting things<br/>
<span style="color: #73769d"><span style="font-size: small">(14:54:15)</span> <b>tim.theisen:</b></span> I pulled 1.18.46-3 from upcoming.<br/>
<span style="color: #73769d"><span style="font-size: small">(14:54:29)</span> <b>tim.theisen:</b></span> That was pushed with HTCondor 8.9.7<br/>
<span style="color: #43761b"><span style="font-size: small">(14:55:03)</span> <b>blin:</b></span> it's 1.18.46-1 that's potentially the problem from the yum messages above<br/>
<span style="color: #73769d"><span style="font-size: small">(14:56:24)</span> <b>tim.theisen:</b></span> 1.18.46-1 needs to be promoted to rolling/release. I'll do that right now.<br/>
<span style="color: #43761b"><span style="font-size: small">(14:57:51)</span> <b>blin:</b></span> i'm not sure that's it? does <tt>libclassad.so.10()</tt>  corresond to condor 8.8 or 8.9?<br/>
<span style="color: #73769d"><span style="font-size: small">(14:58:31)</span> <b>tim.theisen:</b></span> libclassad.so.10 applies to 8.8 and 8.9.6 and before.<br/>
<span style="color: #73769d"><span style="font-size: small">(14:58:49)</span> <b>tim.theisen:</b></span> So, getting the blahp from 3.5 should be just fine.<br/>
<span style="color: #73769d"><span style="font-size: small">(14:59:07)</span> <b>tim.theisen:</b></span> So, I should not need to promote anything.<br/>
<span style="color: #73769d"><span style="font-size: small">(14:59:47)</span> <b>tim.theisen:</b></span> let me double check when we bumped to 11 and 12.<br/>
<span style="color: #43761b"><span style="font-size: small">(15:02:27)</span> <b>blin:</b></span> clean installs of condor from upcoming are broken<br/>
<span style="color: #43761b"><span style="font-size: small">(15:04:36)</span> <b>blin:</b></span> looks like 8.9.6 needs <tt>libclassad.so.11</tt><br/><pre>           Updated By: condor-classads-8.9.6-1.osgup.el7.x86_64 (osg-upcoming)<br/>              ~libclassad.so.11()(64bit)</pre><br/>
<span style="color: #73769d"><span style="font-size: small">(15:06:30)</span> <b>tim.theisen:</b></span> I was right. I need to promote 1.18.46-1 in upcoming.<br/>
<span style="color: #73769d"><span style="font-size: small">(15:13:55)</span> <b>tim.theisen:</b></span> OK. The proper blahp RPMs are in place in upcoming rolling and release.<br/>
<span style="color: #43761b"><span style="font-size: small">(15:15:15)</span> <b>blin:</b></span> thanks for letting us know @gattebury!<br/>
<span style="color: #d1707d"><span style="font-size: small">(18:31:42)</span> <b>gattebury:</b></span> FYI I still think this is broken, but it’s certainly not critical for us over the weekend or anything. A fresh install with <tt>--enablerepo=osg-upcoming</tt> (after the 1.18.46-1 files were all in the mirrors) gives:<br/><pre>--&gt; Running transaction check<br/>---&gt; Package condor.x86_64 0:8.9.6-1.osgup.el7 will be installed<br/>--&gt; Processing Dependency: condor-procd = 8.9.6-1.osgup.el7 for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Processing Dependency: condor-classads = 8.9.6-1.osgup.el7 for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Processing Dependency: blahp &gt;= 1.16.1 for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Processing Dependency: python-requests for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Processing Dependency: libclassad.so.11()(64bit) for package: condor-8.9.6-1.osgup.el7.x86_64<br/>--&gt; Running transaction check<br/>---&gt; Package blahp.x86_64 0:1.18.46-1.osg35.el7 will be installed<br/>--&gt; Processing Dependency: libclassad.so.10()(64bit) for package: blahp-1.18.46-1.osg35.el7.x86_64<br/>---&gt; Package condor-classads.x86_64 0:8.9.6-1.osgup.el7 will be installed<br/>---&gt; Package condor-procd.x86_64 0:8.8.9-1.1.osg35.el7 will be updated<br/>---&gt; Package condor-procd.x86_64 0:8.9.6-1.osgup.el7 will be an update<br/>---&gt; Package python-requests.noarch 0:2.6.0-9.el7_8 will be installed<br/>--&gt; Processing Dependency: python-urllib3 &gt;= 1.10.2-1 for package: python-requests-2.6.0-9.el7_8.noarch<br/>--&gt; Running transaction check<br/>---&gt; Package blahp.x86_64 0:1.18.46-1.osg35.el7 will be installed<br/>--&gt; Processing Dependency: libclassad.so.10()(64bit) for package: blahp-1.18.46-1.osg35.el7.x86_64<br/>---&gt; Package python-urllib3.noarch 0:1.10.2-7.el7 will be installed<br/>--&gt; Finished Dependency Resolution<br/>Error: Package: blahp-1.18.46-1.osg35.el7.x86_64 (osg)<br/>           Requires: libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.8.4-1.8.osg35.el7.x86_64 (osg)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.8.5-1.6.osg35.el7.x86_64 (osg)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.8.5-1.7.osg35.el7.x86_64 (osg)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.8.6-1.1.osg35.el7.x86_64 (osg)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.8.7-1.osg35.el7.x86_64 (osg)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.8.8-1.osg35.el7.x86_64 (osg)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.8.9-1.1.osg35.el7.x86_64 (osg)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.9.2-1.4.osgup.el7.x86_64 (osg-upcoming)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.9.3-1.1.osgup.el7.x86_64 (osg-upcoming)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.9.4-1.osgup.el7.x86_64 (osg-upcoming)<br/>               libclassad.so.10()(64bit)<br/>           Available: condor-classads-8.9.5-1.osgup.el7.x86_64 (osg-upcoming)<br/>              ~libclassad.so.11()(64bit)<br/>           Installing: condor-classads-8.9.6-1.osgup.el7.x86_64 (osg-upcoming)<br/>              ~libclassad.so.11()(64bit)<br/> You could try using --skip-broken to work around the problem<br/> You could try running: rpm -Va --nofiles --nodigest</pre><br/>In particular:<br/><br/><tt>--&gt; Processing Dependency: libclassad.so.11()(64bit) for package: condor-8.9.6-1.osgup.el7.x86_64</tt><br/>and<br/><tt>--&gt; Processing Dependency: libclassad.so.10()(64bit) for package: blahp-1.18.46-1.osg35.el7.x86_64</tt><br/>indicate a conflict still right?<br/><br/>(not going to look at this further today, so this is purely a FYI)<br/>
<span style="color: #d1707d"><span style="font-size: small">(18:32:55)</span> <b>gattebury:</b></span> Ahhh, I think I answered my own question with those last two lines — I see the <tt>.osgup.</tt> is missing from the blahp one … so this is probably all my problem again :wink:<br/>
<span style="color: #73769d"><span style="font-size: small">(18:55:52)</span> <b>tim.theisen:</b></span> I can take a while for the release repositories to propagate. The proper blahp is in osgup. Just have to be patient, I guess.<br/>
<span style="color: #d1707d"><span style="font-size: small">(19:13:29)</span> <b>gattebury:</b></span> Actually it was because there’s a <tt>blahp-1.18.46-1.osg35.el7.x86_64.rpm</tt> in the normal release repos too which confuses yum as it requires <tt>libclassad.so.10</tt> and yum won’t prefer the one from upcoming.<br/><br/>Doing a full <tt>yum --enablerepo=osg-upcoming install condor blahp</tt> to get it installed will work. I _suppose_ this is still an issue worth fixing then as a fresh <tt>install condor</tt> won’t be enough.<br/>
</body>
</html>
