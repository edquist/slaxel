<!DOCTYPE html>
<html>
<head>
<title>Tue Aug 31, 2021 : #software (osg)</title>
</head>
<body>
<h3>Tue Aug 31, 2021 : #software (osg)</h3>
<span style="color: #de5f24"><span style="font-size: small">(09:40:44)</span> <b>justas.balcas:</b></span> Hi, Did anyone tried to run xrootd under lvs/keepalived, not via xrootd-redirector?<br/>
<span style="color: #73769d"><span style="font-size: small">(10:31:53)</span> <b>tim.theisen:</b></span> @matyas Can you repo sync devops-itb so I can kick off VMU tests?<br/>
<span style="color: #c386df"><span style="font-size: small">(10:32:48)</span> <b>matyas:</b></span> Sure, though you should have the permissions to do it yourself.<br/>
<span style="color: #c386df"><span style="font-size: small">(10:34:37)</span> <b>matyas:</b></span> The commands I ran were<br/><pre>osg-koji list-tags | grep devops</pre><br/>to figure out the tag names, then<br/><pre>osg-koji regen-repo --nowait devops-el7-itb<br/>osg-koji regen-repo --nowait devops-el8-itb</pre><br/><br/>
<span style="color: #73769d"><span style="font-size: small">(10:35:36)</span> <b>tim.theisen:</b></span> Cool. I'll not pester you in the future.<br/>
<span style="color: #c386df"><span style="font-size: small">(10:37:07)</span> <b>matyas:</b></span> Do let me know if it doesn't work; you can keep track of the progress by looking for tasks with the method "createrepo" -- <a href="https://koji.opensciencegrid.org/koji/tasks?method=createrepo&amp;state=all&amp;view=tree&amp;order=-id">https://koji.opensciencegrid.org/koji/tasks?method=createrepo&amp;state=all&amp;view=tree&amp;order=-id</a><br/>
<span style="color: #c386df"><span style="font-size: small">(10:47:33)</span> <b>matyas:</b></span> For anyone building on the OSG Koji: if you run into build errors caused by out-of-date repo files (symptom: 404s trying to download OS/EPEL packages with versions that do not match what's in the OS/EPEL's repository (you will probably see a ton of these errors at the same time)), then run <tt>osg-koji regen-repo --nowait $BUILD_TAG</tt> where <tt>$BUILD_TAG</tt> is the tag ending in <tt>build</tt> (so do <tt>osg-koji list-tags | grep build</tt>) that is appropriate for the build you saw the error on. For example, if you were trying to build for 3.5 and your EL7 build failed like this, use <tt>osg-3.5-el7-build</tt>.<br/>
<span style="color: #c386df"><span style="font-size: small">(10:50:18)</span> <b>matyas:</b></span> As a side note, tags like <tt>devops-el7-itb</tt> that only have OSG packages in them rebuild very quickly; build tags tend to take ~8 minutes because of the metadata they fetch for all the OS/EPEL packages.<br/>
<span style="color: #43761b"><span style="font-size: small">(11:00:13)</span> <b>blin:</b></span> we have <a href="https://github.com/opensciencegrid/release-tools/blob/master/1-regen-repos">https://github.com/opensciencegrid/release-tools/blob/master/1-regen-repos</a><br/>
<span style="color: #43761b"><span style="font-size: small">(11:00:42)</span> <b>blin:</b></span> maybe we should just have it regen the other commonly used build repos, too<br/>
<span style="color: #c386df"><span style="font-size: small">(11:02:09)</span> <b>matyas:</b></span> define "commonly used" :slightly_smiling_face:<br/>
<span style="color: #43761b"><span style="font-size: small">(11:06:24)</span> <b>blin:</b></span> the ones that Tim asks you to regen :slightly_smiling_face:<br/>
<span style="color: #c386df"><span style="font-size: small">(11:08:07)</span> <b>matyas:</b></span> I don't think he's asked me about a build repo yet (except for release-build, for the tarballs)<br/>
<span style="color: #43761b"><span style="font-size: small">(11:09:22)</span> <b>blin:</b></span> ah i misread the above, let's just add devops-itb to the regen repo list since it doesn't have a minefield<br/>
<span style="color: #c386df"><span style="font-size: small">(11:12:19)</span> <b>matyas:</b></span> kojira should be regenning devops-itb<br/>
<span style="color: #c386df"><span style="font-size: small">(11:13:06)</span> <b>matyas:</b></span> if it didn't, that means something is broken with kojira<br/>
<span style="color: #c386df"><span style="font-size: small">(11:13:56)</span> <b>matyas:</b></span> so let's not add devops-itb.<br/>
<span style="color: #c386df"><span style="font-size: small">(11:14:34)</span> <b>matyas:</b></span> the only reason release-build needs to be regenned is if it hasn't been used in 30+ days and so gets cleaned up<br/>
<span style="color: #43761b"><span style="font-size: small">(11:17:36)</span> <b>blin:</b></span> was kojira broken then?<br/>
<span style="color: #c386df"><span style="font-size: small">(11:18:37)</span> <b>matyas:</b></span> no. I was illiterate<br/>
<span style="color: #c386df"><span style="font-size: small">(11:18:47)</span> <b>matyas:</b></span> Tim said "sync", I thought "regen"<br/>
<span style="color: #c386df"><span style="font-size: small">(11:19:10)</span> <b>matyas:</b></span> he actually meant "run mash"<br/>
<span style="color: #c386df"><span style="font-size: small">(11:20:05)</span> <b>matyas:</b></span> sorry :man-facepalming::skin-tone-2:<br/>
<span style="color: #c386df"><span style="font-size: small">(11:20:52)</span> <b>matyas:</b></span> we really need to add that devops-minefield<br/>
<span style="color: #c386df"><span style="font-size: small">(11:23:02)</span> <b>matyas:</b></span> well, I would log in and run mash, but Tim asked me like 50 minutes ago so it probably already ran...<br/>
<span style="color: #43761b"><span style="font-size: small">(11:29:25)</span> <b>blin:</b></span> ah, gotcha<br/>
<span style="color: #43761b"><span style="font-size: small">(11:29:30)</span> <b>blin:</b></span> that makes more sense then<br/>
<span style="color: #73769d"><span style="font-size: small">(11:44:10)</span> <b>tim.theisen:</b></span> Yeah, I kicked off the VMU tests and I got the old versions.<br/>
<span style="color: #c386df"><span style="font-size: small">(11:46:10)</span> <b>matyas:</b></span> when?<br/>
<span style="color: #c386df"><span style="font-size: small">(11:46:51)</span> <b>matyas:</b></span> well, let me just check. What version are you expecting?<br/>
<span style="color: #73769d"><span style="font-size: small">(12:24:07)</span> <b>tim.theisen:</b></span> I just relaunched and got the correct versions. So, everything is fine now and condor 9.1.4-0.555248 has been posted to devops-production.<br/>
<span style="color: #674b1b"><span style="font-size: small">(13:22:24)</span> <b>rynge:</b></span> <a href="https://github.com/opensciencegrid/tiger-osg-config/blob/master/manifests/base/vo-frontend-glow/frontend_scitoken">https://github.com/opensciencegrid/tiger-osg-config/blob/master/manifests/base/vo-frontend-glow/frontend_scitoken</a><br/>
<span style="color: #674b1b"><span style="font-size: small">(13:22:40)</span> <b>rynge:</b></span> For where the tokens comes from ^^^<br/>
<span style="color: #674b1b"><span style="font-size: small">(13:24:22)</span> <b>rynge:</b></span> `<br/><pre>#!/bin/sh<br/>#<br/><br/># Example invocation:<br/>#<br/># $ scitokens-admin-create-token --lifetime 3600 --key_id 7b75 \<br/>#     --keyfile ~/tmp/chtc_keys/chtc.private.pem<br/>#     --issuer <a href="https://chtc.cs.wisc.edu">https://chtc.cs.wisc.edu</a> sub=vofrontend \<br/>#     'scope=compute.read compute.modify compute.create compute.cancel' \<br/>#     'wlcg.ver=1.0' 'aud=<a href="https://wlcg.cern.ch/jwt/v1/any">https://wlcg.cern.ch/jwt/v1/any</a>' "jti=$(uuidgen -r)"<br/><br/>KID=7b75<br/>KEYFILE=/etc/scitokens/key<br/>LIFETIME=3600<br/><br/>AUD=$1<br/>SUB=$2<br/><br/># create the token, echo it to stdout<br/>exec scitokens-admin-create-token --lifetime 3600 --key_id $KID \<br/>    --keyfile "$KEYFILE" \<br/>    --issuer <a href="https://chtc.cs.wisc.edu">https://chtc.cs.wisc.edu</a> \<br/>    sub="vofrontend-$SUB" \<br/>    'scope=compute.read compute.modify compute.create compute.cancel' \<br/>    'wlcg.ver=1.0' \<br/>    "aud=$AUD" \<br/>    "jti=$(uuidgen -r)"</pre><br/><br/>
<span style="color: #674b1b"><span style="font-size: small">(13:31:12)</span> <b>rynge:</b></span> Here is the current patch for the open pool fe: <a href="https://github.com/opensciencegrid/osg-flock/blob/master/flock.opensciencegrid.org/gwms-patches/3.9.2.patch">https://github.com/opensciencegrid/osg-flock/blob/master/flock.opensciencegrid.org/gwms-patches/3.9.2.patch</a><br/>
<span style="color: #43761b"><span style="font-size: small">(13:52:37)</span> <b>blin:</b></span> <a href="https://htcondor.github.io/htcondor-ce/v5/configuration/authentication/#scitokens">https://htcondor.github.io/htcondor-ce/v5/configuration/authentication/#scitokens</a><br/>
<span style="color: #674b1b"><span style="font-size: small">(13:53:34)</span> <b>rynge:</b></span> <pre>JOB_ROUTER_ENTRIES @=jre<br/>[<br/> name = "ITB";<br/> TargetUniverse = 5;<br/> set_AcctGroup = "itb";<br/> eval_set_AccountingGroup = strcat(AcctGroup, ".", Owner);<br/> Requirements = (TARGET.GlideinFactory == "OSG-ITB");<br/>]<br/>[<br/> name = "COVID19";<br/> TargetUniverse = 5;<br/> set_AcctGroup = "covid19";<br/> eval_set_AccountingGroup = strcat(AcctGroup, ".", Owner);<br/> Requirements = (TARGET.IsCOVID19 =?= true);<br/>]<br/>[<br/> name = "OSGJobs";<br/> TargetUniverse = 5;<br/> set_AcctGroup = "osg";<br/>]<br/>@jre</pre><br/><br/>
<span style="color: #a72f79"><span style="font-size: small">(13:54:10)</span> <b>andrew.melo:</b></span> Anyone know what would cause this trying to do TPC?<br/><pre>TPC_ProcessReq: COPY requested an unsupported credential type:  gridsite</pre><br/>
<blockquote>
<span style="color: #9e3997"><span style="font-size: small">(14:35:08)</span> <b>bbockelm:</b></span> That means FTS tried requesting a macaroon, couldn't, and then fell back to the (unsupported) gridsite.<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:36:39)</span> <b>andrew.melo:</b></span> Hm. Can I crank the logging for the macaroon-requesting?<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:38:57)</span> <b>andrew.melo:</b></span> Actually, that's from a gfal-copy, not fts<br/>
<span style="color: #a72f79"><span style="font-size: small">(14:39:02)</span> <b>andrew.melo:</b></span> FTS bombs differently with <a href="https://fts-devel-06.cern.ch:8449/var/log/fts3/transfers/2021-08-31/xrootd-vanderbilt.sites.opensciencegrid.org__xrootd-vanderbilt.sites.opensciencegrid.org/2021-08-31-1938__xrootd-vanderbilt.sites.opensciencegrid.org__xrootd-vanderbilt.sites.opensciencegrid.org__8858519335__f5e4deac-0a92-11ec-a98d-fa163ef53215">https://fts-devel-06.cern.ch:8449/var/log/fts3/transfers/2021-08-31/xrootd-vanderbilt.sit[…]id.org__8858519335__f5e4deac-0a92-11ec-a98d-fa163ef53215</a><br/>
</blockquote>
<span style="color: #a72f79"><span style="font-size: small">(13:58:33)</span> <b>andrew.melo:</b></span> I believe I have the correct incantation in my xrootd config:<br/><pre>if exec xrootd<br/>    xrd.protocol http:1094 /usr/lib64/libXrdHttp-4.so<br/>    http.cadir /etc/grid-security/certificates<br/>    http.cert /etc/grid-security/hostcert-xrootd.pem<br/>    http.key /etc/grid-security/hostkey-xrootd.pem<br/>    http.secxtractor /usr/lib64/libXrdLcmaps.so<br/>    http.listingdeny yes<br/>    http.staticpreload <a href="http://static/robots.txt">http://static/robots.txt</a> /etc/xrootd/robots.txt<br/>    http.desthttps yes<br/>    http.exthandler xrdtpc libXrdHttpTPC.so<br/>    http.header2cgi Authorization authz<br/>fi<br/><br/>http.exthandler xrdmacaroons libXrdMacaroons.so<br/>macaroons.secretkey /etc/xrootd/macaroon-secret<br/>ofs.authlib libXrdMacaroons.so</pre><br/>
<span style="color: #674b1b"><span style="font-size: small">(14:04:17)</span> <b>rynge:</b></span> @blin <tt>condor_ce_status -pool <a href="http://collector.opensciencegrid.org:9619">collector.opensciencegrid.org:9619</a> -schedd -const '!regexp("9\.0\.5", condorversion) &amp;&amp; !isundefined(OSG_resource)' -f '%s\n' name | sort | uniq</tt><br/>
<span style="color: #674b1b"><span style="font-size: small">(14:44:56)</span> <b>rynge:</b></span> <pre>{<br/>  "sub": "vofrontend-CHTC-ITB-SLURM-CE",<br/>  "scope": "compute.read compute.modify compute.create compute.cancel",<br/>  "wlcg.ver": "1.0",<br/>  "aud": "<a href="http://itb-slurm-ce.osgdev.chtc.io:9619">itb-slurm-ce.osgdev.chtc.io:9619</a>",<br/>  "jti": "290cb4a0-52e4-4e34-89ee-cfc91bead2c6",<br/>  "iss": "<a href="https://scitokens.org/osg-connect">https://scitokens.org/osg-connect</a>",<br/>  "exp": 1630440954,<br/>  "iat": 1630437354,<br/>  "nbf": 1630437354<br/>}</pre><br/><br/>
<span style="color: #674b1b"><span style="font-size: small">(14:49:48)</span> <b>rynge:</b></span> @jdost321 OSG_CHTC-ITB-SLURM-CE.scitoken<br/>
<span style="color: #385a86"><span style="font-size: small">(14:50:17)</span> <b>jdost321:</b></span> OSG_CHTC-canary2<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:51:59)</span> <b>rynge:</b></span> Current tokens for CHTC:<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:52:02)</span> <b>rynge:</b></span> <pre># ls /var/lib/gwms-frontend/tokens.d | grep CHTC<br/>OSG_CHTC-canary2.idtoken<br/>OSG_CHTC-ITB-SLURM-CE.idtoken<br/>OSG_CHTC-ITB-SLURM-CE.scitoken<br/>OSG_HOSTED-CE1-OSGDEV-CHTC.idtoken<br/>OSG_HOSTED-CE1-OSGDEV-CHTC.scitoken<br/>OSG_HOSTED-CE-CHTC-UBUNTU.idtoken<br/>OSG_US_CHTC-LHCB.idtoken</pre><br/><br/>
<span style="color: #9e3997"><span style="font-size: small">(15:05:28)</span> <b>bbockelm:</b></span> Currently sending SciTokens for CHTC frontend:<br/><br/>
<span style="color: #9e3997"><span style="font-size: small">(15:05:28)</span> <b>bbockelm:</b></span> <pre># ls -lhtr /var/lib/gwms-factory/client-proxies/user_feglowitb/glidein_gfactory_instance/ | grep -v '\~' | grep 'Aug 31'<br/>drwx------. 2 gfactory gfactory    6 Aug 31 08:29 entry_OSG_US_MWT2_gk<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 10:30 credential_CHTC-GLOW-Frontend.main_IIARVXFK.old<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 10:30 credential_CHTC-GLOW-Frontend.freshdesk67713_IIARVXFK.old<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 10:30 credential_CHTC-GLOW-Frontend.alloc-itb-CHTC-CPU-CHTC-Staff_IIARVXFK.old<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 10:30 credential_CHTC-GLOW-Frontend.glowGPU_IIARVXFK.old<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 10:30 credential_CHTC-GLOW-Frontend.glow-into-glow_IIARVXFK.old<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 12:32 credential_CHTC-GLOW-Frontend.freshdesk67713_IIARVXFK<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 12:32 credential_CHTC-GLOW-Frontend.alloc-itb-CHTC-CPU-CHTC-Staff_IIARVXFK<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 12:32 credential_CHTC-GLOW-Frontend.glowGPU_IIARVXFK<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 12:32 credential_CHTC-GLOW-Frontend.glow-into-glow_IIARVXFK<br/>-rw-------. 1 gfactory gfactory 7.9K Aug 31 12:34 credential_CHTC-GLOW-Frontend.main_IIARVXFK<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:02 credential_CHTC-GLOW-Frontend.main_IIARVXFK_compressed.old<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:02 credential_CHTC-GLOW-Frontend.freshdesk67713_IIARVXFK_compressed.old<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:02 credential_CHTC-GLOW-Frontend.alloc-itb-CHTC-CPU-CHTC-Staff_IIARVXFK_compressed.old<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:02 credential_CHTC-GLOW-Frontend.glowGPU_IIARVXFK_compressed.old<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:02 credential_CHTC-GLOW-Frontend.glow-into-glow_IIARVXFK_compressed.old<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:03 credential_CHTC-GLOW-Frontend.main_IIARVXFK_compressed<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:03 credential_CHTC-GLOW-Frontend.freshdesk67713_IIARVXFK_compressed<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:03 credential_CHTC-GLOW-Frontend.alloc-itb-CHTC-CPU-CHTC-Staff_IIARVXFK_compressed<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:03 credential_CHTC-GLOW-Frontend.glowGPU_IIARVXFK_compressed<br/>-rw-------. 1 gfactory gfactory 6.2K Aug 31 13:03 credential_CHTC-GLOW-Frontend.glow-into-glow_IIARVXFK_compressed<br/>-rw-------. 1 gfactory gfactory  526 Aug 31 13:04 credential_OSG_US_MWT2_mwt2_condce.scitoken<br/>-rw-------. 1 gfactory gfactory  523 Aug 31 13:04 credential_CMSHTPC_T2_US_Caltech_cit_op.scitoken<br/>-rw-------. 1 gfactory gfactory  517 Aug 31 13:04 credential_OSG_CA_CYBERA_EDMONTON.scitoken<br/>-rw-------. 1 gfactory gfactory  518 Aug 31 13:04 credential_CMS_T2_US_Purdue_hadoop_condce.scitoken<br/>-rw-------. 1 gfactory gfactory  507 Aug 31 13:04 credential_Engage_US_MWT2_uct2_condce_mcore.scitoken<br/>-rw-------. 1 gfactory gfactory  522 Aug 31 13:04 credential_GLUEX_US_UConn-HPC_osgce.scitoken<br/>-rw-------. 1 gfactory gfactory  526 Aug 31 13:04 credential_OSG_US_MWT2_mwt2_condce_mcore.scitoken<br/>-rw-------. 1 gfactory gfactory  514 Aug 31 13:04 credential_CMSHTPC_T3_US_Colorado_heposg01.scitoken<br/>-rw-------. 1 gfactory gfactory  507 Aug 31 13:04 credential_Engage_US_MWT2_iut2_condce.scitoken<br/>-rw-------. 1 gfactory gfactory  498 Aug 31 13:04 credential_OSG_US_IIT_iitce1_rhel6.scitoken<br/>-rw-------. 1 gfactory gfactory  517 Aug 31 13:04 credential_OSG_CHTC-canary2.scitoken<br/>-rw-------. 1 gfactory gfactory  525 Aug 31 13:04 credential_CMSHTPC_T2_US_Caltech_cit2_op.scitoken<br/>-rw-------. 1 gfactory gfactory  510 Aug 31 13:04 credential_CMSHTPC_T1_US_FNAL_condce_opp1_whole.scitoken<br/>-rw-------. 1 gfactory gfactory  507 Aug 31 13:04 credential_HCC_US_BNL_gk02.scitoken<br/>-rw-------. 1 gfactory gfactory  509 Aug 31 13:04 credential_HCC_BR_UNESP.scitoken<br/>-rw-------. 1 gfactory gfactory  507 Aug 31 13:04 credential_HCC_US_BNL_gk01.scitoken<br/>-rw-------. 1 gfactory gfactory  514 Aug 31 13:04 credential_HCC_US_Michigan_gate02.scitoken<br/>-rw-------. 1 gfactory gfactory  510 Aug 31 13:04 credential_FNAL_GPGrid_ce04_mcore_op.scitoken<br/>-rw-------. 1 gfactory gfactory  509 Aug 31 13:04 credential_OSG_US_CHTC-LHCB.scitoken<br/>-rw-------. 1 gfactory gfactory  534 Aug 31 13:04 credential_OSG_CHTC-ITB-SLURM-CE.scitoken<br/>-rw-------. 1 gfactory gfactory  501 Aug 31 13:04 credential_CMS_T2_US_Nebraska_Red_whole_op-gpu.scitoken<br/>-rw-------. 1 gfactory gfactory  511 Aug 31 13:04 credential_OSG_US_UConn_gluskap_op.scitoken<br/>-rw-------. 1 gfactory gfactory  507 Aug 31 13:04 credential_Engage_US_MWT2_uct2_condce.scitoken<br/>-rw-------. 1 gfactory gfactory  506 Aug 31 13:04 credential_CMS_T2_US_Nebraska_Red_gw1_whole_op.scitoken<br/>-rw-------. 1 gfactory gfactory  505 Aug 31 13:04 credential_HCC_US_Omaha_crane_gpu.scitoken<br/>-rw-------. 1 gfactory gfactory  526 Aug 31 13:04 credential_OSG_SLATE_US_NMSU_DISCOVERY.scitoken<br/>-rw-------. 1 gfactory gfactory  505 Aug 31 13:04 credential_CMS_T3_US_Omaha_crane.scitoken<br/>-rw-------. 1 gfactory gfactory  501 Aug 31 13:04 credential_CMS_T2_US_Nebraska_Red_whole_op.scitoken<br/>-rw-------. 1 gfactory gfactory  506 Aug 31 13:04 credential_CMS_T2_US_Nebraska_Red_gw2_whole_op.scitoken<br/>-rw-------. 1 gfactory gfactory  509 Aug 31 13:04 credential_OSG_US_Clemson-Palmetto_condce_mcore.scitoken<br/>-rw-------. 1 gfactory gfactory  507 Aug 31 13:04 credential_Engage_US_MWT2_iut2_condce_mcore.scitoken<br/>-rw-------. 1 gfactory gfactory  517 Aug 31 13:04 credential_HCC_US_Wisconsin_osg01_rhel7.scitoken<br/>-rw-------. 1 gfactory gfactory  498 Aug 31 13:04 credential_OSG_US_IIT_iitce2_rhel6.scitoken<br/>-rw-------. 1 gfactory gfactory  513 Aug 31 13:04 credential_Glow_US_Syracuse4_condor_gpu.scitoken<br/>-rw-------. 1 gfactory gfactory  513 Aug 31 13:04 credential_Glow_US_Syracuse2_condor_gpu.scitoken<br/>-rw-------. 1 gfactory gfactory  513 Aug 31 13:04 credential_IceCube_US_Wisconsin_osg-ce.scitoken<br/>-rw-------. 1 gfactory gfactory  513 Aug 31 13:04 credential_Glow_US_Syracuse_condor-ce4.scitoken<br/>-rw-------. 1 gfactory gfactory  513 Aug 31 13:04 credential_Glow_US_Syracuse_condor-ce2.scitoken<br/>-rw-------. 1 gfactory gfactory  513 Aug 31 13:04 credential_Glow_US_Syracuse_condor-ce3.scitoken<br/>-rw-------. 1 gfactory gfactory  513 Aug 31 13:04 credential_Glow_US_Syracuse3_condor_gpu.scitoken<br/>-rw-------. 1 gfactory gfactory  509 Aug 31 13:04 credential_OSG_US_ISI_osg.scitoken<br/>-rw-------. 1 gfactory gfactory  510 Aug 31 13:04 credential_CMS_T2_BR_SPRACE_condor_ce.scitoken<br/>-rw-------. 1 gfactory gfactory  507 Aug 31 13:04 credential_CMSHTPC_T2_US_UCSD_gw7.scitoken<br/>-rw-------. 1 gfactory gfactory  507 Aug 31 13:04 credential_CMSHTPC_T2_US_UCSD_gw6.scitoken<br/>-rw-------. 1 gfactory gfactory  514 Aug 31 13:04 credential_HCCHTPC_US_OU_OSCER_ATLAS.scitoken<br/>-rw-------. 1 gfactory gfactory  541 Aug 31 13:04 credential_OSG_US_SLATE_US_UIUC_HTC_hosted-ce02.scitoken<br/>-rw-------. 1 gfactory gfactory  510 Aug 31 13:04 credential_CMSHTPC_T2_BR_SPRACE.scitoken<br/>-rw-------. 1 gfactory gfactory  517 Aug 31 13:04 credential_CMSHTPC_T2_US_Wisconsin_cmsgrid02.scitoken<br/>-rw-------. 1 gfactory gfactory  517 Aug 31 13:04 credential_CMSHTPC_T2_US_Wisconsin_cmsgrid01.scitoken<br/>-rw-------. 1 gfactory gfactory  510 Aug 31 13:04 credential_FNAL_GPGrid_ce03_mcore_op.scitoken<br/>-rw-------. 1 gfactory gfactory  517 Aug 31 13:04 credential_CMSHTPC_T3_US_NotreDame_deepthought.scitoken<br/>-rw-------. 1 gfactory gfactory  531 Aug 31 13:04 credential_Gluex_US_NUMEP_grid1.scitoken<br/>-rw-------. 1 gfactory gfactory  517 Aug 31 13:04 credential_HCCHTPC_US_Wisconsin_osg01_rhel7.scitoken<br/>-rw-------. 1 gfactory gfactory  509 Aug 31 13:04 credential_OSG_US_Clemson-Palmetto_condce.scitoken<br/>-rw-------. 1 gfactory gfactory  498 Aug 31 13:04 credential_OSG_US_IIT_iitce2.scitoken<br/>-rw-------. 1 gfactory gfactory  498 Aug 31 13:04 credential_OSG_US_IIT_iitce1.scitoken</pre><br/>
<span style="color: #9e3997"><span style="font-size: small">(15:23:42)</span> <b>bbockelm:</b></span> <pre>export CE=<tt>cat credential_OSG_US_UConn_gluskap_op.scitoken | tr '.' ' ' | awk '{print $2}' | base64 --decode | python -c 'import json, sys; print json.load(sys.stdin)["aud"]'</tt>; _condor_SCITOKEN_FILE=credential_OSG_US_UConn_gluskap_op.scitoken _condor_SEC_CLIENT_AUTHENTICATION_METHODS=SCITOKENS _condor_TOOL_DEBUG=D_FULLDEBUG,D_SECURITY condor_ping -pool $CE -name <tt>echo $CE | tr ':' ' ' | awk '{print $1;}'</tt> -verbose -debug</pre><br/>
<span style="color: #9e3997"><span style="font-size: small">(15:27:35)</span> <b>bbockelm:</b></span> <pre>for CRED in <tt>ls -1 | grep -i scitoken | grep -v '\~'</tt>; do echo $CRED; export CE=<tt>cat $CRED | tr '.' ' ' | awk '{print $2}' | base64 --decode | python -c 'import json, sys; print json.load(sys.stdin)["aud"]'</tt>; _condor_SCITOKENS_FILE=$CRED _condor_SEC_CLIENT_AUTHENTICATION_METHODS=SCITOKENS _condor_TOOL_DEBUG=D_FULLDEBUG,D_SECURITY condor_ping -pool $CE -name <tt>echo $CE | tr ':' ' ' | awk '{print $1;}'</tt> -verbose; done</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(15:51:41)</span> <b>lincoln:</b></span> <pre>08/31/21 15:49:21 SECMAN: required authentication with &lt;129.93.175.54:9619&gt; failed, so aborting command UPDATE_SCHEDD_AD.<br/>08/31/21 15:49:21 ERROR: SECMAN:2004:Failed to create security session to &lt;129.93.175.54:9619&gt; with TCP.|AUTHENTICATE:1003:Failed to authenticate with any method|AUTHENTICATE:1004:Failed to authenticate using GSI|GSI:5003:Failed to authenticate.  Globus is reporting error (851968:32).  There is probably a problem with your credentials.  (Did you run grid-proxy-init?)|AUTHENTICATE:1004:Failed to authenticate using SSL<br/>08/31/21 15:49:21 Can't send command 1 to View Collector <a href="http://collector1.opensciencegrid.org:9619">collector1.opensciencegrid.org:9619</a><br/>08/31/21 15:49:21 creating new table for type Job_Router<br/>08/31/21 15:49:21 Job_Router: Inserting ** "&lt; htcondor-ce@osg-gk.mwt2.org &gt;"<br/>08/31/21 15:49:21 CollectorAd  : Inserting ** "&lt; My Pool - osg-gk.mwt2.org@osg-gk.mwt2.org &gt;"<br/>08/31/21 15:49:25 MasterAd     : Inserting ** "&lt; <a href="http://osg-gk.mwt2.org">osg-gk.mwt2.org</a> &gt;"<br/>08/31/21 15:50:02 Got QUERY_SCHEDD_ADS<br/>08/31/21 15:50:02 (Sending 1 ads in response to query)<br/>08/31/21 15:50:02 Query info: matched=1; skipped=0; query_time=0.003623; send_time=0.000088; type=Scheduler; requirements={((Name == "<a href="http://osg-gk.mwt2.org">osg-gk.mwt2.org</a>"))}; locate=1; limit=1; from=C_GAHP_WORKER_; peer=&lt;169.228.38.36:26005&gt;; projection={CondorVersion CondorPlatform MyAddress AddressV1 Name Machine ScheddIpAddr}; filter_private_ads=1<br/>08/31/21 15:50:08 Got QUERY_SCHEDD_ADS<br/>08/31/21 15:50:08 (Sending 1 ads in response to query)<br/>08/31/21 15:50:08 Query info: matched=1; skipped=0; query_time=0.000042; send_time=0.000055; type=Scheduler; requirements={((Name == "<a href="http://osg-gk.mwt2.org">osg-gk.mwt2.org</a>"))}; locate=1; limit=1; from=C_GAHP_WORKER_; peer=&lt;169.228.38.36:16364&gt;; projection={CondorVersion CondorPlatform MyAddress AddressV1 Name Machine ScheddIpAddr}; filter_private_ads=1<br/>08/31/21 15:50:17 Got QUERY_SCHEDD_ADS<br/>08/31/21 15:50:17 (Sending 1 ads in response to query)<br/>08/31/21 15:50:17 Query info: matched=1; skipped=0; query_time=0.000049; send_time=0.000062; type=Scheduler; requirements={((Name == "<a href="http://osg-gk.mwt2.org">osg-gk.mwt2.org</a>"))}; locate=1; limit=1; from=C_GAHP_WORKER_; peer=&lt;169.228.38.36:16900&gt;; projection={CondorVersion CondorPlatform MyAddress AddressV1 Name Machine ScheddIpAddr}; filter_private_ads=1<br/>08/31/21 15:50:18 Got QUERY_SCHEDD_ADS<br/>08/31/21 15:50:18 (Sending 1 ads in response to query)<br/>08/31/21 15:50:18 Query info: matched=1; skipped=0; query_time=0.000035; send_time=0.000069; type=Scheduler; requirements={((Name == "<a href="http://osg-gk.mwt2.org">osg-gk.mwt2.org</a>"))}; locate=1; limit=1; from=C_GAHP_WORKER_; peer=&lt;169.228.38.36:17061&gt;; projection={CondorVersion CondorPlatform MyAddress AddressV1 Name Machine ScheddIpAddr}; filter_private_ads=1<br/>08/31/21 15:50:19 Forwarding ad: type=Scheduler command=UPDATE_SCHEDD_AD<br/>08/31/21 15:50:19 Connecting to CONDOR_VIEW_HOST <a href="http://collector1.opensciencegrid.org:9619">collector1.opensciencegrid.org:9619</a><br/>08/31/21 15:50:19 authenticate_self_gss: acquiring self credentials failed. Please check your Condor configuration file if this is a server process. Or the user environment variable if this is a user process.<br/><br/>GSS Major Status: General failure<br/>GSS Minor Status Error Chain:<br/>globus_gsi_gssapi: Error with GSI credential<br/>globus_gsi_gssapi: Error with gss credential handle<br/>globus_credential: Valid credentials could not be found in any of the possible locations specified by the credential search order.<br/>Valid credentials could not be found in any of the possible locations specified by the credential search order.<br/>Attempt 1<br/>globus_credential: Error reading host credential<br/>globus_sysconfig: Error with certificate filename<br/>globus_sysconfig: Error with certificate filename<br/>globus_sysconfig: File does not exist: /etc/grid-security/hostcert.pem is not a valid file<br/>Attempt 2<br/>globus_credential: Error reading proxy credential<br/>globus_sysconfig: Could not find a valid proxy certificate file location<br/>globus_sysconfig: Error with key filename<br/>globus_sysconfig: File does not exist: /tmp/x509up_u0 is not a valid file<br/>Attempt 3<br/>globus_credential: Error reading user credential<br/>globus_sysconfig: Error with certificate filename<br/>globus_sysconfig: Error with certificate filename<br/>globus_sysconfig: File does not exist: /etc/grid-security/hostcert.pem is not a valid file<br/><br/>08/31/21 15:50:19 SECMAN: required authentication with &lt;129.93.175.54:9619&gt; failed, so aborting command UPDATE_SCHEDD_AD.<br/>08/31/21 15:50:19 ERROR: SECMAN:2004:Failed to create security session to &lt;129.93.175.54:9619&gt; with TCP.|AUTHENTICATE:1003:Failed to authenticate with any method|AUTHENTICATE:1004:Failed to authenticate using GSI|GSI:5003:Failed to authenticate.  Globus is reporting error (851968:65).  There is probably a problem with your credentials.  (Did you run grid-proxy-init?)|AUTHENTICATE:1004:Failed to authenticate using SSL<br/>08/31/21 15:50:19 Can't send command 1 to View Collector <a href="http://collector1.opensciencegrid.org:9619">collector1.opensciencegrid.org:9619</a><br/>08/31/21 15:50:19 (Sending 0 ads in response to query)<br/>08/31/21 15:50:19 Query info: matched=0; skipped=0; query_time=0.000025; send_time=0.000029; type=Negotiator; requirements={true}; locate=0; limit=0; from=COLLECTOR; peer=&lt;192.170.231.7:7508&gt;; projection={}; filter_private_ads=0<br/>08/31/21 15:50:19 SubmittorAd  : Inserting ** "&lt; osg@users.htcondor.orgosg-gk.mwt2.org , 192.170.231.7 &gt;"</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(16:07:27)</span> <b>lincoln:</b></span> <pre>08/31/21 16:06:50 Connecting to CONDOR_VIEW_HOST <a href="http://collector1.opensciencegrid.org:9619">collector1.opensciencegrid.org:9619</a><br/>08/31/21 16:06:50 SECMAN: required authentication with &lt;129.93.175.54:9619&gt; failed, so aborting command UPDATE_SCHEDD_AD.<br/>08/31/21 16:06:50 ERROR: SECMAN:2004:Failed to create security session to &lt;129.93.175.54:9619&gt; with TCP.|AUTHENTICATE:1003:Failed to authenticate with any method|AUTHENTICATE:1004:Failed to authenticate using SSL<br/>08/31/21 16:06:50 Can't send command 1 to View Collector <a href="http://collector1.opensciencegrid.org:9619">collector1.opensciencegrid.org:9619</a><br/>08/31/21 16:06:50 SubmittorAd  : Inserting ** "&lt; osg@users.htcondor.orgosg-gk.mwt2.org , 192.170.231.7 &gt;"<br/>08/31/21 16:06:51 CollectorAd  : Inserting ** "&lt; My Pool - osg-gk.mwt2.org@osg-gk.mwt2.org &gt;"<br/>08/31/21 16:06:55 MasterAd     : Inserting ** "&lt; <a href="http://osg-gk.mwt2.org">osg-gk.mwt2.org</a> &gt;"<br/>08/31/21 16:07:04 DC_AUTHENTICATE: attempt to open invalid session osg-gk:376599:1630443952:0, failing; this session was requested by &lt;169.228.38.36:27535&gt; with return address &lt;169.228.38.36:20110?addrs=169.228.38.36-20110&amp;alias=gfactory-itb-1.opensciencegrid.org&gt;<br/>08/31/21 16:07:09 Got QUERY_SCHEDD_ADS<br/>08/31/21 16:07:09 (Sending 1 ads in response to query)<br/>08/31/21 16:07:09 Query info: matched=1; skipped=0; query_time=0.000192; send_time=0.000069; type=Scheduler; requirements={((Name == "<a href="http://osg-gk.mwt2.org">osg-gk.mwt2.org</a>"))}; locate=1; limit=1; from=C_GAHP_WORKER_; peer=&lt;169.228.38.36:12737&gt;; projection={CondorVersion CondorPlatform MyAddress AddressV1 Name Machine ScheddIpAddr}; filter_private_ads=1</pre><br/>
<span style="color: #43761b"><span style="font-size: small">(16:17:26)</span> <b>jpatton:</b></span> @blin it looks like <tt>python3-scitokens-1.3.1-1.osg35.el8</tt> is available in <tt>osg-testing</tt>, whereas <tt>python3-scitokens.noarch-1.3.1-1.osg35.el7</tt> is in <tt>osg</tt>, could the EL8 package be promoted to <tt>osg</tt> proper?<br/>
<span style="color: #43761b"><span style="font-size: small">(16:17:57)</span> <b>jpatton:</b></span> (Or what needs to happen first)<br/>
<span style="color: #43761b"><span style="font-size: small">(16:18:12)</span> <b>blin:</b></span> we were hoping on shipping all the scitokens stuff together<br/>
<span style="color: #43761b"><span style="font-size: small">(16:18:48)</span> <b>blin:</b></span> <a href="https://opensciencegrid.atlassian.net/browse/SOFTWARE-4126">https://opensciencegrid.atlassian.net/browse/SOFTWARE-4126</a><br/>
<span style="color: #43761b"><span style="font-size: small">(16:19:39)</span> <b>blin:</b></span> i think the thing that's holding us back is not having <tt>scitokens-credmon</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(16:21:58)</span> <b>jpatton:</b></span> Ok, I’ll work with the <tt>python3-scitokens</tt> out of <tt>osg-testing</tt> to make sure <tt>condor-credmon-oauth</tt> works, which I’m not sure now how it differs from <tt>python-scitokens-credmon</tt> anymore…<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:37:55)</span> <b>rynge:</b></span> <pre>SCHEDD.SEC_WRITE_AUTHENTICATION_METHODS = FS,SCITOKENS,SSL<br/>SCHEDD.SEC_READ_AUTHENTICATION_METHODS = FS,SCITOKENS,SSL<br/>COLLECTOR.SEC_READ_AUTHENTICATION_METHODS = FS,SCITOKENS,SSL<br/>COLLECTOR.SEC_WRITE_AUTHENTICATION_METHODS = FS,SCITOKENS,SSL<br/>COLLECTOR.SEC_ADVERTISE_STARTD_AUTHENTICATION_METHODS = FS,SCITOKENS,SSL<br/>SEC_CLIENT_AUTHENTICATION_METHODS = FS,SCITOKENS,SSL<br/><br/><br/>COLLECTOR_DEBUG = D_FULLDEBUG,D_SECURITY:3<br/>SCHEDD_DEBUG = D_SECURITY:3 D_ALWAYS:2 D_CAT</pre><br/><br/>
<blockquote>
<span style="color: #43761b"><span style="font-size: small">(16:41:21)</span> <b>blin:</b></span> these are the tickets we need addressed:<br/>• <a href="https://opensciencegrid.atlassian.net/browse/HTCONDOR-344">https://opensciencegrid.atlassian.net/browse/HTCONDOR-344</a><br/>• <a href="https://opensciencegrid.atlassian.net/browse/HTCONDOR-236">https://opensciencegrid.atlassian.net/browse/HTCONDOR-236</a><br/>
</blockquote>
<span style="color: #674b1b"><span style="font-size: small">(17:04:16)</span> <b>rynge:</b></span> After trying BrianB's idea about generating tokens and pinging the sites, I end up with this impressive list for allow:<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:04:56)</span> <b>rynge:</b></span> <pre><a href="http://amnh-hel-ce1.svc.opensciencegrid.org">amnh-hel-ce1.svc.opensciencegrid.org</a><br/><a href="http://canary2.osg.chtc.io">canary2.osg.chtc.io</a><br/><a href="http://ce1.opensciencegrid.org">ce1.opensciencegrid.org</a><br/><a href="http://cms-grid0.hep.uprm.edu">cms-grid0.hep.uprm.edu</a><br/><a href="http://hosted-ce07.opensciencegrid.org">hosted-ce07.opensciencegrid.org</a><br/><a href="http://hosted-ce20.opensciencegrid.org">hosted-ce20.opensciencegrid.org</a><br/><a href="http://hosted-ce25.opensciencegrid.org">hosted-ce25.opensciencegrid.org</a><br/><a href="http://hosted-ce28.opensciencegrid.org">hosted-ce28.opensciencegrid.org</a><br/><a href="http://hosted-ce33.opensciencegrid.org">hosted-ce33.opensciencegrid.org</a><br/><a href="http://hosted-ce35.opensciencegrid.org">hosted-ce35.opensciencegrid.org</a><br/><a href="http://hosted-ce36.opensciencegrid.org">hosted-ce36.opensciencegrid.org</a><br/><a href="http://hosted-ce40.opensciencegrid.org">hosted-ce40.opensciencegrid.org</a><br/><a href="http://hosted-ce-chtc-ubuntu.osg.chtc.io">hosted-ce-chtc-ubuntu.osg.chtc.io</a><br/><a href="http://hosted-ce-chtc-ubuntu.osgdev.chtc.io">hosted-ce-chtc-ubuntu.osgdev.chtc.io</a><br/><a href="http://lamar-cluster-ce1.svc.opensciencegrid.org">lamar-cluster-ce1.svc.opensciencegrid.org</a><br/><a href="http://lhcb-ce.chtc.wisc.edu">lhcb-ce.chtc.wisc.edu</a><br/><a href="http://lsu-db-ce1.svc.opensciencegrid.org">lsu-db-ce1.svc.opensciencegrid.org</a><br/><a href="http://lsuhsc-tf-ce1.osgdev.chtc.io">lsuhsc-tf-ce1.osgdev.chtc.io</a><br/><a href="http://lsuhsc-tf-ce1.svc.opensciencegrid.org">lsuhsc-tf-ce1.svc.opensciencegrid.org</a><br/><a href="http://lsu-qb2-ce1.svc.opensciencegrid.org">lsu-qb2-ce1.svc.opensciencegrid.org</a><br/><a href="http://ndsu-thunder-ce1.svc.opensciencegrid.org">ndsu-thunder-ce1.svc.opensciencegrid.org</a><br/><a href="http://odu-ubuntu-ce1.svc.opensciencegrid.org">odu-ubuntu-ce1.svc.opensciencegrid.org</a><br/><a href="http://osgce3.farm.particle.cz">osgce3.farm.particle.cz</a><br/><a href="http://osg-ce.clemson.edu">osg-ce.clemson.edu</a><br/><a href="http://osg-ce.nmsu.edu">osg-ce.nmsu.edu</a><br/><a href="http://osg.isi.edu">osg.isi.edu</a><br/><a href="http://psc-bridges2-ce1.svc.opensciencegrid.org">psc-bridges2-ce1.svc.opensciencegrid.org</a><br/><a href="http://psc-bridges2-ce2.svc.opensciencegrid.org">psc-bridges2-ce2.svc.opensciencegrid.org</a><br/><a href="http://psu-ligo-ce1.svc.opensciencegrid.org">psu-ligo-ce1.svc.opensciencegrid.org</a><br/><a href="http://rhino-gw1.unl.edu">rhino-gw1.unl.edu</a><br/><a href="http://sdsc-expanse-ce1.svc.opensciencegrid.org">sdsc-expanse-ce1.svc.opensciencegrid.org</a><br/><a href="http://sdsc-ts-ce1.svc.opensciencegrid.org">sdsc-ts-ce1.svc.opensciencegrid.org</a><br/><a href="http://sut-ozstar-ce1.svc.opensciencegrid.org">sut-ozstar-ce1.svc.opensciencegrid.org</a><br/><a href="http://tacc-frontera-ce1.services.opensciencegrid.org">tacc-frontera-ce1.services.opensciencegrid.org</a><br/><a href="http://tacc-frontera-ce2.svc.opensciencegrid.org">tacc-frontera-ce2.svc.opensciencegrid.org</a><br/><a href="http://tacc-stampede2-ce1.svc.opensciencegrid.org">tacc-stampede2-ce1.svc.opensciencegrid.org</a><br/><a href="http://tacc-stampede2-ce2.svc.opensciencegrid.org">tacc-stampede2-ce2.svc.opensciencegrid.org</a><br/><a href="http://tcnj-elsa-ce1.svc.opensciencegrid.org">tcnj-elsa-ce1.svc.opensciencegrid.org</a><br/><a href="http://tufts-cluster-ce1.svc.opensciencegrid.org">tufts-cluster-ce1.svc.opensciencegrid.org</a><br/><a href="http://uiuc-icc-spt-ce1.svc.opensciencegrid.org">uiuc-icc-spt-ce1.svc.opensciencegrid.org</a><br/><a href="http://utc-epyc-ce1.svc.opensciencegrid.org">utc-epyc-ce1.svc.opensciencegrid.org</a><br/><a href="http://uwm-nemo-ce1.svc.opensciencegrid.org">uwm-nemo-ce1.svc.opensciencegrid.org</a><br/><a href="http://wtamu-hpc-ce1.svc.opensciencegrid.org">wtamu-hpc-ce1.svc.opensciencegrid.org</a></pre><br/><br/>
<span style="color: #9e3997"><span style="font-size: small">(17:06:22)</span> <b>bbockelm:</b></span> Awesome!<br/>
<span style="color: #9e3997"><span style="font-size: small">(17:11:00)</span> <b>bbockelm:</b></span> Lots of hosted CEs, that’s somewhat expected<br/>
<span style="color: #9e3997"><span style="font-size: small">(17:12:22)</span> <b>bbockelm:</b></span> We desperately need to start working on the other pools, I suspect.<br/>
<span style="color: #43761b"><span style="font-size: small">(17:13:09)</span> <b>blin:</b></span> for CMS, we probably need to bug them about whether or not they need to map to all the different unix accounts<br/>
<span style="color: #43761b"><span style="font-size: small">(17:13:28)</span> <b>blin:</b></span> or offer up another solution<br/>
</body>
</html>
