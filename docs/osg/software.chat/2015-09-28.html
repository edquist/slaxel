<!DOCTYPE html>
<html>
<head>
<title>Mon Sep 28, 2015 : #software (osg)</title>
</head>
<body>
<h3>Mon Sep 28, 2015 : #software (osg)</h3>
<span style="color: #385a86"><span style="font-size: small">(12:32:49)</span> <b>jdost321:</b></span> Hi @sthapa @matyas<br/>
<span style="color: #5b89d5"><span style="font-size: small">(12:35:33)</span> <b>sthapa:</b></span> hi<br/>
<span style="color: #385a86"><span style="font-size: small">(12:38:21)</span> <b>jdost321:</b></span> @sthapa: did your jobs run? or did you remve them?  I don't see them in the factory monitoring anymore<br/>
<span style="color: #5b89d5"><span style="font-size: small">(12:39:29)</span> <b>sthapa:</b></span> they ran, they were just short jobs that get sys info and then exit<br/>
<span style="color: #385a86"><span style="font-size: small">(12:40:05)</span> <b>jdost321:</b></span> I don't see any evidence that they actually ran successfully at the UW ITB site though<br/>
<span style="color: #385a86"><span style="font-size: small">(12:40:30)</span> <b>jdost321:</b></span> they must have run somewhere else because in the entry logs i just see:<br/>
<span style="color: #385a86"><span style="font-size: small">(12:40:30)</span> <b>jdost321:</b></span> 009 (99970.000.000) 09/28 16:38:20 Job was aborted by the user.<br/>        via condor_rm (by user gfactory)<br/>
<span style="color: #5b89d5"><span style="font-size: small">(12:57:05)</span> <b>sthapa:</b></span> oh, those jobs appear to have just run on these sites:<br/>
<span style="color: #5b89d5"><span style="font-size: small">(12:57:05)</span> <b>sthapa:</b></span> BNL_Test_2_CE_1<br/>UC_ITB_CONDOR<br/>UC_VTB<br/>
<span style="color: #5b89d5"><span style="font-size: small">(12:57:25)</span> <b>sthapa:</b></span> let me require the UW_MAD site on the submit file and see what happens<br/>
<span style="color: #5b89d5"><span style="font-size: small">(12:58:07)</span> <b>sthapa:</b></span> what is the requirement for the site name again, SITE_NAME == ?<br/>
<span style="color: #5b89d5"><span style="font-size: small">(12:58:23)</span> <b>sthapa:</b></span> is that the right option or is it OSG_SITE_NAME<br/>
<span style="color: #385a86"><span style="font-size: small">(12:58:31)</span> <b>jdost321:</b></span> This depends on your frontend matchmaking logic in the frontend.xml<br/>
<span style="color: #5b89d5"><span style="font-size: small">(12:59:04)</span> <b>sthapa:</b></span> &lt;match match_expr="True" start_expr="True"&gt;<br/>            &lt;factory query_expr="True"&gt;<br/>               &lt;match_attrs&gt;<br/>               &lt;/match_attrs&gt;<br/>               &lt;collectors&gt;<br/>               &lt;/collectors&gt;<br/>            &lt;/factory&gt;<br/>            &lt;job query_expr="True"&gt;<br/>               &lt;match_attrs&gt;<br/>               &lt;/match_attrs&gt;<br/>               &lt;schedds&gt;<br/>               &lt;/schedds&gt;<br/>            &lt;/job&gt;<br/>         &lt;/match&gt;<br/>
<span style="color: #385a86"><span style="font-size: small">(12:59:45)</span> <b>jdost321:</b></span> is that the way it looks for the top level? or everywhere?  do you have groups defined?<br/>
<span style="color: #5b89d5"><span style="font-size: small">(13:00:14)</span> <b>sthapa:</b></span> everywhere I think.  I just have one group defined<br/>
<span style="color: #385a86"><span style="font-size: small">(13:00:50)</span> <b>jdost321:</b></span> ther &lt;match ...&gt; should be at least in 1 places, one in the global section at the top, and then in your group<br/>
<span style="color: #5b89d5"><span style="font-size: small">(13:01:20)</span> <b>sthapa:</b></span> here’s the other:<br/>
<span style="color: #5b89d5"><span style="font-size: small">(13:01:20)</span> <b>sthapa:</b></span> &lt;match match_expr="True" start_expr="True"&gt;<br/>      &lt;factory query_expr='((stringListMember("OSG", GLIDEIN_Supported_VOs)))'&gt;<br/>         &lt;match_attrs&gt;<br/>         &lt;/match_attrs&gt;<br/>         &lt;collectors&gt;<br/>            &lt;collector DN="/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=glidein-int.grid.iu.edu" comment="Define factory collector globally for simplicity" factory_identity="<a href="mailto:gfactory@glidein-int.grid.iu.edu">gfactory@glidein-int.grid.iu.edu</a>" my_identity="<a href="mailto:feucitb@glidein-int.grid.iu.edu">feucitb@glidein-int.grid.iu.edu</a>" node="glidein-int.grid.iu.edu"/&gt;<br/>         &lt;/collectors&gt;<br/>      &lt;/factory&gt;<br/>      &lt;job comment="Define job constraint and schedds globally for simplicity" query_expr="(JobUniverse==5)&amp;amp;&amp;amp;(GLIDEIN_Is_Monitor =!= TRUE)&amp;amp;&amp;amp;(JOB_Is_Monitor =!= TRUE)"&gt;<br/>         &lt;match_attrs&gt;<br/>         &lt;/match_attrs&gt;<br/>         &lt;schedds&gt;<br/>            &lt;schedd DN="/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=itbv-glidein.mwt2.org" fullname="itbv-glidein.mwt2.org"/&gt;<br/>         &lt;/schedds&gt;<br/>      &lt;/job&gt;<br/>   &lt;/match&gt;<br/>
<span style="color: #385a86"><span style="font-size: small">(13:02:27)</span> <b>jdost321:</b></span> ok, so right now it looks like you have no logic to target specific sites<br/>
<span style="color: #5b89d5"><span style="font-size: small">(13:03:10)</span> <b>sthapa:</b></span> yup, jobs go to any site<br/>
<span style="color: #5b89d5"><span style="font-size: small">(13:03:31)</span> <b>sthapa:</b></span> I thought using submit file expressions would be more effective here<br/>
<span style="color: #385a86"><span style="font-size: small">(13:06:33)</span> <b>jdost321:</b></span> ok, so yes, you can specify in the requirements in your submit file, but this is not the best way for glideinwms<br/>
<span style="color: #385a86"><span style="font-size: small">(13:06:48)</span> <b>jdost321:</b></span> the problem is, since your match expressions are all true, the factory will blindly submit glidiens at all sites<br/>
<span style="color: #385a86"><span style="font-size: small">(13:07:16)</span> <b>jdost321:</b></span> but at least if you put in a requriements line, you will restrict what glideins the jobs will actually land on, which is probably good enough for our purposes right now<br/>
<span style="color: #385a86"><span style="font-size: small">(13:07:46)</span> <b>jdost321:</b></span> but in general if you don't want to spam every site, when you're targeting just 1, its better to define the logic in the frontend.xml, and then make a special attribute it can use in the submit file<br/>
<span style="color: #385a86"><span style="font-size: small">(13:08:18)</span> <b>jdost321:</b></span> like, +DESIRED_Site = "UWMAD"<br/>
<span style="color: #5b89d5"><span style="font-size: small">(13:09:11)</span> <b>sthapa:</b></span> okay, I’ll work on that after we get this resolved<br/>
<span style="color: #385a86"><span style="font-size: small">(13:09:22)</span> <b>jdost321:</b></span> for now though try just adding this to your submit file, requirements = GLIDEIN_Site =?= "UWMAD"<br/>
<span style="color: #385a86"><span style="font-size: small">(13:09:50)</span> <b>jdost321:</b></span> or something like that, sorry i forget the exact syntax for requirements, but it should be GLIDEIN_Site that you can match<br/>
<span style="color: #5b89d5"><span style="font-size: small">(13:13:15)</span> <b>sthapa:</b></span> okay, just submitted<br/>
<span style="color: #385a86"><span style="font-size: small">(13:19:16)</span> <b>jdost321:</b></span> ok, so we have some pending pilots at UW ITB again:<br/>
<span style="color: #385a86"><span style="font-size: small">(13:19:19)</span> <b>jdost321:</b></span> <a href="http://glidein-int.grid.iu.edu/factory/monitor/factoryStatusNow.html?view=UCITBOSG-itb_frontend">http://glidein-int.grid.iu.edu/factory/monitor/factoryStatusNow.html?view=UCITBOSG-itb_frontend</a><br/>
<span style="color: #385a86"><span style="font-size: small">(13:19:45)</span> <b>jdost321:</b></span> note you have plenty of pilots going everywhere, but hopefully your user jobs won't match them this time, so Mat has something to look at<br/>
<span style="color: #385a86"><span style="font-size: small">(13:20:05)</span> <b>jdost321:</b></span> @matyas: are you available to try tracking down these pilots?<br/>
<span style="color: #385a86"><span style="font-size: small">(13:20:59)</span> <b>jdost321:</b></span> here's a pending one:<br/>
<span style="color: #385a86"><span style="font-size: small">(13:21:00)</span> <b>jdost321:</b></span> 000 (99986.000.000) 09/28 18:14:21 Job submitted from host: &lt;129.79.53.46:26846&gt;<br/>...<br/>027 (99986.000.000) 09/28 18:14:35 Job submitted to grid resource<br/>    GridResource: condor <a href="http://itb-ce1.chtc.wisc.edu">itb-ce1.chtc.wisc.edu</a> <a href="http://itb-ce1.chtc.wisc.edu:9619">itb-ce1.chtc.wisc.edu:9619</a><br/>    GridJobId: condor <a href="http://itb-ce1.chtc.wisc.edu">itb-ce1.chtc.wisc.edu</a> <a href="http://itb-ce1.chtc.wisc.edu:9619">itb-ce1.chtc.wisc.edu:9619</a> 26522.0<br/>
<span style="color: #385a86"><span style="font-size: small">(13:21:36)</span> <b>jdost321:</b></span> and another:<br/>
<span style="color: #385a86"><span style="font-size: small">(13:21:36)</span> <b>jdost321:</b></span> 000 (99988.000.000) 09/28 18:14:24 Job submitted from host: &lt;129.79.53.46:26846&gt;<br/>...<br/>027 (99988.000.000) 09/28 18:14:35 Job submitted to grid resource<br/>    GridResource: condor <a href="http://itb-ce1.chtc.wisc.edu">itb-ce1.chtc.wisc.edu</a> <a href="http://itb-ce1.chtc.wisc.edu:9619">itb-ce1.chtc.wisc.edu:9619</a><br/>    GridJobId: condor <a href="http://itb-ce1.chtc.wisc.edu">itb-ce1.chtc.wisc.edu</a> <a href="http://itb-ce1.chtc.wisc.edu:9619">itb-ce1.chtc.wisc.edu:9619</a> 26523.0<br/>...<br/>
<span style="color: #c386df"><span style="font-size: small">(13:27:07)</span> <b>matyas:</b></span> hm, looks like our el6 exec node is down; let me reboot it<br/>
<span style="color: #385a86"><span style="font-size: small">(13:28:19)</span> <b>jdost321:</b></span> also I should have specified, 99986 is trying to run on the el7 node, and 99988 is trying el6<br/>
<span style="color: #c386df"><span style="font-size: small">(13:45:19)</span> <b>matyas:</b></span> I see glideins but no jobs<br/>
<span style="color: #385a86"><span style="font-size: small">(13:47:22)</span> <b>jdost321:</b></span> from the factory point of view, the glideins are just idle at your site<br/>
<span style="color: #385a86"><span style="font-size: small">(13:47:34)</span> <b>jdost321:</b></span> they can't accept jobs until they actually start running on the WNs<br/>
<span style="color: #385a86"><span style="font-size: small">(13:48:30)</span> <b>jdost321:</b></span> ah, spoke too soon, i see some running ones on the rhel6 node now.. so now perhaps there is an issue with the wn environment<br/>
<span style="color: #385a86"><span style="font-size: small">(13:48:43)</span> <b>jdost321:</b></span> we'll have to wait for a log of a pilot to see what went wrong<br/>
<span style="color: #385a86"><span style="font-size: small">(14:02:46)</span> <b>jdost321:</b></span> Suchandra, did we mean to have glexec enabled for UW?<br/>
<span style="color: #385a86"><span style="font-size: small">(14:02:51)</span> <b>jdost321:</b></span> this is the error i'm seeing<br/>
<span style="color: #385a86"><span style="font-size: small">(14:02:52)</span> <b>jdost321:</b></span> Validation failed in main/glexec_setup.sh.<br/><br/>    gLExec binary 'None' not found!<br/>
<span style="color: #385a86"><span style="font-size: small">(14:15:19)</span> <b>jdost321:</b></span> so we have a few options, we can either disable glexec usage here from the factory side<br/>
<span style="color: #385a86"><span style="font-size: small">(14:15:32)</span> <b>jdost321:</b></span> or from the site side, debug hwy this is set to None: OSG_GLEXEC_LOCATION=None<br/>
<span style="color: #385a86"><span style="font-size: small">(14:16:11)</span> <b>jdost321:</b></span> not sure if these lines are still relevant, but the glideins source the following files if found:<br/>
<span style="color: #385a86"><span style="font-size: small">(14:16:13)</span> <b>jdost321:</b></span> . "$OSG_GRID/setup.sh"<br/>. "$GLOBUS_LOCATION/etc/globus-user-env.sh"<br/>
<span style="color: #c386df"><span style="font-size: small">(14:19:43)</span> <b>matyas:</b></span> we aren't running glexec<br/>
<span style="color: #c386df"><span style="font-size: small">(14:19:59)</span> <b>matyas:</b></span> er, we don't have it installed<br/>
<span style="color: #c386df"><span style="font-size: small">(14:20:33)</span> <b>matyas:</b></span> is disabling glexec usage global?<br/>
<span style="color: #385a86"><span style="font-size: small">(14:20:58)</span> <b>jdost321:</b></span> no, from the factory side we can choose site by site<br/>
<span style="color: #c386df"><span style="font-size: small">(14:21:15)</span> <b>matyas:</b></span> ok, then let's disable it for madison<br/>
<span style="color: #385a86"><span style="font-size: small">(14:24:44)</span> <b>jdost321:</b></span> ok, done. we'll have to wait for new glideins to take place of the current running ones<br/>
<span style="color: #5b89d5"><span style="font-size: small">(14:28:20)</span> <b>sthapa:</b></span> ok<br/>
<span style="color: #385a86"><span style="font-size: small">(14:34:57)</span> <b>jdost321:</b></span> I see one glidein that got through since the change, but now we have a new error<br/>
<span style="color: #385a86"><span style="font-size: small">(14:34:59)</span> <b>jdost321:</b></span> 09/28/15 14:26:24 (pid:31823) Condor GSI authentication failure<br/>GSS Major Status: Authentication Failed<br/>GSS Minor Status Error Chain:<br/>globus_gss_assist: Error during context initialization<br/>globus_gsi_gssapi: Unable to verify remote side's credentials<br/>globus_gsi_gssapi: Unable to verify remote side's credentials: Couldn't verify the remote certificate<br/>OpenSSL Error: s3_pkt.c:1257: in library: SSL routines, function SSL3_READ_BYTES: sslv3 alert bad certificate SSL alert number 42<br/><br/>09/28/15 14:26:24 (pid:31823) SECMAN: required authentication with collector <a href="http://itbv-glidein.mwt2.org:9618">itbv-glidein.mwt2.org:9618</a> failed, so aborting command CCB_REGISTER.<br/>09/28/15 14:26:24 (pid:31823) ERROR: AUTHENTICATE:1003:Failed to authenticate with any method|AUTHENTICATE:1004:Failed to authenticate using GSI|GSI:5004:Failed<br/>
<span style="color: #385a86"><span style="font-size: small">(14:35:23)</span> <b>jdost321:</b></span> looks like the glidein can't us gsi to connect back to Suchandra's collector at mwt2<br/>
<span style="color: #385a86"><span style="font-size: small">(14:36:04)</span> <b>jdost321:</b></span> @matyas: do you have the OSG CA certs and fetch crl installed and working?<br/>
<span style="color: #385a86"><span style="font-size: small">(14:36:15)</span> <b>jdost321:</b></span> (on the WNs)<br/>
<span style="color: #385a86"><span style="font-size: small">(14:37:19)</span> <b>jdost321:</b></span> hmm that or its clock skew somewhere<br/>
<span style="color: #385a86"><span style="font-size: small">(14:37:26)</span> <b>jdost321:</b></span> more info:<br/>
<span style="color: #385a86"><span style="font-size: small">(14:37:28)</span> <b>jdost321:</b></span> 09/28/15 14:26:24 (pid:31823) Condor GSI authentication failure<br/>GSS Major Status: Authentication Failed<br/>GSS Minor Status Error Chain:<br/>globus_gss_assist: Error during context initialization<br/>OpenSSL Error: s3_clnt.c:1172: in library: SSL routines, function SSL3_GET_SERVER_CERTIFICATE: certificate verify failed<br/>globus_gsi_callback_module: Could not verify credential<br/>globus_gsi_callback_module: The certificate is not yet valid: Cert with subject: /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Suchandra Thapa/CN=proxy/CN=limited proxy/CN=limited proxy is not yet valid- check clock skew between hosts.<br/><br/>09/28/15 14:26:24 (pid:31823) SECMAN: required authentication with daemon at &lt;128.105.244.253:40622&gt; failed, so aborting command DC_CHILDALIVE.<br/>09/28/15 14:26:24 (pid:31823) ChildAliveMsg: failed to send DC_CHILDALIVE to parent daemon at &lt;128.105.244.253:40622&gt; (try 1 of 3): AUTHENTICATE:1003:Failed to authenticate with any method|AUTHENTICATE:1004:Failed to authenticate using GSI|GSI:5004:Failed to authenticate.  Globus is reporting error (655360:19)<br/>09/28/15 14:26:24 (pid:31823) Condor GSI authentication failure<br/>GSS Major Status: Authentication Failed<br/>
<span style="color: #c386df"><span style="font-size: small">(14:43:56)</span> <b>matyas:</b></span> yeah, the clock was off on the ce<br/>
<span style="color: #5b89d5"><span style="font-size: small">(15:05:25)</span> <b>sthapa:</b></span> my jobs are still idle<br/>
<span style="color: #385a86"><span style="font-size: small">(15:06:29)</span> <b>jdost321:</b></span> right, the UC fe's pilots are just pending at the site now.  However, i see the glow FE has some running glideins that were longer than 20 minutes now<br/>
<span style="color: #385a86"><span style="font-size: small">(15:06:46)</span> <b>jdost321:</b></span> Mat how many slots do you have?<br/>
<span style="color: #385a86"><span style="font-size: small">(15:07:01)</span> <b>jdost321:</b></span> i think glow might actually be running user jobs there?<br/>
<span style="color: #c386df"><span style="font-size: small">(15:12:23)</span> <b>matyas:</b></span> 64 slots, (32 on each host)<br/>
<span style="color: #385a86"><span style="font-size: small">(15:13:12)</span> <b>jdost321:</b></span> ok, any idea why the UC frontend isn't starting now?  maybe fixing the clock did something weird.. i can try removing this pilot to let the factory resubmit<br/>
<span style="color: #385a86"><span style="font-size: small">(15:14:24)</span> <b>jdost321:</b></span> more specifically do you see any pilots anymore in your queue with this dn?<br/>
<span style="color: #385a86"><span style="font-size: small">(15:14:40)</span> <b>jdost321:</b></span> "/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Suchandra Thapa,/osg/Role=NULL/Capability=NULL"<br/>
<span style="color: #385a86"><span style="font-size: small">(15:18:25)</span> <b>jdost321:</b></span> i just cleared the queue, the glow pilots didn't seem to be actually running jobs yet either<br/>
<span style="color: #385a86"><span style="font-size: small">(15:27:02)</span> <b>jdost321:</b></span> suchandra, you're finally getting a pilot talking to your user collector, but it isn't matching your jobs<br/>
<span style="color: #385a86"><span style="font-size: small">(15:27:12)</span> <b>jdost321:</b></span> can you condor_q -analyze on your submit host?<br/>
<span style="color: #c386df"><span style="font-size: small">(15:34:18)</span> <b>matyas:</b></span> i need to go in ten minutes; can we pick this up tomorrow?<br/>
<span style="color: #385a86"><span style="font-size: small">(15:40:53)</span> <b>jdost321:</b></span> sure, at this point though i think the site is working, i'll work wout with @sthapa  why his jobs aren't matching<br/>
<span style="color: #c386df"><span style="font-size: small">(15:41:16)</span> <b>matyas:</b></span> it doesn't look like our el7 node is running pilots at the moment<br/>
<span style="color: #385a86"><span style="font-size: small">(15:41:21)</span> <b>jdost321:</b></span> glow fe glideins don't seem to be working at all though, but thats probaby a separate issue<br/>
<span style="color: #385a86"><span style="font-size: small">(15:42:20)</span> <b>jdost321:</b></span> right, the el7 pilots are stuck pending on our end on the factory<br/>
<span style="color: #385a86"><span style="font-size: small">(15:42:38)</span> <b>jdost321:</b></span> we can look into that tomorrow<br/>
<span style="color: #c386df"><span style="font-size: small">(15:42:50)</span> <b>matyas:</b></span> ok<br/>
<span style="color: #385a86"><span style="font-size: small">(15:47:46)</span> <b>jdost321:</b></span> also fyi i found the glow problem<br/>
<span style="color: #385a86"><span style="font-size: small">(15:47:50)</span> <b>jdost321:</b></span> Validation failed in main/condor_platform_select.sh.<br/><br/>    Cannot find a supported platform<br/>    CONDOR_VERSION '8.3.2'<br/>    CONDOR_OS      'default'<br/>    CONDOR_ARCH    'default'<br/>    Quitting<br/>
<span style="color: #385a86"><span style="font-size: small">(15:48:06)</span> <b>jdost321:</b></span> that fe is asking for a condor version we don't supply in suchandra's factory, 8.3<br/>
<span style="color: #5b89d5"><span style="font-size: small">(16:20:30)</span> <b>sthapa:</b></span> can you install that version?<br/>
<span style="color: #5b89d5"><span style="font-size: small">(16:22:03)</span> <b>sthapa:</b></span> nm, I saw your email to Nate<br/>
</body>
</html>
