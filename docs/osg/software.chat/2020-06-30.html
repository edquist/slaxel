<!DOCTYPE html>
<html>
<head>
<title>Tue Jun 30, 2020 : #software (osg)</title>
</head>
<body>
<h3>Tue Jun 30, 2020 : #software (osg)</h3>
<span style="color: #a63024"><span style="font-size: small">(16:24:11)</span> <b>efajardo:</b></span> <b>@here</b> folks I ran into a problem<br/>
<span style="color: #a63024"><span style="font-size: small">(16:24:18)</span> <b>efajardo:</b></span> with the build of xrootd-lcmaps<br/>
<span style="color: #a63024"><span style="font-size: small">(16:24:21)</span> <b>efajardo:</b></span> the build succeeds<br/>
<span style="color: #a63024"><span style="font-size: small">(16:24:40)</span> <b>efajardo:</b></span> <pre>Install the project...<br/>/usr/bin/cmake -P cmake_install.cmake<br/>-- Install configuration: "RelWithDebInfo"<br/>-- Installing: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/etc/xrootd/lcmaps.cfg<br/>-- Installing: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/etc/xrootd/config.d/10-xrootd-lcmaps.cfg<br/>-- Installing: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/etc/xrootd/config.d/40-xrootd-lcmaps.cfg<br/>-- Installing: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-4.so<br/>+ /usr/lib/rpm/find-debuginfo.sh -j8 --strict-build-id -m -i --build-id-seed 1.7.8-1.osg35.el8 --unique-debug-suffix -1.7.8-1.osg35.el8.x86_64 --unique-debug-src-base xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64 --run-dwz --dwz-low-mem-die-limit 10000000 --dwz-max-die-limit 110000000 -S debugsourcefiles.list /builddir/build/BUILD/xrootd-lcmaps-1.7.8<br/>extracting debug info from /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-4.so<br/>/usr/lib/rpm/sepdebugcrcfix: Updated 1 CRC32s, 0 CRC32s did match.<br/>102 blocks<br/>+ /usr/lib/rpm/check-buildroot<br/>+ /usr/lib/rpm/redhat/brp-ldconfig<br/>/sbin/ldconfig: Warning: ignoring configuration file that cannot be opened: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/etc/ld.so.conf: No such file or directory<br/>+ /usr/lib/rpm/brp-compress<br/>+ /usr/lib/rpm/brp-strip-static-archive /usr/bin/strip<br/>+ /usr/lib/rpm/brp-python-bytecompile 1<br/>+ /usr/lib/rpm/brp-python-hardlink<br/>+ PYTHON3=/usr/libexec/platform-python<br/>+ /usr/lib/rpm/redhat/brp-mangle-shebangs<br/>Processing files: xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64<br/>RPM build errors:<br/>error: File not found: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-*.so.0<br/>error: File not found: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-*.so.0.0.2<br/>    File not found: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-*.so.0<br/>    File not found: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-*.so.0.0.2</pre><br/><br/>
<span style="color: #a63024"><span style="font-size: small">(16:24:52)</span> <b>efajardo:</b></span> but only builds <tt>Installing: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-4.so</tt><br/>
<span style="color: #a63024"><span style="font-size: small">(16:25:01)</span> <b>efajardo:</b></span> not <tt>: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-*.so.0.0.2</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(16:25:07)</span> <b>blin:</b></span> @didavila has been actively working on xrootd packaging updates ^^<br/>
<span style="color: #a63024"><span style="font-size: small">(16:25:09)</span> <b>efajardo:</b></span> and <tt>/builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/usr/lib64/libXrdLcmaps-*.so.0</tt><br/>
<span style="color: #a63024"><span style="font-size: small">(16:25:20)</span> <b>efajardo:</b></span> but the same rpm builds fine for el7<br/>
<span style="color: #a63024"><span style="font-size: small">(16:25:36)</span> <b>efajardo:</b></span> is just on el8 the .so.0 and .so.0.0.2<br/>
<span style="color: #a63024"><span style="font-size: small">(16:25:38)</span> <b>efajardo:</b></span> are not produced<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(16:38:29)</span> <b>didavila:</b></span> do you have an el8 host to test on? or just doing it with koji?<br/>
<span style="color: #a63024"><span style="font-size: small">(16:46:40)</span> <b>efajardo:</b></span> I build it inside an el8 container<br/>
<span style="color: #a63024"><span style="font-size: small">(16:46:48)</span> <b>efajardo:</b></span> and it built fine just did not produce those files<br/>
<span style="color: #a63024"><span style="font-size: small">(16:46:52)</span> <b>efajardo:</b></span> I think they are not needed<br/>
<span style="color: #a63024"><span style="font-size: small">(16:47:36)</span> <b>efajardo:</b></span> I included a fix<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(16:55:35)</span> <b>didavila:</b></span> One thing i notice is that we set the properties for that target in 2 different places, maybe cmake doesn’t like that in el8<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(16:56:08)</span> <b>didavila:</b></span> could you try this:<br/><pre>diff --git a/CMakeLists.txt b/CMakeLists.txt<br/>index 171059a..844e3b6 100644<br/>--- a/CMakeLists.txt<br/>+++ b/CMakeLists.txt<br/>@@ -33,7 +33,7 @@ include_directories( "${PROJECT_SOURCE_DIR}" "${XROOTD_INCLUDES}" "${LCMAPS_INCL<br/> <br/> add_library(XrdLcmaps MODULE src/XrdLcmaps.cc src/XrdHttpLcmaps.cc src/XrdLcmapsConfig.cc src/XrdLcmapsKey.cc src/GlobusSupport.cc src/GlobusError.cc)<br/> target_link_libraries(XrdLcmaps ${LCMAPS_LIB} ${DL_LIB} ${VOMS_LIB})<br/>-set_target_properties(XrdLcmaps PROPERTIES OUTPUT_NAME "XrdLcmaps-${XROOTD_PLUGIN_VERSION}" LINK_FLAGS "-Wl,--version-script=${PROJECT_SOURCE_DIR}/configs/export-symbols")<br/>+set_target_properties(XrdLcmaps PROPERTIES VERSION "0.0.2" SOVERSION "0" LINK_INTERFACE_LIBRARIES "" OUTPUT_NAME "XrdLcmaps-${XROOTD_PLUGIN_VERSION}" LINK_FLAGS "-Wl,--version-script=${PROJECT_SOURCE_DIR}/configs/expo<br/> <br/> if (NOT DEFINED LIB_INSTALL_DIR)<br/>   SET(LIB_INSTALL_DIR "lib")<br/>@@ -58,10 +58,3 @@ install(<br/>   TARGETS XrdLcmaps<br/>   LIBRARY DESTINATION ${LIB_INSTALL_DIR} )<br/> <br/>-set_target_properties(<br/>-  XrdLcmaps<br/>-  PROPERTIES<br/>-  VERSION   "0.0.2"<br/>-  SOVERSION "0"<br/>-  LINK_INTERFACE_LIBRARIES "" )<br/>-</pre><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(17:03:47)</span> <b>didavila:</b></span> also I’m curious about the warning in your logs:<br/><pre>/sbin/ldconfig: Warning: ignoring configuration file that cannot be opened: /builddir/build/BUILDROOT/xrootd-lcmaps-1.7.8-1.osg35.el8.x86_64/etc/ld.so.conf: No such file or directory</pre><br/>
</body>
</html>
