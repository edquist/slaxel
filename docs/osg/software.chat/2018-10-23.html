<!DOCTYPE html>
<html>
<head>
<title>Tue Oct 23, 2018 : #software (osg)</title>
</head>
<body>
<h3>Tue Oct 23, 2018 : #software (osg)</h3>
<span style="color: #235e5b"><span style="font-size: small">(11:28:50)</span> <b>dweitzel:</b></span> I need some software (SVN?) help.  Originally scitokens (python-scitokens) and xrootd-scitokens were in the contrib repo.  Now, we want to release them in the official "release" repo.  What changes need to happen to make sure that works?  <tt>svn mv</tt>?  Anything else?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:31:30)</span> <b>blin:</b></span> there are new versions and builds for both of them, right?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:33:14)</span> <b>dweitzel:</b></span> yes<br/>
<span style="color: #43761b"><span style="font-size: small">(11:33:21)</span> <b>blin:</b></span> yeah, i think i see them both in development, so they need to go through the normal dev testing to get into osg-testing, then release testing to get into the release<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:33:45)</span> <b>dweitzel:</b></span> right, but any SVN moves needed?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:34:00)</span> <b>blin:</b></span> i believe to "promote" a package from contrib is similar to upcoming, meaning we just untag the contrib builds<br/>
<span style="color: #43761b"><span style="font-size: small">(11:34:02)</span> <b>blin:</b></span> nope, that should be it<br/>
<span style="color: #43761b"><span style="font-size: small">(11:34:30)</span> <b>blin:</b></span> @tim.theisen would know more about untagging from contrib<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:34:34)</span> <b>dweitzel:</b></span> ok, so the package stuff can continue to live in 3.4-contrib branch?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:34:40)</span> <b>dweitzel:</b></span> not in <tt>trunk</tt>?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:36:06)</span> <b>blin:</b></span> oh, i thought you already did that<br/>
<span style="color: #43761b"><span style="font-size: small">(11:36:12)</span> <b>blin:</b></span> let's <tt>svn mv</tt> them to trunk<br/>
<span style="color: #73769d"><span style="font-size: small">(11:36:29)</span> <b>tim.theisen:</b></span> We can untag from contrib on release day<br/>
<span style="color: #73769d"><span style="font-size: small">(11:36:46)</span> <b>tim.theisen:</b></span> Just put a note in the JIRA ticket<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:37:31)</span> <b>dweitzel:</b></span> I don't have the repo checked out.  (especially at the trunk / branch level).  Brian, could you do the <tt>mv</tt> for me?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:37:32)</span> <b>blin:</b></span> @tim.theisen is there documentation for moving packages from contrib to the mainline release?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:38:00)</span> <b>blin:</b></span> i always have to reconstruct the process in my head -- probably poorly<br/>
<span style="color: #73769d"><span style="font-size: small">(11:38:07)</span> <b>tim.theisen:</b></span> Nope. Never done that before. I don't think that anybody thought about that.<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:38:24)</span> <b>dweitzel:</b></span> :slightly_smiling_face: sorry for breaking the mold<br/>
<span style="color: #c386df"><span style="font-size: small">(11:40:38)</span> <b>matyas:</b></span> really? nobody's moved anything from contrib?<br/>
<span style="color: #c386df"><span style="font-size: small">(11:41:25)</span> <b>matyas:</b></span> the procedure shouldn't be fundamentally different than moving something from upcoming<br/>
<span style="color: #43761b"><span style="font-size: small">(11:43:50)</span> <b>blin:</b></span> @dweitzel svn mv'ed<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:44:05)</span> <b>dweitzel:</b></span> thanks<br/>
<span style="color: #43761b"><span style="font-size: small">(13:23:03)</span> <b>blin:</b></span> hey @jthiltges do you have time over the next day or so to take the new xrootd 4.8.5 build for a spin?<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:23:24)</span> <b>jthiltges:</b></span> @blin Sure.<br/>
<span style="color: #43761b"><span style="font-size: small">(13:23:58)</span> <b>blin:</b></span> not sure why exactly but we couldn't assign the ticket to you (<a href="https://opensciencegrid.atlassian.net/browse/SOFTWARE-3435">https://opensciencegrid.atlassian.net/browse/SOFTWARE-3435</a>)<br/>
<span style="color: #43761b"><span style="font-size: small">(13:24:02)</span> <b>blin:</b></span> do you get the emails when we @ you?<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:26:39)</span> <b>jthiltges:</b></span> Yup! I see the emails.<br/>
<span style="color: #e06b56"><span style="font-size: small">(13:27:32)</span> <b>jthiltges:</b></span> Does JIRA have a notion of roles for accounts?<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:27:04)</span> <b>rynge:</b></span> I'm looking at the new flocking package (<a href="https://opensciencegrid.atlassian.net/browse/SOFTWARE-3401">https://opensciencegrid.atlassian.net/browse/SOFTWARE-3401</a>) and I'm confused about the gratia probe config<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:27:10)</span> <b>rynge:</b></span> After installing I see:<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:27:19)</span> <b>rynge:</b></span> <pre><br/># ls /etc/gratia/condor/<br/>ProbeConfig  ProbeConfig-flocking<br/></pre><br/>
<span style="color: #674b1b"><span style="font-size: small">(14:27:28)</span> <b>rynge:</b></span> Is having two configs like that valid?<br/>
<span style="color: #16569E"><span style="font-size: small">(14:33:48)</span> <b>edquist:</b></span> Hi Mats,<br/>
<span style="color: #16569E"><span style="font-size: small">(14:34:49)</span> <b>edquist:</b></span> i didn't do the packaging work for <tt>osg-flock</tt>, but from what i can tell, the <tt>ProbeConfig-flocking</tt> filename is just given to avoid conflicting with the ProbeConfig owned by <tt>gratia-probe-condor</tt><br/>
<span style="color: #16569E"><span style="font-size: small">(14:35:07)</span> <b>edquist:</b></span> my guess is you have to copy it over ProbeConfig to get it to work<br/>
<span style="color: #16569E"><span style="font-size: small">(14:35:19)</span> <b>edquist:</b></span> i don't think you can use both configs at once, as far as i remember<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:35:20)</span> <b>rynge:</b></span> Hmm, ok<br/>
<span style="color: #16569E"><span style="font-size: small">(14:36:10)</span> <b>edquist:</b></span> you can diff yourself of course, but as far as i can see the differences with the <tt>-flocking</tt> one are, <tt>SuppressGridLocalRecords</tt> is set to <tt>1</tt>, and the parameters are added:<br/><pre><br/>    MapUnknownToGroup="1"<br/>    MapGroupToRole="1"<br/>    VOOverride="osg"<br/></pre><br/>
<span style="color: #674b1b"><span style="font-size: small">(14:36:40)</span> <b>rynge:</b></span> Yeah, those are some magic settings we have give to users<br/>
<span style="color: #16569E"><span style="font-size: small">(14:36:49)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:37:05)</span> <b>rynge:</b></span> Ok, well, having that as a template is better than nothing<br/>
<span style="color: #43761b"><span style="font-size: small">(15:31:48)</span> <b>blin:</b></span> @dweitzel is there a JIRA ticket for the new version of scitokens?<br/>
<span style="color: #c386df"><span style="font-size: small">(15:35:28)</span> <b>matyas:</b></span> @rynge is it still useful as a first step, or would you rather wait until we've made some improvements?<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:37:12)</span> <b>dweitzel:</b></span> @blin <a href="https://opensciencegrid.atlassian.net/browse/SOFTWARE-3451">https://opensciencegrid.atlassian.net/browse/SOFTWARE-3451</a><br/>
<span style="color: #c386df"><span style="font-size: small">(15:40:58)</span> <b>matyas:</b></span> you're our primary requester for that package so if it's not useful enough for you, there's no problem with us not releasing it this week<br/>
<span style="color: #43761b"><span style="font-size: small">(15:44:38)</span> <b>blin:</b></span> i'm not sure what the appropriate behavior would be for this case. having the metapackage overwrite the default config?<br/>
<span style="color: #235e5b"><span style="font-size: small">(15:46:01)</span> <b>dweitzel:</b></span> could you drop a new file in <tt>/etc/cron.d</tt> what is the same as the gratia-probe-condor cron file, but points to the new ProbeConfig-flocking file?<br/>
<span style="color: #43761b"><span style="font-size: small">(16:03:00)</span> <b>blin:</b></span> yeah, i guess that could work<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:03:25)</span> <b>dweitzel:</b></span> @blin shoot, I think I need to do another release of scitokens.  Forgot the version requirements for pyjwt in the <tt>Requires</tt> line in the spec.<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:03:35)</span> <b>dweitzel:</b></span> I'll just bump the release number in the spec?<br/>
<span style="color: #43761b"><span style="font-size: small">(16:03:40)</span> <b>blin:</b></span> yeah<br/>
<span style="color: #43761b"><span style="font-size: small">(16:03:49)</span> <b>blin:</b></span> could you comment in the ticket to hold off on promotion?<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:04:12)</span> <b>rynge:</b></span> @matyas Please release it<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:04:24)</span> <b>rynge:</b></span> It is a great improvement on how we do things currently<br/>
<span style="color: #c386df"><span style="font-size: small">(16:04:30)</span> <b>matyas:</b></span> OK<br/>
<span style="color: #c386df"><span style="font-size: small">(16:04:34)</span> <b>matyas:</b></span> @tim.theisen ^^<br/>
<span style="color: #73769d"><span style="font-size: small">(16:05:16)</span> <b>tim.theisen:</b></span> Cool. Hopefully goes out this Thursday.<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:06:02)</span> <b>dweitzel:</b></span> @blin I'm a bit confused by what I am seeing in SVN.  the version of scitokens in the spec seems... old.<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:06:22)</span> <b>dweitzel:</b></span> like, it was <tt>mv</tt>'d from somewhere old?<br/>
<span style="color: #43761b"><span style="font-size: small">(16:06:41)</span> <b>blin:</b></span> hrm, i copied over python-scitokens from branches/osg-3.4-contrib<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:06:58)</span> <b>dweitzel:</b></span> yeah, I saw that it was "deleted" from that branch.<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:07:18)</span> <b>dweitzel:</b></span> but the stuff in python-scitokens points to 1.0.2, but the build and release we are talking about is 1.2.1<br/>
<span style="color: #43761b"><span style="font-size: small">(16:09:07)</span> <b>blin:</b></span> there was also a <tt>scitokens</tt> dir<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:09:41)</span> <b>dweitzel:</b></span> ah, maybe that's it?<br/>
<span style="color: #43761b"><span style="font-size: small">(16:10:52)</span> <b>blin:</b></span> oh, yeah<br/>
<span style="color: #43761b"><span style="font-size: small">(16:11:17)</span> <b>blin:</b></span> i must've misread it when comparing the two dirs<br/>
<span style="color: #43761b"><span style="font-size: small">(16:12:10)</span> <b>blin:</b></span> ugh, they're both full of history<br/>
<span style="color: #43761b"><span style="font-size: small">(16:23:35)</span> <b>blin:</b></span> @dweitzel update your svn and check it again<br/>
<span style="color: #43761b"><span style="font-size: small">(16:24:22)</span> <b>blin:</b></span> i merged the other folder in and the only changes were in the <tt>github.source</tt>, version, and changelog<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:25:30)</span> <b>dweitzel:</b></span> great.  I'm doing a quick scratch build.<br/>
<span style="color: #43761b"><span style="font-size: small">(16:26:08)</span> <b>blin:</b></span> @matyas do you think we can delete the old scitokens dir in contrib?<br/>
<span style="color: #43761b"><span style="font-size: small">(16:27:14)</span> <b>blin:</b></span> @dweitzel one annoying thing about your python-jwt package is that there is no <tt>python-jwt</tt> binary, just <tt>python2-jwt</tt>, and the old version of <tt>python-jwt</tt> is the other way around<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:27:56)</span> <b>dweitzel:</b></span> interesting, I didn't notice<br/>
<span style="color: #c386df"><span style="font-size: small">(16:29:47)</span> <b>matyas:</b></span> fedora guidelines for python are no longer the same as they used to be...<br/>
<span style="color: #c386df"><span style="font-size: small">(16:30:38)</span> <b>matyas:</b></span> source packages for python _libraries_ (not applications) must be called <tt>python-*</tt><br/>
<span style="color: #c386df"><span style="font-size: small">(16:31:17)</span> <b>matyas:</b></span> but the binary packages must be called <tt>python2-*</tt> or <tt>python3-*</tt> as appropriate<br/>
<span style="color: #c386df"><span style="font-size: small">(16:31:39)</span> <b>matyas:</b></span> <a href="https://fedoraproject.org/wiki/Packaging:Python">https://fedoraproject.org/wiki/Packaging:Python</a><br/>
<span style="color: #43761b"><span style="font-size: small">(16:33:48)</span> <b>blin:</b></span> ah ok<br/>
</body>
</html>
