<!DOCTYPE html>
<html>
<head>
<title>Fri Sep 18, 2020 : #software (osg)</title>
</head>
<body>
<h3>Fri Sep 18, 2020 : #software (osg)</h3>
<span style="color: #235e5b"><span style="font-size: small">(08:09:23)</span> <b>dbox:</b></span> I found a problem with IDTOKENS auth back from the glidein to the VOCollecter, it was failing and reverting back to GSI.   Testing the fixes now....<br/>
<span style="color: #43761b"><span style="font-size: small">(09:20:23)</span> <b>blin:</b></span> hey @dbox, how'd that last glidein go?<br/>
<span style="color: #235e5b"><span style="font-size: small">(09:21:19)</span> <b>dbox:</b></span> IDTOKENS auth failed again.  I then tested against my local CE, and IDTOKENS auth worked<br/>
<span style="color: #235e5b"><span style="font-size: small">(09:23:46)</span> <b>dbox:</b></span> I can send you some condor logs from the glidein in question<br/>
<span style="color: #235e5b"><span style="font-size: small">(09:26:03)</span> <b>dbox:</b></span> an aside question:  does condor token auth go through some other port than 9618 or 9619?  Those are the two ports my VOCollector has open to <a href="http://wisc.edu">wisc.edu</a><br/>
<span style="color: #235e5b"><span style="font-size: small">(09:26:47)</span> <b>dbox:</b></span> my firewall rather, don't think the collector cares<br/>
<span style="color: #43761b"><span style="font-size: small">(09:27:27)</span> <b>blin:</b></span> i think it depends on how the vocollector is configured<br/>
<span style="color: #43761b"><span style="font-size: small">(09:27:35)</span> <b>blin:</b></span> because i assume you can change the port it's listening in on<br/>
<span style="color: #43761b"><span style="font-size: small">(09:27:51)</span> <b>blin:</b></span> i would guess that you just need 9618 open though<br/>
<span style="color: #43761b"><span style="font-size: small">(09:28:03)</span> <b>blin:</b></span> yeah, send me those logs<br/>
<span style="color: #235e5b"><span style="font-size: small">(09:37:27)</span> <b>dbox:</b></span> ack, never mind.  I was looking at the condor logs of the wrong glidein.  One came back a couple of minutes later that contained the logs I was looking for, and IDTOKENS auth actually worked this time.<br/>
<span style="color: #235e5b"><span style="font-size: small">(09:45:11)</span> <b>dbox:</b></span> interestingly enough, condor_status from the VOCollector machine still reported the AuthenticatedIdentity and AuthenticationMethod as condor@family and FAMILY for the glidein that authenticated correctly<br/>
<span style="color: #235e5b"><span style="font-size: small">(09:49:51)</span> <b>dbox:</b></span> You probably dont care about  it now, but I emailed you the MasterLog of the working glidein<br/>
<span style="color: #43761b"><span style="font-size: small">(09:55:03)</span> <b>blin:</b></span> ah ok, cool!<br/>
<span style="color: #a63024"><span style="font-size: small">(14:47:42)</span> <b>efajardo:</b></span> Hi <b>@here</b> condor experts<br/>
<span style="color: #a63024"><span style="font-size: small">(14:47:54)</span> <b>efajardo:</b></span> I am seeing this NEgotiator error<br/>
<span style="color: #a63024"><span style="font-size: small">(14:47:56)</span> <b>efajardo:</b></span> <pre>09/18/20 12:43:47 AUTHENTICATE: setting timeout for &lt;192.5.19.13:9618?addrs=192.5.19.13-9618&amp;noUDP&amp;sock=1371958_a6e3_3&gt; to 20.<br/>09/18/20 12:43:47 HANDSHAKE: in handshake(my_methods = '')<br/>09/18/20 12:43:47 HANDSHAKE: handshake() - i am the client<br/>09/18/20 12:43:47 HANDSHAKE: sending (methods == 0) to server<br/>09/18/20 12:43:47 HANDSHAKE: server replied (method = 0)<br/>09/18/20 12:43:47 SECMAN: required authentication with schedd <a href="mailto:jolsson@uclhc-1.ps.uci.edu">jolsson@uclhc-1.ps.uci.edu</a> failed, so aborting command NEGOTIATE.<br/>09/18/20 12:43:47 ERROR: AUTHENTICATE:1003:Failed to authenticate with any method<br/>09/18/20 12:43:47     Failed to send NEGOTIATE command to <a href="mailto:jolsson@uclhc-1.ps.uci.edu">jolsson@uclhc-1.ps.uci.edu</a> (&lt;192.5.19.13:9618?addrs=192.5.19.13-9618&amp;noUDP&amp;sock=1371958_a6e3_3&gt;)<br/>09/18/20 12:43:47 Failed to prefetch resource request lists for <a href="mailto:jolsson@uclhc-1.ps.uci.edu">jolsson@uclhc-1.ps.uci.edu</a>(&lt;192.5.19.13:9618?addrs=192.5.19.13-9618&amp;noUDP&amp;sock=1371958_a6e3_3&gt;</pre><br/>
<span style="color: #a63024"><span style="font-size: small">(14:48:31)</span> <b>efajardo:</b></span> However I do not understand thsi line:<br/>
<span style="color: #a63024"><span style="font-size: small">(14:48:36)</span> <b>efajardo:</b></span> <tt>09/18/20 12:43:47 HANDSHAKE: in handshake(my_methods = '')</tt><br/>
<span style="color: #a63024"><span style="font-size: small">(14:48:38)</span> <b>efajardo:</b></span> since<br/>
<span style="color: #a63024"><span style="font-size: small">(14:48:43)</span> <b>efajardo:</b></span> <pre>condor_config_val -v SEC_DAEMON_AUTHENTICATION_METHODS SEC_DEFAULT_AUTHENTICATION_METHODS<br/>SEC_DAEMON_AUTHENTICATION_METHODS = ,FS,GSI<br/> # at: /etc/condor/config.d/00_gwms_general.config, line 32<br/> # raw: SEC_DAEMON_AUTHENTICATION_METHODS = ,FS,GSI<br/><br/>SEC_DEFAULT_AUTHENTICATION_METHODS = GSI, FS<br/> # at: /etc/condor/config.d/92_uclhc_flock_from.config, line 1<br/> # raw: SEC_DEFAULT_AUTHENTICATION_METHODS = GSI, FS</pre><br/>
<span style="color: #43761b"><span style="font-size: small">(14:48:58)</span> <b>blin:</b></span> versions on each side?<br/>
<span style="color: #a63024"><span style="font-size: small">(14:49:02)</span> <b>efajardo:</b></span> 8.8.10<br/>
<span style="color: #43761b"><span style="font-size: small">(14:50:34)</span> <b>blin:</b></span> i thought there were negotation-specific sec knobs<br/>
<span style="color: #a63024"><span style="font-size: small">(14:50:59)</span> <b>efajardo:</b></span> <pre>condor_config_val SEC_NEGOTIATOR_AUTHENTICATION_METHODS<br/>,FS,GSI</pre><br/>
<span style="color: #a63024"><span style="font-size: small">(14:51:01)</span> <b>efajardo:</b></span> same<br/>
<span style="color: #43761b"><span style="font-size: small">(14:51:44)</span> <b>blin:</b></span> are there any other handshake lines above it?<br/>
<span style="color: #a63024"><span style="font-size: small">(14:52:22)</span> <b>efajardo:</b></span> <pre>09/18/20 12:51:49 SECMAN: command 416 NEGOTIATE to schedd <a href="mailto:jolsson@uclhc-1.ps.uci.edu">jolsson@uclhc-1.ps.uci.edu</a> from TCP port 45071 (blocking).<br/>09/18/20 12:51:49 SECMAN: new session, doing initial authentication.<br/>09/18/20 12:51:49 SECMAN: Auth methods: <br/>09/18/20 12:51:49 AUTHENTICATE: setting timeout for &lt;192.5.19.13:9618?addrs=192.5.19.13-9618&amp;noUDP&amp;sock=1371958_a6e3_3&gt; to 20.<br/>09/18/20 12:51:49 HANDSHAKE: in handshake(my_methods = '')<br/>09/18/20 12:51:49 HANDSHAKE: handshake() - i am the client<br/>09/18/20 12:51:49 HANDSHAKE: sending (methods == 0) to server<br/>09/18/20 12:51:49 HANDSHAKE: server replied (method = 0)<br/>09/18/20 12:51:49 SECMAN: required authentication with schedd <a href="mailto:jolsson@uclhc-1.ps.uci.edu">jolsson@uclhc-1.ps.uci.edu</a> failed, so aborting command NEGOTIATE.<br/>09/18/20 12:51:49 ERROR: AUTHENTICATE:1003:Failed to authenticate with any method<br/>09/18/20 12:51:49     Failed to send NEGOTIATE command to <a href="mailto:jolsson@uclhc-1.ps.uci.edu">jolsson@uclhc-1.ps.uci.edu</a> (&lt;192.5.19.13:9618?addrs=192.5.19.13-9618&amp;noUDP&amp;sock=1371958_a6e3_3&gt;)<br/>09/18/20 12:51:49   Error: Ignoring submitter for this cycle<br/>09/18/20 12:51:49   Negotiating with <a href="mailto:mjfenton@uclhc-2.ps.uci.edu">mjfenton@uclhc-2.ps.uci.edu</a> at &lt;192.5.19.44:9618?addrs=192.5.19.44-9618&amp;noUDP&amp;sock=1477715_284c_3&gt;<br/>09/18/20 12:51:49 0 seconds so far for this submitter<br/>09/18/20 12:51:49 0 seconds so far for this schedd</pre><br/>
<span style="color: #a2a5dc"><span style="font-size: small">(14:52:36)</span> <b>didavila:</b></span> it looks like it’s the schedd who doesn’t trust the negotiator<br/>
<span style="color: #a2a5dc"><span style="font-size: small">(14:52:59)</span> <b>didavila:</b></span> what’s on the schedd side?<br/>
<span style="color: #a63024"><span style="font-size: small">(14:53:01)</span> <b>efajardo:</b></span> ahh<br/>
<span style="color: #a63024"><span style="font-size: small">(14:53:11)</span> <b>efajardo:</b></span> good catch @didavila<br/>
<span style="color: #a63024"><span style="font-size: small">(14:53:16)</span> <b>efajardo:</b></span> <pre>condor_config_val SEC_NEGOTIATOR_AUTHENTICATION_METHODS<br/>PASSWORD</pre><br/>
</body>
</html>
