<!DOCTYPE html>
<html>
<head>
<title>Mon May 1, 2017 : #net-service (osg)</title>
</head>
<body>
<h3>Mon May 1, 2017 : #net-service (osg)</h3>
<span style="color: #4ec0d6"><span style="font-size: small">(08:37:56)</span> <b>smckee:</b></span> The "production" network services are still down as a residual impact of the underlying storage disk upgrade from 4TB disks to 8TB disks.    The two impacted VMs are <a href="http://psds1.grid.iu.edu">psds1.grid.iu.edu</a> and <a href="http://cassandra1.grid.iu.edu">cassandra1.grid.iu.edu</a>.    They will both need 'fsck' on their /, /tmp, /var and /usr/local areas.   The psds1 VM should be done first, then cassandra1.   Once their partitions are RW and OK we can restart httpd on psds0.   That should bring back the network data gathering and publishing.<br/>
<span style="color: #4bbe2e"><span style="font-size: small">(08:38:44)</span> <b>rquick:</b></span> hi shawn, do you need me to get tom involved?<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(08:39:04)</span> <b>smckee:</b></span> Next steps after that:    1) Resizing VM resources, 2) Upgrading to use new perfSONAR 4.0 RPMs, 3) retiring some ITB VMs for the network service, 4) Putting <a href="http://meshconfig.grid.iu.edu">meshconfig.grid.iu.edu</a> into production<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(08:39:27)</span> <b>smckee:</b></span> Yes, that would help.  I have a ticket open:  <a href="https://ticket.grid.iu.edu/33641">https://ticket.grid.iu.edu/33641</a><br/>
<span style="color: #4bbe2e"><span style="font-size: small">(08:40:15)</span> <b>rquick:</b></span> on it...<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(08:40:27)</span> <b>smckee:</b></span> Thanks @rquick<br/>
<span style="color: #4bbe2e"><span style="font-size: small">(08:47:26)</span> <b>rquick:</b></span> ok, i've sent him and SMS... if we don't hear from him by the top of the hour i'll ping you for info to start it... my sudo should work :wink:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(08:48:22)</span> <b>smckee:</b></span> OK.   I have a meeting from 10-11 (may end early)...walking across campus now.  I should be back to my office ~11 AM.<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(08:48:59)</span> <b>smckee:</b></span> FYI psds0 had the same problem.   See this ticket FYI:  <a href="https://ticket.grid.iu.edu/33631">https://ticket.grid.iu.edu/33631</a><br/>
<span style="color: #4bbe2e"><span style="font-size: small">(08:50:10)</span> <b>rquick:</b></span> ok, then we can start then if tom hasn't gotten to it... which i would fully expect him to<br/>
<span style="color: #684b6c"><span style="font-size: small">(11:06:04)</span> <b>hayashis:</b></span> @mvkrenz I think I've found the issue with mca/mccache service. I will test it for a few more hours and release the change to meshconfig-itb<br/>
<span style="color: #5b89d5"><span style="font-size: small">(11:06:23)</span> <b>mvkrenz:</b></span> ok<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:30:11)</span> <b>smckee:</b></span> Good.  Thanks for finding the problem.   Once meshconfig-itb is verified to work we can do meshconfig?<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:56:15)</span> <b>smckee:</b></span> Regarding cassandra1, we have a problem with SSTABLEs being corrupt:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:56:28)</span> <b>smckee:</b></span> INFO  16:48:31 Opening /usr/local/cassandra/data/system/compactions_in_progress-55080ab05d9c388690a4acb25fe1f77b/system-compactions_in_progress-ka-113245 (42 bytes)<br/>ERROR 16:48:31 Exiting forcefully due to file system exception on startup, disk failure policy "stop"<br/>org.apache.cassandra.io.sstable.CorruptSSTableException: java.io.EOFException<br/>        at org.apache.cassandra.io.compress.CompressionMetadata.&lt;init&gt;(CompressionMetadata.java:131) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.compress.CompressionMetadata.create(CompressionMetadata.java:85) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.util.CompressedSegmentedFile$Builder.metadata(CompressedSegmentedFile.java:79) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.util.CompressedPoolingSegmentedFile$Builder.complete(CompressedPoolingSegmentedFile.java:72) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.util.SegmentedFile$Builder.complete(SegmentedFile.java:169) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.sstable.SSTableReader.load(SSTableReader.java:741) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.sstable.SSTableReader.load(SSTableReader.java:692) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.sstable.SSTableReader.open(SSTableReader.java:480) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.sstable.SSTableReader.open(SSTableReader.java:376) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.io.sstable.SSTableReader$4.run(SSTableReader.java:523) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_121]<br/>        at java.util.concurrent.FutureTask.run(FutureTask.java:266) [na:1.8.0_121]<br/>        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [na:1.8.0_121]<br/>        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_121]<br/>        at java.lang.Thread.run(Thread.java:745) [na:1.8.0_121]<br/>Caused by: java.io.EOFException: null<br/>        at java.io.DataInputStream.readFully(DataInputStream.java:197) ~[na:1.8.0_121]<br/>        at java.io.DataInputStream.readUTF(DataInputStream.java:609) ~[na:1.8.0_121]<br/>        at java.io.DataInputStream.readUTF(DataInputStream.java:564) ~[na:1.8.0_121]<br/>        at org.apache.cassandra.io.compress.CompressionMetadata.&lt;init&gt;(CompressionMetadata.java:106) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        ... 14 common frames omitted<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:56:48)</span> <b>smckee:</b></span> I am going to try this thread (changing policy and scrubbing):<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:56:54)</span> <b>smckee:</b></span> <a href="http://stackoverflow.com/questions/35350505/cassandra-recently-blue-screen-led-to-corrupt-sstables">http://stackoverflow.com/questions/35350505/cassandra-recently-blue-screen-led-to-corrupt-sstables</a><br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:57:15)</span> <b>smckee:</b></span> Setting best_effort here:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:57:18)</span> <b>smckee:</b></span> # policy for data disk failures:<br/># die: shut down gossip and client transports and kill the JVM for any fs errors or<br/>#      single-sstable errors, so the node can be replaced.<br/># stop_paranoid: shut down gossip and client transports even for single-sstable errors,<br/>#                kill the JVM for errors during startup.<br/># stop: shut down gossip and client transports, leaving the node effectively dead, but<br/>#       can still be inspected via JMX, kill the JVM for errors during startup.<br/># best_effort: stop using the failed disk and respond to requests based on<br/>#              remaining available sstables.  This means you WILL see obsolete<br/>#              data at CL.ONE!<br/># ignore: ignore fatal errors and let requests fail, as in pre-1.2 Cassandra<br/>disk_failure_policy: best_effort<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:57:24)</span> <b>smckee:</b></span> (Was "stop")<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(11:57:46)</span> <b>smckee:</b></span> Edited file /etc/cassandra/default.conf/cassandra.yaml on cassandra1<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:01:39)</span> <b>smckee:</b></span> This let me find the "bad" files:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:01:42)</span> <b>smckee:</b></span> [1] 17:00:09 UTC [root@cassandra1:~]# ls -al /usr/local/cassandra/data/esmond/raw_data-bcdcb550323311e597bdbb7b6ea8dddc/ &amp;&gt; bad_esmond_files.log<br/>[1] 17:00:23 UTC [root@cassandra1:~]# less bad_esmond_files.log<br/>[0] 17:00:57 UTC [root@cassandra1:~]# grep -v cassandra bad_esmond_files.log<br/>total 1427127016<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730268-CompressionInfo.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730837-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730838-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730838-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730839-Digest.sha1<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730840-CompressionInfo.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730840-Digest.sha1<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730840-Filter.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730842-Digest.sha1<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730842-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730843-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730844-Digest.sha1<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730844-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730845-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730846-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730846-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730847-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730847-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730848-CompressionInfo.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730848-Filter.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730848-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-730848-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731459-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731460-Digest.sha1<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731460-Statistics.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731460-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731461-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731462-Statistics.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731463-Digest.sha1<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731468-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731470-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731470-TOC.txt<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731473-Digest.sha1<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731473-Summary.db<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731474-Digest.sha1<br/>-????????? ? ?         ?                 ?            ? esmond-raw_data-ka-731475-CompressionInfo.db<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:02:17)</span> <b>smckee:</b></span> I will try removing them and restarting again (the restart with 'best_effort' still died)<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:04:19)</span> <b>smckee:</b></span> These are going to be a problem:<br/>
<span style="color: #684b6c"><span style="font-size: small">(12:04:38)</span> <b>hayashis:</b></span> that looks nasty<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:04:42)</span> <b>smckee:</b></span> rm: cannot remove `/usr/local/cassandra/data/esmond/raw_data-bcdcb550323311e597bdbb7b6ea8dddc/esmond-raw_data-ka-731460-Digest.sha1': Input/output error<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:05:06)</span> <b>smckee:</b></span> Yes it looks like the transfer to the new larger disks has some corruption on cassandra1<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:05:56)</span> <b>smckee:</b></span> I was hoping to just remove them and get things running.  A copy of the 'lost' data should exist on either cassandra2 or cassandra3<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:09:43)</span> <b>smckee:</b></span> [1] 17:03:55 UTC [root@cassandra1:~]# df<br/>Filesystem             1K-blocks       Used  Available Use% Mounted on<br/>/dev/mapper/vg0-root    18349948    2129888   15281260  13% /<br/>tmpfs                   16439488          0   16439488   0% /dev/shm<br/>/dev/vda1                1032088     176668     802992  19% /boot<br/>/dev/mapper/vg0-home     2708200       4660    2562640   1% /home<br/>/dev/mapper/vg0-opt      1998672       3480    1890336   1% /opt<br/>/dev/mapper/vg0-tmp       999320       1452     945440   1% /tmp<br/>/dev/vdb1            11536151344 1747325940 9202815756  16% /usr/local<br/>/dev/mapper/vg0-var      5416552     833308    4301440  17% /var<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:09:58)</span> <b>smckee:</b></span> I am going to try to dismount /dev/vdb1 and run another fsck on it...<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:12:48)</span> <b>smckee:</b></span> Yeah fsck is finding lots of issues :disappointed:   Hopefully this clears up the problems  though<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:13:06)</span> <b>smckee:</b></span> Running additional passes to resolve blocks claimed by more than one inode...<br/>Pass 1B: Rescanning for multiply-claimed blocks<br/>Multiply-claimed block(s) in inode 630589686: 2522410194<br/>Multiply-claimed block(s) in inode 630590313: 2522414917<br/>Multiply-claimed block(s) in inode 630590530: 2523341719 2523341720 2523341721<br/>Multiply-claimed block(s) in inode 630592846: 2522413085<br/>Multiply-claimed block(s) in inode 630594737: 2522414485<br/>Multiply-claimed block(s) in inode 630594907: 2522392203<br/>Multiply-claimed block(s) in inode 630599419: 2522413531<br/>Multiply-claimed block(s) in inode 630604689: 2523338047 2523338048 2523338049 2523338050 2523338051<br/>Multiply-claimed block(s) in inode 630606704: 2522392200<br/>Multiply-claimed block(s) in inode 630607101: 2522392201<br/>Multiply-claimed block(s) in inode 630608369: 2523341719<br/>Multiply-claimed block(s) in inode 630608649: 2523341720 2523341721<br/>Multiply-claimed block(s) in inode 630609344: 2523338047 2523338048 2523338049 2523338050 2523338051<br/>Multiply-claimed block(s) in inode 630610735: 2522392203<br/>Multiply-claimed block(s) in inode 630614062: 2522413085<br/>Multiply-claimed block(s) in inode 630617003: 2522413893<br/>Multiply-claimed block(s) in inode 630632808: 2522392200<br/>Multiply-claimed block(s) in inode 630632879: 2522392201<br/>Multiply-claimed block(s) in inode 630633332: 2522410194<br/>Multiply-claimed block(s) in inode 630634305: 2522413531<br/>Multiply-claimed block(s) in inode 630634820: 2522414485<br/>Multiply-claimed block(s) in inode 630635369: 2522413893<br/>Multiply-claimed block(s) in inode 630635883: 2522414917<br/>Pass 1C: Scanning directories for inodes with multiply-claimed blocks<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:13:23)</span> <b>smckee:</b></span> And things like:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:13:26)</span> <b>smckee:</b></span> Inode 630597781 ref count is 2, should be 3.  Fix? yes<br/><br/>Inode 630598980 ref count is 1, should be 2.  Fix? yes<br/><br/>Inode 630599382 ref count is 1, should be 2.  Fix? yes<br/><br/>Inode 630601593 ref count is 1, should be 2.  Fix? yes<br/><br/>Inode 630601714 ref count is 1, should be 2.  Fix? yes<br/><br/>Inode 630601727 ref count is 1, should be 2.  Fix? yes<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:18:29)</span> <b>smckee:</b></span> Second run of fsck was clean...remounting<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:56:04)</span> <b>smckee:</b></span> OK, after deleting multiple problematic files cassandra1 is running cassandra.<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:56:12)</span> <b>smckee:</b></span> Problem now moves to psds0:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:56:23)</span> <b>smckee:</b></span> Postgresql won't start.   Log shows:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(12:56:26)</span> <b>smckee:</b></span> [0] 17:55:16 UTC [root@psds0:~]# cat /usr/local/pgsql/data/pg_log/postgresql-2017-05-01_135403.log<br/>LOG:  database system was interrupted while in recovery at 2017-05-01 13:30:25 EDT<br/>HINT:  This probably means that some data is corrupted and you will have to use the last backup for recovery.<br/>LOG:  database system was not properly shut down; automatic recovery in progress<br/>LOG:  redo starts at 1338/2A000148<br/>FATAL:  could not access status of transaction 3602403603<br/>DETAIL:  Could not read from file "pg_clog/0D6B" at offset 131072: Success.<br/>CONTEXT:  xlog redo commit: 2017-04-24 19:16:41.821437+00<br/>LOG:  startup process (PID 3375598) exited with exit code 1<br/>LOG:  aborting startup due to startup process failure<br/>
<span style="color: #4bbe2e"><span style="font-size: small">(12:58:56)</span> <b>rquick:</b></span> :disappointed:<br/>
<span style="color: #4bbe2e"><span style="font-size: small">(13:00:13)</span> <b>rquick:</b></span> we should get tom into this room<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:00:29)</span> <b>smckee:</b></span> Yeah I had asked Scott about that (above)<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:00:49)</span> <b>smckee:</b></span> I don't see Tom as a user in this team though<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:01:40)</span> <b>smckee:</b></span> I am going to run fsck on /usr/local (/dev/vdb1) just in case that might help. Postgresql is using that area<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:03:22)</span> <b>smckee:</b></span> fsck shows no problems.<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:06:45)</span> <b>smckee:</b></span> FYI cassandra1 is again not running cassandra...I have to see what is going on there.<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:08:03)</span> <b>smckee:</b></span> ERROR 18:06:12 Exiting due to error while processing commit log during initialization.<br/>org.apache.cassandra.io.FSWriteError: java.io.FileNotFoundException: /usr/local/cassandra/commitlog/CommitLog-4-1493661923081.log (Permission denied)<br/>        at org.apache.cassandra.db.commitlog.CommitLogSegment.&lt;init&gt;(CommitLogSegment.java:177) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.db.commitlog.CommitLogSegmentManager$4.call(CommitLogSegmentManager.java:397) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.db.commitlog.CommitLogSegmentManager$4.call(CommitLogSegmentManager.java:394) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.db.commitlog.CommitLogSegmentManager$1.runMayThrow(CommitLogSegmentManager.java:152) ~[apache-cassandra-2.1.10.jar:2.1.10]<br/>        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28) [apache-cassandra-2.1.10.jar:2.1.10]<br/>        at java.lang.Thread.run(Thread.java:745) [na:1.8.0_121]<br/>Caused by: java.io.FileNotFoundException: /usr/local/cassandra/commitlog/CommitLog-4-1493661923081.log (Permission denied)<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:08:20)</span> <b>smckee:</b></span> Looks like permissions weren't replicated (somehow)...checking<br/>
<span style="color: #4bbe2e"><span style="font-size: small">(13:08:56)</span> <b>rquick:</b></span> tom is getting an account for the osg channel<br/>
<span style="color: #684b6c"><span style="font-size: small">(13:08:58)</span> <b>hayashis:</b></span> @mvkrenz meshconfig-itb looks good. Can you proceed with updating mca-admin container on production?<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:13:54)</span> <b>smckee:</b></span> Got cassandra1 back after fixing the protections on some files (root owned some commitlog files...changed back to cassandra)<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:19:10)</span> <b>smckee:</b></span> Found this regarding the postgresql FATAL we are seeing:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:19:12)</span> <b>smckee:</b></span> <a href="https://www.postgresql.org/message-id/AANLkTims48njGKkvkXHiTG6=19hQ31VFmFRPPLg+5w03@mail.gmail.com">https://www.postgresql.org/message-id/AANLkTims48njGKkvkXHiTG6=19hQ31VFmFRPPLg+5w03@mail.gmail.com</a><br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:19:37)</span> <b>smckee:</b></span> I see the '0D6B' file in pg_clog is NOT the right length:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:19:45)</span> <b>smckee:</b></span> -rw-------  1 postgres postgres 262144 Apr 24 18:08 0D68<br/>-rw-------  1 postgres postgres 262144 Apr 24 18:35 0D69<br/>-rw-------  1 postgres postgres 262144 Apr 24 19:01 0D6A<br/>-rw-------  1 postgres postgres 114688 Apr 24 19:14 0D6B<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:19:50)</span> <b>smckee:</b></span> Will try this:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:20:14)</span> <b>smckee:</b></span> dd if=/dev/zero of=pg_clog/0D6B bs=256K count=1<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:20:22)</span> <b>smckee:</b></span> (from the /usr/local/pgsql/data area)<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:20:47)</span> <b>smckee:</b></span> Retrying postgresql startup now...<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:21:39)</span> <b>smckee:</b></span> Worked! :slightly_smiling_face:<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:21:41)</span> <b>smckee:</b></span> [0] 18:21:20 UTC [root@psds0:/usr/local/pgsql/data]# cat /usr/local/pgsql/data/pg_log/postgresql-2017-05-01_142118.log<br/>LOG:  database system was interrupted while in recovery at 2017-05-01 14:00:31 EDT<br/>HINT:  This probably means that some data is corrupted and you will have to use the last backup for recovery.<br/>LOG:  database system was not properly shut down; automatic recovery in progress<br/>LOG:  redo starts at 1338/2A000148<br/>LOG:  unexpected pageaddr 1337/BF010000 in log segment 00000001000013380000002A, offset 65536<br/>LOG:  redo done at 1338/2A00F368<br/>LOG:  last completed transaction was at log time 2017-04-24 19:16:41.868865+00<br/>LOG:  MultiXact member wraparound protections are now enabled<br/>LOG:  autovacuum launcher started<br/>LOG:  database system is ready to accept connections<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:25:23)</span> <b>smckee:</b></span> OK, I just got email that CERN is seeing data again<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:25:38)</span> <b>smckee:</b></span> FYI, the rate of perfsonar-raw-packet-loss-rate messages received by the netmon brokers<br/>is now back to normal.<br/><br/>Regards,<br/><br/>CERN Messaging Team - <a href="mailto:mig@cern.ch">mig@cern.ch</a> - <a href="http://cern.ch/mig">http://cern.ch/mig</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(13:30:51)</span> <b>thomlee:</b></span> Great!<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:43:25)</span> <b>smckee:</b></span> So we can close the ticket opened there.   Thanks<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:44:18)</span> <b>smckee:</b></span> For the record I returned to the 'stop' policy in cassandra.yaml from 'best_effort'<br/>
</body>
</html>
