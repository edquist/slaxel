<!DOCTYPE html>
<html>
<head>
<title>Mon Nov 23, 2020 : #net-service (osg)</title>
</head>
<body>
<h3>Mon Nov 23, 2020 : #net-service (osg)</h3>
<span style="color: #4ec0d6"><span style="font-size: small">(09:37:26)</span> <b>smckee:</b></span> @dweitzel Andy Lake replied (see email).   I have to dig into the info he sent but it is likely things are working OK.   I think we will want to try to push ahead and add sites to directly write to RabbitMQ.  (USATLAS and USCMS).    We will then need to verify the production system switches from pulling to using the pushed data AND that the sites seem to have similar data amounts and values across the transition from pull to push.  Thoughts?<br/>
<span style="color: #235e5b"><span style="font-size: small">(09:38:42)</span> <b>dweitzel:</b></span> There are a few steps before we can move from the parallel pipeline to the production pipeline.<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(09:40:56)</span> <b>smckee:</b></span> Which steps?    Getting docker-compose into production PWA and ?<br/>
<span style="color: #235e5b"><span style="font-size: small">(09:56:24)</span> <b>dweitzel:</b></span> 1. Update collector with this pull request and put it in production: <a href="https://github.com/sand-ci/ps-collector/pull/3">https://github.com/sand-ci/ps-collector/pull/3</a><br/>2. Update ingesters to make sure they have the latest version from github (I think they do)<br/>3. Configure message bus to have the right exchanges, limits, and alerting.<br/>4. Update token configuration to push to the production exchange and vhost.<br/>I'm sure I'll think of other things, but that's what is in my head now.<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:10:39)</span> <b>smckee:</b></span> OK, I have updated the latency tests on ITB to use the IPv4 flag (to match production)<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(13:11:19)</span> <b>smckee:</b></span> Lets see how the events match.    To do this correctly, we should revise the who PWA configuration...but this should be close.<br/>
<span style="color: #84b22f"><span style="font-size: small">(13:21:42)</span> <b>ivukotic:</b></span> I tried de-duplicating and these are the only documents deleted:<br/>
<span style="color: #84b22f"><span style="font-size: small">(13:21:43)</span> <b>ivukotic:</b></span> start: 2020-11-19 00:00:00<br/>stop:  2020-11-20 00:00:00<br/>Checking:  ps_retransmits<br/>docs read 10000<br/>docs read 20000<br/>read: 20376<br/>to delete: 159<br/>deleted: 100   issues: 0<br/>deleted: 59   issues: 0<br/>Checking:  ps_throughput<br/>docs read 10000<br/>docs read 20000<br/>read: 20469<br/>to delete: 158<br/>deleted: 100   issues: 0<br/>deleted: 58   issues: 0<br/>
<span style="color: #4ec0d6"><span style="font-size: small">(16:57:42)</span> <b>smckee:</b></span> Data written on RabbitMQ from the ITB config looks better now:  <a href="https://atlas-kibana.mwt2.org/s/networking/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:'2020-11-23T19:30:00.000Z',to:'2020-11-23T22:30:00.000Z'))&amp;_a=(columns:!(delay_median,delay_mean),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'4fa7bca0-2b6b-11eb-8f92-953711258120',key:src,negate:!f,params:(query:'2001:48a8:68f7:8001:192:41:236:31'),type:phrase),query:(match_phrase:(src:'2001:48a8:68f7:8001:192:41:236:31'))),('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'4fa7bca0-2b6b-11eb-8f92-953711258120',key:dest_host,negate:!f,params:(query:mwt2-ps01.campuscluster.illinois.edu),type:phrase),query:(match_phrase:(dest_host:mwt2-ps01.campuscluster.illinois.edu)))),index:'4fa7bca0-2b6b-11eb-8f92-953711258120',interval:auto,query:(language:kuery,query:''),sort:!())">https://atlas-kibana.mwt2.org/s/networking/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:'2020-11-23T19:30:00.000Z',to:'2020-11-23T22:30:00.000Z'))&amp;_a=(columns:!(delay_median,delay_mean),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'4fa7bca0-2b6b-11eb-8f92-953711258120',key:src,negate:!f,params:(query:'2001:48a8:68f7:8001:192:41:236:31'),type:phrase),query:(match_phrase:(src:'2001:48a8:68f7:8001:192:41:236:31'))),('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'4fa7bca0-2b6b-11eb-8f92-953711258120',key:dest_host,negate:!f,params:(query:mwt2-ps01.campuscluster.illinois.edu),type:phrase),query:(match_phrase:(dest_host:mwt2-ps01.campuscluster.illinois.edu)))),index:'4fa7bca0-2b6b-11eb-8f92-953711258120',interval:auto,query:(language:kuery,query:''),sort:!())</a><br/>
<span style="color: #4ec0d6"><span style="font-size: small">(16:58:18)</span> <b>smckee:</b></span> This is psmsu01 to MWT2 Illinois.    The timestamps are about 1 per minute which is inline with what I would expect<br/>
</body>
</html>
