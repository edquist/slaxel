<!DOCTYPE html>
<html>
<head>
<title>Thu Apr 20, 2017 : #gracc (osg)</title>
</head>
<body>
<h3>Thu Apr 20, 2017 : #gracc (osg)</h3>
<span style="color: #3c8c69"><span style="font-size: small">(11:09:52)</span> <b>kretzke:</b></span> <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/circuit-breaker.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/circuit-breaker.html</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(11:13:01)</span> <b>bbockelm:</b></span> <b>@edquist</b> - will you be able to join the meeting?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:23:04)</span> <b>dweitzel:</b></span> The HCC Cloud is adding more storage nodes, and doing the necessary rebalancing.  We may see some temporary IO performance degradation.<br/>
<span style="color: #16569E"><span style="font-size: small">(11:29:14)</span> <b>edquist:</b></span> where is the meeting?<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:29:22)</span> <b>dweitzel:</b></span> <a href="https://zoom.us/j/622336257">https://zoom.us/j/622336257</a><br/>
<span style="color: #16569E"><span style="font-size: small">(11:30:45)</span> <b>edquist:</b></span> do i need to download the client to join?  or can i just call in?<br/>
<span style="color: #16569E"><span style="font-size: small">(11:30:58)</span> <b>edquist:</b></span> sorry i was not aware of the meeting today<br/>
<span style="color: #3c8c69"><span style="font-size: small">(11:30:59)</span> <b>kretzke:</b></span> <a href="https://gracc.opensciencegrid.org/dev/dashboard/db/kmr-treemap">https://gracc.opensciencegrid.org/dev/dashboard/db/kmr-treemap</a><br/>
<span style="color: #235e5b"><span style="font-size: small">(11:31:08)</span> <b>dweitzel:</b></span> Dial: +1 646 558 8656 (US Toll) or +1 408 638 0968 (US Toll)<br/>    Meeting ID: 622 336 257<br/>
<span style="color: #16569E"><span style="font-size: small">(11:31:17)</span> <b>edquist:</b></span> thx<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:34:22)</span> <b>dweitzel:</b></span> If the call ends, Here is a new meeting id: <a href="https://nebraskaextension.zoom.us/j/6086401435">https://nebraskaextension.zoom.us/j/6086401435</a>  Carl, same phone number, meeting ID is <a href="tel:608-640-1435">608-640-1435</a><br/>
<span style="color: #3c8c69"><span style="font-size: small">(11:35:22)</span> <b>kretzke:</b></span> <a href="http://fermicloud035.fnal.gov:8100/gratia/html/osg_hours_efficiency_tree_map_by_vo_project_facility">http://fermicloud035.fnal.gov:8100/gratia/html/osg_hours_efficiency_tree_map_by_vo_project_facility</a><br/>
<span style="color: #16569E"><span style="font-size: small">(11:42:31)</span> <b>edquist:</b></span> derp, are we continuing in the new meeting?<br/>
<span style="color: #53b759"><span style="font-size: small">(11:42:36)</span> <b>marian:</b></span> we've switched to new room<br/>
<span style="color: #53b759"><span style="font-size: small">(11:42:37)</span> <b>marian:</b></span> yes<br/>
<span style="color: #3c8c69"><span style="font-size: small">(11:42:41)</span> <b>kretzke:</b></span> <b>@edquist</b> I’ve added you to gracc-project list<br/>
<span style="color: #3c8c69"><span style="font-size: small">(11:43:15)</span> <b>kretzke:</b></span> anything more to discuss?<br/>
<span style="color: #16569E"><span style="font-size: small">(11:43:51)</span> <b>edquist:</b></span> thanks<br/>
<span style="color: #16569E"><span style="font-size: small">(11:43:56)</span> <b>edquist:</b></span> joining now<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:21:19)</span> <b>bbockelm:</b></span> <b>@edquist</b> @marian @dweitzel - <a href="https://github.com/apel/ssm">https://github.com/apel/ssm</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(12:22:12)</span> <b>bbockelm:</b></span> <a href="http://apel.github.io/">http://apel.github.io/</a> ah, they even have RHEL7 RPMs built.<br/>
<span style="color: #53b759"><span style="font-size: small">(12:22:45)</span> <b>marian:</b></span> ok, prefered hostname?<br/>
<span style="color: #53b759"><span style="font-size: small">(12:23:09)</span> <b>marian:</b></span> or run it on grace<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:23:33)</span> <b>bbockelm:</b></span> do we know if the current one is <tt>*.<a href="http://grid.iu.edu">grid.iu.edu</a></tt> or <tt>*.<a href="http://opensciencegrid.org">opensciencegrid.org</a></tt>?<br/>
<span style="color: #53b759"><span style="font-size: small">(12:24:14)</span> <b>marian:</b></span> (no clue)<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:24:26)</span> <b>bbockelm:</b></span> <tt><a href="http://hcc-apel.unl.edu">hcc-apel.unl.edu</a></tt> is fine by me.  Let's do this in a Docker container on GRACE.<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:27:06)</span> <b>bbockelm:</b></span> Carl or Garhan can get you the (service) certificate.<br/>
<span style="color: #53b759"><span style="font-size: small">(12:28:12)</span> <b>marian:</b></span> do we meet Scott today? Preferably not after 3:15pm ... one of those days when I need cover my wife pick up kids ... it's rare but this week is special<br/>
<span style="color: #53b759"><span style="font-size: small">(12:32:19)</span> <b>marian:</b></span> @kretzke: which docker image would be best? I see quite some on hcc-grace ... anyone useful or need create new one for hcc-apel?<br/>
<span style="color: #3c8c69"><span style="font-size: small">(12:35:25)</span> <b>kretzke:</b></span> new one. probably start from centos:7. the gracc-collector dockerfile may be a good example <a href="https://github.com/opensciencegrid/gracc-collector/blob/master/Dockerfile">https://github.com/opensciencegrid/gracc-collector/blob/master/Dockerfile</a><br/>
<span style="color: #3c8c69"><span style="font-size: small">(12:36:09)</span> <b>kretzke:</b></span> or this <a href="https://github.com/retzkek/gracc-dev/blob/master/gratia-probe-condor/Dockerfile">https://github.com/retzkek/gracc-dev/blob/master/gratia-probe-condor/Dockerfile</a><br/>
<span style="color: #53b759"><span style="font-size: small">(12:36:43)</span> <b>marian:</b></span> sounds good, thanks<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:40:58)</span> <b>bbockelm:</b></span> you'll probably want to bind-mount in the service certs from the outside.<br/>
<span style="color: #9e3997"><span style="font-size: small">(12:43:58)</span> <b>bbockelm:</b></span> Just talked to Garhan - I think it'd be best if we used a service cert, <tt>.../CN=apel/hcc-grace.unl.edu</tt><br/>
<span style="color: #53b759"><span style="font-size: small">(14:39:06)</span> <b>marian:</b></span> ok, got cert and we also talked with Scott... I guess <b>@edquist</b> can summarize our  talk<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:37:19)</span> <b>bbockelm:</b></span> <b>@edquist</b> ^^^ ping?<br/>
<span style="color: #16569E"><span style="font-size: small">(15:38:11)</span> <b>edquist:</b></span> (sorry was meeting with @blin to discuss, am writing up a summary here now...)<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:41:02)</span> <b>bbockelm:</b></span> :slightly_smiling_face: sounds good<br/>
<span style="color: #16569E"><span style="font-size: small">(15:41:07)</span> <b>edquist:</b></span> Scott said he will need to do more research to figure out how everything is set up (doesn't really remember all the details, probably not super well documented, they don't seem to have a procedure for setting it up from scratch) ...<br/><br/>apparently the ssm send tool (<a href="https://wiki.egi.eu/wiki/APEL/SSM">https://wiki.egi.eu/wiki/APEL/SSM</a>) is used to submit the generated report to apel, and apparently you need a special apel cert or something.  Anyway it sounded like he will not be able to have a dump of the full process this week.  But instead, in the mean time, we can place the apel report output file in the expected location (on the iu shared file system), and the current cron job that runs the ssm script will pick it up<br/>
<span style="color: #16569E"><span style="font-size: small">(15:42:43)</span> <b>edquist:</b></span> So, we can run the new gracc script to generate the apel report from any el7 node (Nebraska? Fermicloud?), and then scp it via <a href="http://jump.grid.iu.edu">jump.grid.iu.edu</a> to their shared fs<br/>
<span style="color: #16569E"><span style="font-size: small">(15:43:08)</span> <b>edquist:</b></span> Scott did not sound interested in setting up a special service account for this<br/>
<span style="color: #16569E"><span style="font-size: small">(15:43:40)</span> <b>edquist:</b></span> which means (i guess?) i use my personal login in this stop-gap period  :neutral_face:<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:46:22)</span> <b>bbockelm:</b></span> great.  In that case, please still put it all in a Docker container :slightly_smiling_face:<br/>
<span style="color: #16569E"><span style="font-size: small">(15:46:41)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:48:33)</span> <b>bbockelm:</b></span> Have you seen the basics of putting together a container?  I really liked @kretzke's example above: <a href="https://github.com/retzkek/gracc-dev/blob/master/gratia-probe-condor/Dockerfile">https://github.com/retzkek/gracc-dev/blob/master/gratia-probe-condor/Dockerfile</a><br/>
<span style="color: #16569E"><span style="font-size: small">(15:50:51)</span> <b>edquist:</b></span> nope, this'll be my first time going through it  :slightly_smiling_face:<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:51:51)</span> <b>bbockelm:</b></span> it really isn't that bad.  Just do it on a RHEL7 VM (RHEL6 "support" stinks).<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:52:41)</span> <b>bbockelm:</b></span> Did Scott kick off the email to register the service cert DN with APEL?<br/>
<span style="color: #16569E"><span style="font-size: small">(15:55:39)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(15:55:46)</span> <b>edquist:</b></span> not that i'm aware of<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:55:51)</span> <b>bbockelm:</b></span> Given it involves a round trip with external folks, can we get that process for registering the new certificate started today?<br/>
<span style="color: #16569E"><span style="font-size: small">(15:56:44)</span> <b>edquist:</b></span> it was not clear to me that Scott even remembers what that process is, but sure we can ask<br/>
<span style="color: #16569E"><span style="font-size: small">(15:58:34)</span> <b>edquist:</b></span> is this the cert in question?<br/>subject= /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=apel/hcc-grace.unl.edu<br/>
<span style="color: #16569E"><span style="font-size: small">(15:58:41)</span> <b>edquist:</b></span> (from @marian's email)<br/>
<span style="color: #16569E"><span style="font-size: small">(15:58:55)</span> <b>edquist:</b></span> (and, do we need the issuer also?)<br/>
<span style="color: #43761b"><span style="font-size: small">(16:01:52)</span> <b>blin:</b></span> i don't think it would hurt to include it in the request<br/>
<span style="color: #16569E"><span style="font-size: small">(16:02:39)</span> <b>edquist:</b></span> right ... @marian, you mentioned that subject DN earlier, do you know the issuer / CA also?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:02:45)</span> <b>marian:</b></span> no new DN registration …<br/>
<span style="color: #16569E"><span style="font-size: small">(16:03:43)</span> <b>***edquist:</b></span> doesn't understand<br/>
<span style="color: #53b759"><span style="font-size: small">(16:03:59)</span> <b>marian:</b></span> at least Scott refrained from it … he didn’t remember who is suppose to be doing that and was against it as it was real pain and people unflexible doing it on the other side of the pond … that’s what I’ve got from conversation two hrs ago<br/>
<span style="color: #16569E"><span style="font-size: small">(16:04:24)</span> <b>edquist:</b></span> yeah there was definitely that vibe  :slightly_smiling_face:<br/>
<span style="color: #53b759"><span style="font-size: small">(16:04:40)</span> <b>marian:</b></span> he said he must mine his notes who is right person to register new DN accept our reports, that’s why he said let’s use still his push procedure<br/>
<span style="color: #53b759"><span style="font-size: small">(16:04:45)</span> <b>marian:</b></span> and use your file, Carl<br/>
<span style="color: #16569E"><span style="font-size: small">(16:05:15)</span> <b>edquist:</b></span> yeah actually it sounded like he wasn't even sure who the current contact person is at apel<br/>
<span style="color: #53b759"><span style="font-size: small">(16:05:21)</span> <b>marian:</b></span> yeah<br/>
<span style="color: #53b759"><span style="font-size: small">(16:07:35)</span> <b>marian:</b></span> well, I asked same question from different angles about registering our DN regardless and answer was always “don’t do it, it’s pain”<br/>
<span style="color: #53b759"><span style="font-size: small">(16:08:11)</span> <b>marian:</b></span> so either we find out who is doing that or we try again later<br/>
<span style="color: #53b759"><span style="font-size: small">(16:08:18)</span> <b>marian:</b></span> Scott said it’s RAL<br/>
<span style="color: #53b759"><span style="font-size: small">(16:09:55)</span> <b>marian:</b></span> that’s all I’ve got regarding registering new DN … I was also asking if they would accept additional DN that we want to test and answer was same - they won’t accept and person who was doing it for him isn’t there anymore … now I recall that he said John Gordon?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:10:14)</span> <b>marian:</b></span> so, Brian, do you know shortcut? who would be from RAL to bother?<br/>
<span style="color: #16569E"><span style="font-size: small">(16:10:43)</span> <b>edquist:</b></span> yeah John Gordon used to be an apel contact person; Scott was saying he was unsure if John was still the one<br/>
<span style="color: #53b759"><span style="font-size: small">(16:11:19)</span> <b>marian:</b></span> so perhaps @bbockelm has someone we can start to talk?<br/>
<span style="color: #16569E"><span style="font-size: small">(16:12:15)</span> <b>edquist:</b></span> @marian, how do i get an el7 node up at nebraska?  eg if i have a <tt>Dockerfile</tt><br/>
<span style="color: #16569E"><span style="font-size: small">(16:12:51)</span> <b>edquist:</b></span> (or whom do i need to ask?)<br/>
<span style="color: #53b759"><span style="font-size: small">(16:12:54)</span> <b>marian:</b></span> yeah, I get you access to <a href="http://gracc.opensciencegrid.org">gracc.opensciencegrid.org</a> … there we should setup docker …<br/>
<span style="color: #53b759"><span style="font-size: small">(16:13:41)</span> <b>marian:</b></span> but need to run pick you other son from daycare so may do it later … maybe @kretzke or @dweitzel can give you access? but be warned this is also production gracc host!<br/>
<span style="color: #53b759"><span style="font-size: small">(16:14:01)</span> <b>marian:</b></span> oh, actually we have also hcc-grace-itb<br/>
<span style="color: #53b759"><span style="font-size: small">(16:14:15)</span> <b>marian:</b></span> that one is el7<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:14:18)</span> <b>kretzke:</b></span> yeah, that or fermicloud for dev/testing<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:14:20)</span> <b>dweitzel:</b></span> @marian I don't have access to hcc-grac-itb<br/>
<span style="color: #53b759"><span style="font-size: small">(16:14:24)</span> <b>marian:</b></span> you can use that<br/>
<span style="color: #16569E"><span style="font-size: small">(16:14:37)</span> <b>edquist:</b></span> i'm fine with fermicloud too<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:14:42)</span> <b>kretzke:</b></span> or install docker on your laptop<br/>
<span style="color: #53b759"><span style="font-size: small">(16:14:43)</span> <b>marian:</b></span> ah, right, it’s really fresh host … will add you guys but I need to run now …<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:14:44)</span> <b>bbockelm:</b></span> It's not a big pain. Just email John Gordon; he'll redirect.<br/>
<span style="color: #16569E"><span style="font-size: small">(16:14:46)</span> <b>edquist:</b></span> lol<br/>
<span style="color: #53b759"><span style="font-size: small">(16:14:53)</span> <b>marian:</b></span> I’ll be back online at 5:15<br/>
<span style="color: #53b759"><span style="font-size: small">(16:15:04)</span> <b>marian:</b></span> John’s email?<br/>
<span style="color: #53b759"><span style="font-size: small">(16:15:12)</span> <b>marian:</b></span> ttyl guys …<br/>
<span style="color: #16569E"><span style="font-size: small">(16:15:24)</span> <b>edquist:</b></span> later<br/>
<span style="color: #16569E"><span style="font-size: small">(16:15:25)</span> <b>edquist:</b></span> <a href="mailto:john.gordon@stfc.ac.uk">john.gordon@stfc.ac.uk</a><br/>
<span style="color: #53b759"><span style="font-size: small">(16:15:34)</span> <b>marian:</b></span> hcc-grace-itb is on Anvil … btw<br/>
<span style="color: #53b759"><span style="font-size: small">(16:15:51)</span> <b>marian:</b></span> Derek, you might get in there regardless maybe?<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:16:01)</span> <b>dweitzel:</b></span> nope, can't without ssh key adding to the instance.<br/>
<span style="color: #16569E"><span style="font-size: small">(16:16:14)</span> <b>edquist:</b></span> i'm fine with fermicloud for now<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:16:21)</span> <b>dweitzel:</b></span> go ahead with fermicloud<br/>
<span style="color: #53b759"><span style="font-size: small">(16:16:34)</span> <b>marian:</b></span> ok, test your stuff there and tomorrow without rush I’ll prepare ground<br/>
<span style="color: #235e5b"><span style="font-size: small">(16:16:34)</span> <b>dweitzel:</b></span> if it's in docker, it will be easy to move over.<br/>
<span style="color: #16569E"><span style="font-size: small">(16:16:37)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(16:16:51)</span> <b>edquist:</b></span> one less new thing to worry about  :stuck_out_tongue:<br/>
<span style="color: #16569E"><span style="font-size: small">(16:17:16)</span> <b>edquist:</b></span> man do i not like the \:\-\p emoticons in slack<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:21:33)</span> <b>bbockelm:</b></span> Alright, I shot off an email to some other old APEL contacts I had to see if they knew who I should chat with. One is the manager of a different department now at RAL, so she should at least respond.<br/>
<span style="color: #16569E"><span style="font-size: small">(16:22:03)</span> <b>edquist:</b></span> nice<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:22:26)</span> <b>bbockelm:</b></span> I have a few emails from her about APEL from 2012 ... and this week about CVMFS.<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:22:40)</span> <b>bbockelm:</b></span> Apparently, we recycle people, not software.<br/>
<span style="color: #902d59"><span style="font-size: small">(16:23:28)</span> <b>tanya:</b></span> sorry,  I've missed that conversation<br/>
<span style="color: #902d59"><span style="font-size: small">(16:23:36)</span> <b>tanya:</b></span> what's wrong with John Grodon<br/>
<span style="color: #902d59"><span style="font-size: small">(16:23:40)</span> <b>tanya:</b></span> and his team<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:23:43)</span> <b>bbockelm:</b></span> Isn't he retired?<br/>
<span style="color: #902d59"><span style="font-size: small">(16:23:48)</span> <b>tanya:</b></span> no, he is back<br/>
<span style="color: #902d59"><span style="font-size: small">(16:23:53)</span> <b>tanya:</b></span> all his group left<br/>
<span style="color: #902d59"><span style="font-size: small">(16:24:02)</span> <b>tanya:</b></span> and he needed to come up to create a new group<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:24:09)</span> <b>bbockelm:</b></span> He was close to retirement last I checked....<br/>
<span style="color: #902d59"><span style="font-size: small">(16:24:19)</span> <b>tanya:</b></span> yes, he tried it once<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:24:39)</span> <b>bbockelm:</b></span> :) great!  Makes things simpler for us.<br/>
<span style="color: #902d59"><span style="font-size: small">(16:24:41)</span> <b>tanya:</b></span> i've just got email from him today<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:24:52)</span> <b>bbockelm:</b></span> For future reference - I'm going to stay retired ;)<br/>
<span style="color: #902d59"><span style="font-size: small">(16:24:56)</span> <b>tanya:</b></span> yes, send it to him<br/>
<span style="color: #16569E"><span style="font-size: small">(16:24:59)</span> <b>edquist:</b></span> aww<br/>
<span style="color: #902d59"><span style="font-size: small">(16:25:10)</span> <b>tanya:</b></span> then you have to gather a right team<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:25:45)</span> <b>kretzke:</b></span> @bbockelm you have to actually retire first, good luck getting “them” to let you<br/>
<span style="color: #16569E"><span style="font-size: small">(16:26:46)</span> <b>edquist:</b></span> does anybody know what the package name is to install docker on an el7 node ?<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:27:36)</span> <b>kretzke:</b></span> I think it’s just “docker” from the extras repo. or go to docker’s repo <a href="https://docs.docker.com/engine/installation/linux/centos/">https://docs.docker.com/engine/installation/linux/centos/</a><br/>
<span style="color: #16569E"><span style="font-size: small">(16:28:34)</span> <b>edquist:</b></span> is it preferred to install/enable the extras repo or docker's?<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:28:35)</span> <b>bbockelm:</b></span> Hey, I said "future" ;)<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:29:05)</span> <b>bbockelm:</b></span> This is a really simple case; doesn't really matter which repo.<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:29:14)</span> <b>kretzke:</b></span> I go to docker, extras is a couple versions behind. but yeah<br/>
<span style="color: #16569E"><span style="font-size: small">(16:29:22)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:29:48)</span> <b>kretzke:</b></span> I have a fermicloud you can test on with docker already, want to use that?<br/>
<span style="color: #16569E"><span style="font-size: small">(16:30:30)</span> <b>edquist:</b></span> uh sure<br/>
<span style="color: #16569E"><span style="font-size: small">(16:30:40)</span> <b>edquist:</b></span> i'm edquist@FNAL.GOV<br/>
<span style="color: #16569E"><span style="font-size: small">(16:31:01)</span> <b>edquist:</b></span> really i just want to get a yum .repo file  :stuck_out_tongue:<br/>
<span style="color: #16569E"><span style="font-size: small">(16:31:11)</span> <b>edquist:</b></span> that i can use to install docker...<br/>
<span style="color: #16569E"><span style="font-size: small">(16:31:20)</span> <b>edquist:</b></span> but sure i'll use your vm<br/>
<span style="color: #16569E"><span style="font-size: small">(16:31:40)</span> <b>edquist:</b></span> "sharing is caring" tm<br/>
<span style="color: #16569E"><span style="font-size: small">(16:32:24)</span> <b>edquist:</b></span> the links on the Docker for CentOS page led me to a broken page<br/><a href="https://docs.docker.com/engine/installation/linux/centos.md">https://docs.docker.com/engine/installation/linux/centos.md</a><br/>
<span style="color: #16569E"><span style="font-size: small">(16:34:03)</span> <b>edquist:</b></span> mmm maybe i got it here...<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:35:45)</span> <b>kretzke:</b></span> try edquist@fermicloud080<br/>
<span style="color: #16569E"><span style="font-size: small">(16:49:08)</span> <b>edquist:</b></span> ...<br/>
<span style="color: #16569E"><span style="font-size: small">(16:49:09)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(16:49:15)</span> <b>edquist:</b></span> and... um<br/>
<span style="color: #16569E"><span style="font-size: small">(16:49:16)</span> <b>edquist:</b></span> then?<br/>
<span style="color: #16569E"><span style="font-size: small">(16:49:18)</span> <b>edquist:</b></span> :slightly_smiling_face:<br/>
<span style="color: #16569E"><span style="font-size: small">(16:49:34)</span> <b>edquist:</b></span> sorry, docker-newb here<br/>
<span style="color: #16569E"><span style="font-size: small">(16:49:59)</span> <b>edquist:</b></span> assuming i have a Dockerfile somewhere...<br/>
<span style="color: #43761b"><span style="font-size: small">(16:51:33)</span> <b>blin:</b></span> you're going to want to start with <tt>docker build &lt;dir containing Dockerfile&gt;</tt><br/>
<span style="color: #16569E"><span style="font-size: small">(16:51:45)</span> <b>edquist:</b></span> great<br/>
<span style="color: #16569E"><span style="font-size: small">(16:51:49)</span> <b>edquist:</b></span> that is something!  :slightly_smiling_face:<br/>
<span style="color: #43761b"><span style="font-size: small">(16:53:50)</span> <b>blin:</b></span> oh, you probably want to specify <tt>-t &lt;name&gt;</tt> to give the image a name<br/>
<span style="color: #43761b"><span style="font-size: small">(16:54:35)</span> <b>blin:</b></span> i've got a few basic commands/dockerfile here to remind me how to set up an interactive image: <a href="https://github.com/brianhlin/docker-osg-interactive">https://github.com/brianhlin/docker-osg-interactive</a><br/>
<span style="color: #16569E"><span style="font-size: small">(16:57:00)</span> <b>edquist:</b></span> is <tt>CMD /bin/bash</tt> necessary?<br/>
<span style="color: #16569E"><span style="font-size: small">(16:58:32)</span> <b>edquist:</b></span> once i build an image, how do i connect?<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:59:03)</span> <b>kretzke:</b></span> <tt>docker run -it &lt;name&gt;</tt><br/>
<span style="color: #16569E"><span style="font-size: small">(16:59:23)</span> <b>edquist:</b></span> is there a place i can find the tag?<br/>
<span style="color: #16569E"><span style="font-size: small">(16:59:43)</span> <b>edquist:</b></span> or did i need to specify it with <tt>-t tag</tt> ?<br/>
<span style="color: #3c8c69"><span style="font-size: small">(16:59:44)</span> <b>kretzke:</b></span> it’s what you specified with <tt>-t</tt> in build<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:00:25)</span> <b>kretzke:</b></span> try <tt>docker run -it --rm centos:7</tt><br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:01:24)</span> <b>kretzke:</b></span> (<tt>--rm</tt> will delete the container once the process is done, which in this case means exiting from bash)<br/>
<span style="color: #16569E"><span style="font-size: small">(17:02:01)</span> <b>edquist:</b></span> ah, and <tt>centos:7</tt> is the default tag name, since i have <tt>FROM centos:7</tt> ?<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:02:21)</span> <b>kretzke:</b></span> no, it was just meant as an example<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:02:42)</span> <b>kretzke:</b></span> … before you go trying to run your own image<br/>
<span style="color: #16569E"><span style="font-size: small">(17:02:59)</span> <b>edquist:</b></span> ah, that one's not mine then :slightly_smiling_face:<br/>
<span style="color: #16569E"><span style="font-size: small">(17:03:19)</span> <b>edquist:</b></span> not sure how do get a handle on (or delete) the one i made w/o a tag<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:03:31)</span> <b>kretzke:</b></span> <tt>docker ps -a</tt><br/>
<span style="color: #16569E"><span style="font-size: small">(17:03:49)</span> <b>edquist:</b></span> nothin<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:04:01)</span> <b>kretzke:</b></span> oh, you mean the image… <tt>docker images</tt><br/>
<span style="color: #16569E"><span style="font-size: small">(17:04:14)</span> <b>edquist:</b></span> ah<br/>
<span style="color: #16569E"><span style="font-size: small">(17:04:15)</span> <b>edquist:</b></span> yes<br/>
<span style="color: #16569E"><span style="font-size: small">(17:04:16)</span> <b>edquist:</b></span> thx<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:04:33)</span> <b>kretzke:</b></span> then <tt>docker rmi &lt;ID&gt;</tt><br/>
<span style="color: #16569E"><span style="font-size: small">(17:04:54)</span> <b>edquist:</b></span> bingo<br/>
<span style="color: #16569E"><span style="font-size: small">(17:05:15)</span> <b>edquist:</b></span> is <tt>rmi</tt> the same as <tt>run -it --rm</tt> ?<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:05:46)</span> <b>kretzke:</b></span> no, rmi deletes an image. <tt>--rm</tt> deletes the container, that is the instance of the image<br/>
<span style="color: #16569E"><span style="font-size: small">(17:05:54)</span> <b>edquist:</b></span> mmm<br/>
<span style="color: #16569E"><span style="font-size: small">(17:05:57)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(17:05:58)</span> <b>edquist:</b></span> thanks<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:06:06)</span> <b>kretzke:</b></span> <tt>docker rm</tt> is the command for containers<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:07:07)</span> <b>kretzke:</b></span> <pre>[kretzke@fermicloud080 ~]$ docker run centos:7<br/>[kretzke@fermicloud080 ~]$ docker ps<br/>CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS              PORTS               NAMES<br/>fe5ec6001a4d        6ee1cf8d4464        "/bin/bash"         About a minute ago   Up About a minute                       boring_jang<br/>[kretzke@fermicloud080 ~]$ docker rm -f fe5ec6001a4d<br/>fe5ec6001a4d<br/>[kretzke@fermicloud080 ~]$ docker ps<br/>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES<br/></pre><br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:07:41)</span> <b>kretzke:</b></span> oh shoot, that was yours wasn’t it…<br/>
<span style="color: #43761b"><span style="font-size: small">(17:07:46)</span> <b>blin:</b></span> hahahaha<br/>
<span style="color: #43761b"><span style="font-size: small">(17:09:11)</span> <b>blin:</b></span> sorry, carry on, i have nothing to contribute :upside_down_face:<br/>
<span style="color: #16569E"><span style="font-size: small">(17:10:03)</span> <b>edquist:</b></span> \:D<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:10:05)</span> <b>kretzke:</b></span> suppose that’s one downside of docker I hadn’t actually considered before<br/>
<span style="color: #16569E"><span style="font-size: small">(17:10:12)</span> <b>edquist:</b></span> what's that?<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:10:18)</span> <b>kretzke:</b></span> stomping on other users<br/>
<span style="color: #16569E"><span style="font-size: small">(17:10:27)</span> <b>edquist:</b></span> hm<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:10:29)</span> <b>kretzke:</b></span> I mean, that was a lesson in the downside of docker :slightly_smiling_face:<br/>
<span style="color: #16569E"><span style="font-size: small">(17:10:42)</span> <b>edquist:</b></span> well i should prolly get this up on my own vm<br/>
<span style="color: #3c8c69"><span style="font-size: small">(17:11:03)</span> <b>kretzke:</b></span> if you want. I’m not using it right now<br/>
<span style="color: #16569E"><span style="font-size: small">(17:11:15)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(17:11:24)</span> <b>edquist:</b></span> thanks, this is all helpful<br/>
<span style="color: #53b759"><span style="font-size: small">(17:30:13)</span> <b>marian:</b></span> Carl, you can also get me your keys ... I'll be preparing ground to run in docker with DN we'll use for production gracc instance ... I'm online for bit ... will continue tomorrow ... that of course doesn't stop you until I'm done with stuff ... you just need to test your script first I suppose ... DN part will be deploy that ssm thing to push stuff into apel ... gonna write John Gordon how about to register our DN ... anybody knows what DN we used up to know to push stuff to apel?<br/>
<span style="color: #53b759"><span style="font-size: small">(17:32:09)</span> <b>marian:</b></span> ah, reading rest of emails now ... well if we have all in our container and DN registered we can push stuff directly, no need to copy over to UI ...<br/>
<span style="color: #53b759"><span style="font-size: small">(17:33:31)</span> <b>marian:</b></span> Scott did shutdown his generator he said anyway and waiting for your file as input to send over... (whatever it means, generator)<br/>
<span style="color: #9e3997"><span style="font-size: small">(17:35:59)</span> <b>bbockelm:</b></span> <b>@edquist</b> - as you are exploring, you'll need a DockerHub account so you can publish an image.  For reproducibility, take the route of Dockerfile + automated build.<br/>
<span style="color: #16569E"><span style="font-size: small">(17:41:07)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #16569E"><span style="font-size: small">(17:41:13)</span> <b>edquist:</b></span> thanks @bbockelm<br/>
<span style="color: #16569E"><span style="font-size: small">(17:44:04)</span> <b>edquist:</b></span> by the way, @marian et al, while we of course want to get the entire process running at Nebraska in a docker image at some point, we can still make the Apr 25 deadline without all the apel cert stuff, since we can push the files back to iu via jump in the mean time<br/>
<span style="color: #53b759"><span style="font-size: small">(17:45:37)</span> <b>marian:</b></span> Sure!<br/>
<span style="color: #16569E"><span style="font-size: small">(18:53:16)</span> <b>edquist:</b></span> @bbockelm, et al, it strikes me as fairly sketchy to put a passphraseless ssh private key into a public docker image<br/>
<span style="color: #16569E"><span style="font-size: small">(18:53:28)</span> <b>edquist:</b></span> to get into jump<br/>
<span style="color: #16569E"><span style="font-size: small">(18:53:31)</span> <b>edquist:</b></span> is this really what we want to do?<br/>
<span style="color: #16569E"><span style="font-size: small">(18:53:56)</span> <b>edquist:</b></span> (the answer must be no, my thought tells me)<br/>
<span style="color: #16569E"><span style="font-size: small">(18:56:03)</span> <b>edquist:</b></span> it's more convenient to include it, but that would give anyone access to publish the apel reports (as well as access to whatever else is visible from me@jump)<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:17:40)</span> <b>bbockelm:</b></span> <b>@edquist</b>: Nah - you include it as a volume mount<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:18:10)</span> <b>bbockelm:</b></span> So it comes from outside the container, like we'll do with the service certificate.<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:18:53)</span> <b>bbockelm:</b></span> Puppet (or Kubernetes or ...) on the host traditionally takes care of secret management.<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:19:40)</span> <b>bbockelm:</b></span> It's also traditional to specify things like endpoints and host names as env vars that the container gets<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:26:47)</span> <b>bbockelm:</b></span> Example from Kevin's repo: <a href="https://github.com/retzkek/gracc-dev/blob/master/docker-compose.yaml">https://github.com/retzkek/gracc-dev/blob/master/docker-compose.yaml</a><br/>
<span style="color: #16569E"><span style="font-size: small">(19:31:04)</span> <b>edquist:</b></span> ah<br/>
<span style="color: #16569E"><span style="font-size: small">(19:31:19)</span> <b>edquist:</b></span> *fwew*<br/>
<span style="color: #16569E"><span style="font-size: small">(19:31:43)</span> <b>edquist:</b></span> ok i can sleep at night again  :slightly_smiling_face:<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:32:13)</span> <b>bbockelm:</b></span> :) we won't make you do anything too _obviously_ dumb!<br/>
<span style="color: #16569E"><span style="font-size: small">(19:33:08)</span> <b>edquist:</b></span> &gt; uhhhh guyyyyyyyyys ?<br/>
<span style="color: #16569E"><span style="font-size: small">(19:33:14)</span> <b>edquist:</b></span> :wink:<br/>
<span style="color: #16569E"><span style="font-size: small">(19:33:40)</span> <b>edquist:</b></span> so for the env vars<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:33:49)</span> <b>bbockelm:</b></span> (Subtle stupidities is my specialty!)<br/>
<span style="color: #16569E"><span style="font-size: small">(19:34:03)</span> <b>edquist:</b></span> ah, the best (and worst?) kind<br/>
<span style="color: #16569E"><span style="font-size: small">(19:34:24)</span> <b>edquist:</b></span> the container just runs with those env vars set then?<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:36:01)</span> <b>bbockelm:</b></span> Yup - here's a good example: <a href="https://matthiasadler.info/blog/running-scheduled-tasks-in-docker-containers-with-systemd/">https://matthiasadler.info/blog/running-scheduled-tasks-in-docker-containers-with-systemd/</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(19:45:52)</span> <b>bbockelm:</b></span> A systemd timer will kick off the Docker container; that file will provide the env vars you need to function.<br/>
<span style="color: #16569E"><span style="font-size: small">(19:47:18)</span> <b>edquist:</b></span> fancy<br/>
<span style="color: #16569E"><span style="font-size: small">(19:48:07)</span> <b>edquist:</b></span> so the systemd timer will serve the purpose of what would otherwise be a cron job inside the container?<br/>
<span style="color: #16569E"><span style="font-size: small">(19:49:12)</span> <b>edquist:</b></span> (i mean, instead of just leaving the docker container running as a service)<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:49:14)</span> <b>bbockelm:</b></span> Yup.  The host systemd launches the container, the script runs, and then it shuts off<br/>
<span style="color: #16569E"><span style="font-size: small">(19:49:31)</span> <b>edquist:</b></span> neato<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:50:57)</span> <b>bbockelm:</b></span> Kevin might have some experience on the pros / cons of the two approaches, but I think the transient container is better for single-shot scripts. The other things we have in a persistent container are more along the lines of daemons<br/>
<span style="color: #16569E"><span style="font-size: small">(19:51:30)</span> <b>edquist:</b></span> makes sense<br/>
<span style="color: #16569E"><span style="font-size: small">(19:52:19)</span> <b>edquist:</b></span> i guess the only downside for single-shot is if you wanted logging<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:55:04)</span> <b>bbockelm:</b></span> erm... no, you don't get to skip logging.  stdout gets routed to journal.<br/>
<span style="color: #16569E"><span style="font-size: small">(19:56:24)</span> <b>edquist:</b></span> the output of whatever <tt>CMD</tt> runs, you mean?<br/>
<span style="color: #16569E"><span style="font-size: small">(19:57:22)</span> <b>edquist:</b></span> (the <tt>CMD</tt> line in the Dockerfile)<br/>
<span style="color: #16569E"><span style="font-size: small">(19:57:45)</span> <b>edquist:</b></span> well that's cool<br/>
<span style="color: #16569E"><span style="font-size: small">(19:57:49)</span> <b>edquist:</b></span> glad it goes somewhere<br/>
<span style="color: #9e3997"><span style="font-size: small">(19:58:20)</span> <b>bbockelm:</b></span> yup<br/>
<span style="color: #16569E"><span style="font-size: small">(20:01:58)</span> <b>edquist:</b></span> are .ssh/{config,known_hosts} something normally put into the image, or are those usually bind-mounted also?<br/>
<span style="color: #9e3997"><span style="font-size: small">(20:03:37)</span> <b>bbockelm:</b></span> I would put <tt>known_hosts</tt> in a bind mount (or a <tt>COPY</tt> statement of some sort) and explicitly put in flags instead of <tt>config</tt>.<br/>
<span style="color: #16569E"><span style="font-size: small">(20:04:40)</span> <b>edquist:</b></span> ok<br/>
<span style="color: #9e3997"><span style="font-size: small">(20:09:49)</span> <b>bbockelm:</b></span> <a href="https://github.com/composer/docker/issues/10">https://github.com/composer/docker/issues/10</a> here's an example of how to add configs to SSH.<br/>
<span style="color: #9e3997"><span style="font-size: small">(20:18:02)</span> <b>bbockelm:</b></span> so, I guess the end-goal is to have you provide a Docker image and a one-liner to run the docker image. You'll probably want to use the <tt>--env-file</tt> and the <tt>--user</tt> flags in the command line.<br/>
<span style="color: #16569E"><span style="font-size: small">(20:18:15)</span> <b>edquist:</b></span> really there's just a single entry needed in <tt>known_hosts</tt><br/>
<span style="color: #16569E"><span style="font-size: small">(20:20:10)</span> <b>edquist:</b></span> @bbockelm, you know your technique is genius.  Lead the newb to believe that the task is simple, so he doesn't get discouraged, and then gennnnnntly ease in all the uneasy details  :wink:<br/>
<span style="color: #9e3997"><span style="font-size: small">(20:21:42)</span> <b>bbockelm:</b></span> slowly but surely, we'll start living in the future!<br/>
<span style="color: #16569E"><span style="font-size: small">(20:24:28)</span> <b>edquist:</b></span> Glorious...<br/>
<span style="color: #16569E"><span style="font-size: small">(20:24:38)</span> <b>edquist:</b></span> Well i'm out for tonight ... time to go home<br/>
<span style="color: #9e3997"><span style="font-size: small">(20:24:46)</span> <b>bbockelm:</b></span> sounds good, catch you tomorrow!<br/>
<span style="color: #16569E"><span style="font-size: small">(20:25:03)</span> <b>edquist:</b></span> Roger  :slightly_smiling_face:<br/>
<span style="color: #9e3997"><span style="font-size: small">(21:02:11)</span> <b>bbockelm:</b></span> @kretzke - something for tomorrow: noticed <tt>gracc-collector</tt> isn't an automated build.  We should probably move all the stuff in the docker compose for GRACC to the opensciencegrid org on DockerHub.<br/>
</body>
</html>
