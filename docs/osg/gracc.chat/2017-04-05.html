<!DOCTYPE html>
<html>
<head>
<title>Wed Apr 5, 2017 : #gracc (osg)</title>
</head>
<body>
<h3>Wed Apr 5, 2017 : #gracc (osg)</h3>
<span style="color: #9e3997"><span style="font-size: small">(08:21:00)</span> <b>bbockelm:</b></span> <b>@edquist</b> - if the graphs are what we want now, can we please file a GOC ticket to get the OSG Display updated?  :confused: I don't see a new RPM in Koji?<br/>
<span style="color: #16569E"><span style="font-size: small">(11:33:01)</span> <b>edquist:</b></span> @bbockelm, as mentioned in GRACC-18, it turns out that the transfers hourly graphs still get their data from gratia (defined in transfer_datasource.py instead of gratia_datasource.py) i'm working on updating that now also<br/>
<span style="color: #16569E"><span style="font-size: small">(11:34:03)</span> <b>edquist:</b></span> ... also perhaps worth remembering is that the goc will have to update the osg display instance to el7<br/>
<span style="color: #9e3997"><span style="font-size: small">(11:52:43)</span> <b>bbockelm:</b></span> Well I suppose it's a good time to file the ticket to get an EL7 display-itb setup?<br/>
<span style="color: #16569E"><span style="font-size: small">(11:59:36)</span> <b>edquist:</b></span> sure<br/>
<span style="color: #16569E"><span style="font-size: small">(13:14:57)</span> <b>edquist:</b></span> <a href="https://ticket.grid.iu.edu/33354">https://ticket.grid.iu.edu/33354</a><br/>
<span style="color: #16569E"><span style="font-size: small">(13:28:22)</span> <b>edquist:</b></span> did something change in the gracc data today?<br/><br/>starting today, i've been seeing this error<br/><pre><br/>TypeError: unsupported operand type(s) for +: 'float' and 'Decimal'<br/></pre><br/>even, using the same queries as yesterday, where some values come back with type 'float' and some as 'decimal.Decimal'<br/>
<span style="color: #16569E"><span style="font-size: small">(13:28:58)</span> <b>edquist:</b></span> (it blows up in <tt>sum()</tt>, which tries to add values of these different types)<br/>
<span style="color: #235e5b"><span style="font-size: small">(13:30:51)</span> <b>dweitzel:</b></span> Nope, I haven't made any changes today.<br/>
<span style="color: #3c8c69"><span style="font-size: small">(13:42:28)</span> <b>kretzke:</b></span> <b>@edquist</b> which queries? which indices?<br/>
<span style="color: #16569E"><span style="font-size: small">(13:51:34)</span> <b>edquist:</b></span> let me get back on that, i'll try to isolate them<br/>
<span style="color: #16569E"><span style="font-size: small">(14:00:41)</span> <b>edquist:</b></span> weirdly it is the for the transfers hourly graphs -- but it happens whether it comes from gratia or gracc<br/>
<span style="color: #16569E"><span style="font-size: small">(14:01:00)</span> <b>edquist:</b></span> :thinking_face:<br/>
<span style="color: #16569E"><span style="font-size: small">(14:01:15)</span> <b>edquist:</b></span> just started showing up today, even when running older code<br/>
<span style="color: #16569E"><span style="font-size: small">(14:06:43)</span> <b>edquist:</b></span> the <tt>results</tt> returned here<br/><a href="https://github.com/edquist/osg-display-data/blob/master/src/osg_display/transfer_datasource.py#L194">https://github.com/edquist/osg-display-data/blob/master/src/osg_display/transfer_datasource.py#L194</a><br/><br/>end up being<br/><pre><br/>get_data results:<br/>(284282.0, 16099442.110089302)<br/>(Decimal('284802'), 16116517.555617446)<br/>(Decimal('266239'), 21113774.065913036)<br/>(143238.0, 11956788.16060543)<br/>(Decimal('143922'), 11958504.531914176)<br/>(Decimal('167109'), 10966998.924127834)<br/>(215556.0, 14682329.486703873)<br/>(196461.0, 22377020.082502365)<br/>(Decimal('197179'), 22354437.89480994)<br/>(Decimal('247946'), 16440654.355035136)<br/>(Decimal('477926'), 13793505.873455986)<br/>(460742.0, 42305604.534523964)<br/>(281711.0, 46523466.01887703)<br/>(Decimal('282140'), 46523442.19906442)<br/>(189073.0, 19203831.953855515)<br/>(Decimal('189615'), 19293521.55451408)<br/>(Decimal('214392'), 15166206.547985664)<br/>(263299.0, 12278972.045773506)<br/>(163263.0, 9507429.661224365)<br/>(147449.0, 26369804.14676094)<br/>(Decimal('148011'), 26370866.191707395)<br/>(Decimal('219386'), 25251460.805017065)<br/>(Decimal('232532'), 23508898.629626103)<br/>(Decimal('320957'), 24352130.73688784)<br/>(Decimal('230769'), 26256969.662473507)<br/></pre><br/>
<span style="color: #16569E"><span style="font-size: small">(14:06:53)</span> <b>edquist:</b></span> kind of odd<br/>
<span style="color: #16569E"><span style="font-size: small">(14:07:28)</span> <b>edquist:</b></span> osg-display-data doesn't even use <tt>Decimal</tt> anywhere<br/>
<span style="color: #235e5b"><span style="font-size: small">(14:07:51)</span> <b>dweitzel:</b></span> new python version doing something weird?<br/>
<span style="color: #16569E"><span style="font-size: small">(14:14:52)</span> <b>edquist:</b></span> not sure...  That first field is a count, so in theory it should be an int.  It always comes back as either a <tt>float</tt> ending in <tt>.0</tt> or a <tt>Decimal</tt> .  No idea why the new behavior.  Kinda weird timing.  Anyway i can work around it by just casting the type (eg to an <tt>int</tt>)<br/>
<span style="color: #16569E"><span style="font-size: small">(14:20:58)</span> <b>edquist:</b></span> @dweitzel, by the way, do we care about this warning?<br/><pre><br/>No handlers could be found for logger "elasticsearch.trace"<br/></pre><br/>
<span style="color: #235e5b"><span style="font-size: small">(14:21:23)</span> <b>dweitzel:</b></span> Eh. Probably not. <br/>
<span style="color: #16569E"><span style="font-size: small">(14:36:22)</span> <b>edquist:</b></span> Ok, i have pushed my transfer_datasource.py changes now also, and the graphs are looking pretty similar<br/><br/><a href="https://raw.githubusercontent.com/edquist/osg-display-data/images/out-gratia/transfers_hourly.png">https://raw.githubusercontent.com/edquist/osg-display-data/images/out-gratia/transfers_hourly.png</a><br/><a href="https://raw.githubusercontent.com/edquist/osg-display-data/images/out-gracc/transfers_hourly.png">https://raw.githubusercontent.com/edquist/osg-display-data/images/out-gracc/transfers_hourly.png</a><br/><br/><a href="https://raw.githubusercontent.com/edquist/osg-display-data/images/out-gracc/transfer_volume_hourly.png">https://raw.githubusercontent.com/edquist/osg-display-data/images/out-gracc/transfer_volume_hourly.png</a><br/><a href="https://raw.githubusercontent.com/edquist/osg-display-data/images/out-gratia/transfer_volume_hourly.png">https://raw.githubusercontent.com/edquist/osg-display-data/images/out-gratia/transfer_volume_hourly.png</a><br/>
<span style="color: #235e5b"><span style="font-size: small">(15:57:56)</span> <b>dweitzel:</b></span> eh, close enough :slightly_smiling_face:<br/>
<span style="color: #16569E"><span style="font-size: small">(16:05:00)</span> <b>edquist:</b></span> yeah, the scale/axis values are all the same, and the graphs tell the same story at least.  As mentioned somewhere earlier, i think there might be some discrepancy because we use <tt>StartTime</tt> instead of <tt>received</tt> (aka <tt>ServerDate</tt> in gratia) ... but fairly close<br/>
<span style="color: #16569E"><span style="font-size: small">(16:06:37)</span> <b>edquist:</b></span> i've tried out an actual koji (scratch) build and so far everything looks good<br/><br/><a href="https://koji.chtc.wisc.edu/koji/taskinfo?taskID=234164">https://koji.chtc.wisc.edu/koji/taskinfo?taskID=234164</a><br/><a href="http://koji.chtc.wisc.edu/kojifiles/work/tasks/4164/234164/osg-display-data-1.1.0-1.osg33.el7.noarch.rpm">http://koji.chtc.wisc.edu/kojifiles/work/tasks/4164/234164/osg-display-data-1.1.0-1.osg33.el7.noarch.rpm</a><br/>
<span style="color: #16569E"><span style="font-size: small">(17:51:33)</span> <b>edquist:</b></span> I made a PR for this based on a cleaned up branch:<br/><a href="https://github.com/opensciencegrid/osg-display-data/pull/1">https://github.com/opensciencegrid/osg-display-data/pull/1</a><br/><br/>(The original GRACC-18 branch (<a href="https://github.com/opensciencegrid/osg-display-data/compare/master...edquist:GRACC-18">https://github.com/opensciencegrid/osg-display-data/compare/master...edquist:GRACC-18</a>) had a lot more WIP commits.)<br/><br/>@bbockelm or @dweitzel, feel free to give it a once-over before I cut a new version.<br/>
</body>
</html>
