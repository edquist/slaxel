<!DOCTYPE html>
<html>
<head>
<title>Tue Mar 31, 2020 : #open-science-ce (osg)</title>
</head>
<body>
<h3>Tue Mar 31, 2020 : #open-science-ce (osg)</h3>
<span style="color: #43761b"><span style="font-size: small">(10:46:13)</span> <b>blin:</b></span> set the channel description: Making OSG VO pool resources available via HTCondor-CE<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:51:58)</span> <b>bbockelm:</b></span> :wave: hi all!  So, what's the plan?<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:52:19)</span> <b>bbockelm:</b></span> (I understand that Mat and Brian already had a zoom chat?)<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:52:45)</span> <b>bbockelm:</b></span> Should we have another Zoom chat or is the plan already formed?<br/>
<span style="color: #e96699"><span style="font-size: small">(10:52:52)</span> <b>lincoln:</b></span> hello i have no idea what's going on.<br/>
<span style="color: #9e3997"><span style="font-size: small">(10:53:06)</span> <b>bbockelm:</b></span> :point_up: me in lyfe<br/>
<span style="color: #c386df"><span style="font-size: small">(10:53:48)</span> <b>matyas:</b></span> OK, let me see if I can summarize or if I completely misunderstood what Brian told me :stuck_out_tongue:<br/>
<span style="color: #c386df"><span style="font-size: small">(10:54:22)</span> <b>matyas:</b></span> We want to give ENMR some OSG resources right f'ing now because Coronavirus.<br/>
<span style="color: #c386df"><span style="font-size: small">(10:55:27)</span> <b>matyas:</b></span> They already use a pilot system called DIRAC that they're happy with so they don't want to use OSG-Connect or set up a Glidein frontend (*crosses self*)<br/>
<span style="color: #c386df"><span style="font-size: small">(10:57:14)</span> <b>matyas:</b></span> but they can send pilots wrapped in Condor jobs to a CE, which turns around and submits them via flocking (osg-flock) as Glidein pilots, and that turducken of a job will run on a site under the OSG VO so we don't have to beg sites to add yet another VO to their whitelist<br/>
<span style="color: #c386df"><span style="font-size: small">(10:58:16)</span> <b>matyas:</b></span> What we need is a container/pod (haven't decided which) that's a CE and Submit host living together as roommates<br/>
<span style="color: #c386df"><span style="font-size: small">(10:58:26)</span> <b>matyas:</b></span> and then put it into SLATE<br/>
<span style="color: #c386df"><span style="font-size: small">(10:59:16)</span> <b>matyas:</b></span> @blin will do the CE part, I will do the submit part, and then he will do the SLATE part because we don't have time for me to relearn how HELM works<br/>
<span style="color: #c386df"><span style="font-size: small">(10:59:40)</span> <b>matyas:</b></span> and we don't have to worry about auth on the submit host because it's gonna be single-user<br/>
<span style="color: #c386df"><span style="font-size: small">(10:59:57)</span> <b>matyas:</b></span> am I at least 80% right?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:00:03)</span> <b>blin:</b></span> yeah, that looks good<br/>
<span style="color: #43761b"><span style="font-size: small">(11:00:12)</span> <b>blin:</b></span> except the SLATE bits will be a team effort, i think<br/>
<span style="color: #9e3997"><span style="font-size: small">(11:00:52)</span> <b>bbockelm:</b></span> What's the delta between "I have a working pod" and "it works on SLATE"?  Can we do the slate pieces later to have something working earlier?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:01:32)</span> <b>lincoln:</b></span> let me pull chris into here as well because he did the condor pool stuff in slate<br/>
<span style="color: #43761b"><span style="font-size: small">(11:02:18)</span> <b>blin:</b></span> if we have more hands on deck, i think working pod -&gt; working on SLATE isn't so bad<br/>
<span style="color: #e96699"><span style="font-size: small">(11:02:27)</span> <b>lincoln:</b></span> i'm not sure i understand the confluence of submit/CE/container<br/>
<span style="color: #e96699"><span style="font-size: small">(11:03:09)</span> <b>lincoln:</b></span> where will this run?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:03:27)</span> <b>lincoln:</b></span> and uh what is ENMR<br/>
<span style="color: #43761b"><span style="font-size: small">(11:03:50)</span> <b>blin:</b></span> <a href="https://www.wenmr.eu/about/">https://www.wenmr.eu/about/</a><br/>
<span style="color: #c386df"><span style="font-size: small">(11:03:51)</span> <b>matyas:</b></span> they're a European VO<br/>
<span style="color: #e96699"><span style="font-size: small">(11:03:54)</span> <b>lincoln:</b></span> got it<br/>
<span style="color: #43761b"><span style="font-size: small">(11:04:09)</span> <b>blin:</b></span> let's chat on zoom?<br/>
<span style="color: #43761b"><span style="font-size: small">(11:04:38)</span> <b>blin:</b></span> &gt;  Join Zoom Meeting<br/>&gt; <a href="https://cern.zoom.us/j/197818581?pwd=R1B1NFN3SGtHNUJYeXd2NTlPRWNzQT09">https://cern.zoom.us/j/197818581?pwd=R1B1NFN3SGtHNUJYeXd2NTlPRWNzQT09</a><br/>&gt; <br/>&gt; Meeting ID: 197 818 581<br/>&gt; Password: 404766<br/>&gt; <br/>&gt; One tap mobile<br/>&gt; <a href="tel:+41315280988,,197818581#">+41315280988,,197818581#</a> Switzerland<br/>&gt; <a href="tel:+41432107042,,197818581#">+41432107042,,197818581#</a> Switzerland<br/>&gt; <br/>&gt; Dial by your location<br/>&gt;         <a href="tel:+41315280988">+41 31 528 09 88</a> Switzerland<br/>&gt;         <a href="tel:+41432107042">+41 43 210 70 42</a> Switzerland<br/>&gt;         <a href="tel:+41432107108">+41 43 210 71 08</a> Switzerland<br/>&gt;         <a href="tel:+33170372246">+33 1 7037 2246</a> France<br/>&gt;         <a href="tel:+33170379729">+33 1 7037 9729</a> France<br/>&gt;         <a href="tel:+33756784048">+33 7 5678 4048</a> France<br/>&gt; Meeting ID: 197 818 581<br/>&gt; Find your local number: <a href="https://cern.zoom.us/u/ajNGMwZYz">https://cern.zoom.us/u/ajNGMwZYz</a><br/>&gt; <br/>&gt; Join by SIP<br/>&gt; <a href="mailto:197818581@zoomcrc.com">197818581@zoomcrc.com</a><br/>&gt; <br/>&gt; Join by H.323<br/>&gt; 162.255.37.11 (US West)<br/>&gt; 162.255.36.11 (US East)<br/>&gt; 221.122.88.195 (China)<br/>&gt; 115.114.131.7 (India Mumbai)<br/>&gt; 115.114.115.7 (India Hyderabad)<br/>&gt; 213.19.144.110 (EMEA)<br/>&gt; 103.122.166.55 (Australia)<br/>&gt; 209.9.211.110 (Hong Kong)<br/>&gt; 64.211.144.160 (Brazil)<br/>&gt; 69.174.57.160 (Canada)<br/>&gt; 207.226.132.110 (Japan)<br/>&gt; Meeting ID: 197 818 581<br/>&gt; Password: 404766<br/><br/>
<span style="color: #c386df"><span style="font-size: small">(11:07:03)</span> <b>matyas:</b></span> set the channel topic: The way of the future!<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:08:44)</span> <b>rynge:</b></span> Can't make it right now - Frank wants to talk<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:08:58)</span> <b>rynge:</b></span> But I'll monitor here for what I can do to help<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:10:19)</span> <b>rynge:</b></span> In general, setting up <a href="http://flock.opensciencegrid.org">flock.opensciencegrid.org</a> (central manager) will be quick. We accept GSI or TOKEN auth<br/>
<span style="color: #674b1b"><span style="font-size: small">(11:11:27)</span> <b>rynge:</b></span> Accounting and prioritization might be messy. For now, ensure you have a gratia probe on the schedd<br/>
<span style="color: #e96699"><span style="font-size: small">(11:12:16)</span> <b>lincoln:</b></span> <a href="https://github.com/slateci/slate-catalog/tree/master/incubator/condor-submit/images/condor-submit">https://github.com/slateci/slate-catalog/tree/master/incubator/condor-submit/images/condor-submit</a><br/>
<span style="color: #e96699"><span style="font-size: small">(11:25:15)</span> <b>lincoln:</b></span> ok ive created a new group called <tt>osg-covid19</tt>  in SLATE and invited Brian / Mat / Chris to it if you want to do deployments on RIVER<br/>
<span style="color: #e96699"><span style="font-size: small">(11:32:26)</span> <b>lincoln:</b></span> so there should be both the <tt>osg-covid19</tt> kubernetes credential and namespace on RIVER, which Mat and Brian have creds for ,and separately a SLATE group called osg-covid19 (which will map to slate-group-osg-covid19 on the cluster) for 'production' deployments<br/>
<span style="color: #e96699"><span style="font-size: small">(12:10:09)</span> <b>lincoln:</b></span> i'm going to invite Kenyi in here as well- he's looking at doing something similar for CMS<br/>
<span style="color: #43761b"><span style="font-size: small">(14:08:13)</span> <b>blin:</b></span> @matyas how's progress on the OSG submit host container going?<br/>
<span style="color: #c386df"><span style="font-size: small">(14:13:59)</span> <b>matyas:</b></span> Read through the slate condor-submit image. There's a lot of unrelated stuff in there (like CVMFS) and it doesn't use osg-flock so I think I'll make my own using <a href="https://opensciencegrid.org/docs/submit/osg-flock/">https://opensciencegrid.org/docs/submit/osg-flock/</a> and occasionally steal some stuff from the slate one<br/>
<span style="color: #43761b"><span style="font-size: small">(14:15:33)</span> <b>blin:</b></span> @lincoln @cnweaver what's the difference between appVersion and version in a Chart.yaml?<br/>
<span style="color: #e96699"><span style="font-size: small">(14:20:22)</span> <b>lincoln:</b></span> hm<br/>
<span style="color: #e96699"><span style="font-size: small">(14:20:30)</span> <b>lincoln:</b></span> let me check, because i'm sure I'm wrong.<br/>
<span style="color: #e85d72"><span style="font-size: small">(14:20:44)</span> <b>cnweaver:</b></span> @blin The app version is intended to be the version of the packaged software, while the plain version is that of the chart itself.<br/>
<span style="color: #e96699"><span style="font-size: small">(14:20:59)</span> <b>lincoln:</b></span> oh well there you go then<br/>
<span style="color: #43761b"><span style="font-size: small">(14:21:04)</span> <b>blin:</b></span> ah ok, thanks<br/>
<span style="color: #e96699"><span style="font-size: small">(14:21:08)</span> <b>lincoln:</b></span> sorry I was thinking of something completely different<br/>
<span style="color: #e96699"><span style="font-size: small">(14:21:15)</span> <b>lincoln:</b></span> so I'm glad Chris answered instead :slightly_smiling_face:<br/>
<span style="color: #e85d72"><span style="font-size: small">(14:21:43)</span> <b>cnweaver:</b></span> @matyas What were you looking for in terms of using osg-flock?<br/>
<span style="color: #c386df"><span style="font-size: small">(14:22:54)</span> <b>matyas:</b></span> Following OSG instructions as much as I can so I minimize the nonstandardness<br/>
<span style="color: #e85d72"><span style="font-size: small">(14:24:31)</span> <b>cnweaver:</b></span> Hm, okay. I'm not familiar with the instructions in question; my goal had been to build a general purpose condor submit host rather than anything really tied to OSG. It may not be much use to you, then.<br/>
<span style="color: #e96699"><span style="font-size: small">(14:51:50)</span> <b>lincoln:</b></span> we definitely have a version that submits to flock but it's pretty simple and straightforward with token auth as i recall<br/>
<span style="color: #e96699"><span style="font-size: small">(14:53:12)</span> <b>lincoln:</b></span> <pre><br/># Authentication settings<br/>SEC_DEFAULT_AUTHENTICATION = REQUIRED<br/>SEC_READ_AUTHENTICATION = OPTIONAL<br/>SEC_CLIENT_AUTHENTICATION = OPTIONAL<br/>SEC_DEFAULT_AUTHENTICATION_METHODS = FS, TOKEN<br/>SEC_CLIENT_AUTHENTICATION_METHODS = FS, TOKEN<br/>SEC_DAEMON_AUTHENTICATION_METHODS = TOKEN<br/>SEC_ENABLE_MATCH_PASSWORD_AUTHENTICATION = True<br/><br/>SEC_DAEMON_SESSION_DURATION = 50000</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(14:53:14)</span> <b>lincoln:</b></span> from login04/05<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:53:37)</span> <b>rynge:</b></span> TOKEN is easiest, but requires HTCondor 8.9<br/>
<span style="color: #e96699"><span style="font-size: small">(14:54:10)</span> <b>lincoln:</b></span> yeah doesnt look like the docs are updated to incldue token yet<br/>
<span style="color: #c386df"><span style="font-size: small">(14:56:12)</span> <b>matyas:</b></span> The image will use 8.9 from osg-upcoming<br/>
<span style="color: #e85d72"><span style="font-size: small">(14:56:35)</span> <b>cnweaver:</b></span> Right, that was a deliberate choice to get token support working.<br/>
<span style="color: #c386df"><span style="font-size: small">(14:59:01)</span> <b>matyas:</b></span> Do we care about GSI auth at all?<br/>
<span style="color: #e96699"><span style="font-size: small">(15:00:40)</span> <b>lincoln:</b></span> not unless like, CMS wants to use the same solution, I'd imagine<br/>
<span style="color: #c386df"><span style="font-size: small">(15:02:16)</span> <b>matyas:</b></span> the config we get from the osg-flock RPM is weird<br/>
<span style="color: #43761b"><span style="font-size: small">(15:02:17)</span> <b>blin:</b></span> for the submit side we don't care about GSI<br/>
<span style="color: #c386df"><span style="font-size: small">(15:02:18)</span> <b>matyas:</b></span> <a href="https://vdt.cs.wisc.edu/svn/native/redhat/trunk/osg-flock/osg/80-osg-flocking.conf">https://vdt.cs.wisc.edu/svn/native/redhat/trunk/osg-flock/osg/80-osg-flocking.conf</a><br/>
<span style="color: #c386df"><span style="font-size: small">(15:02:53)</span> <b>matyas:</b></span> there are multiple copies of the "Authentication settings" section and the "Privacy settings" section<br/>
<span style="color: #c386df"><span style="font-size: small">(15:03:17)</span> <b>matyas:</b></span> at first I thought there was something wrong with my terminal :stuck_out_tongue:<br/>
<span style="color: #c386df"><span style="font-size: small">(15:09:39)</span> <b>matyas:</b></span> @lincoln what's the SEC_DAEMON_SESSION_DURATION for?<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:18:08)</span> <b>bbockelm:</b></span> Controls the length of the security session.<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:18:31)</span> <b>bbockelm:</b></span> (but I'm not sure that answers your question)<br/>
<span style="color: #e96699"><span style="font-size: small">(15:19:29)</span> <b>lincoln:</b></span> I don't remember why it's set to that particular value<br/>
<span style="color: #e96699"><span style="font-size: small">(15:19:33)</span> <b>lincoln:</b></span> Mats might :slightly_smiling_face:<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:20:55)</span> <b>rynge:</b></span> Like all things GWMS, it probably came from Igor at some point :)<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:24:14)</span> <b>bbockelm:</b></span> @matyas - let's note the question and move on.  Marching orders are to not pay down technical debt.<br/>
<span style="color: #c386df"><span style="font-size: small">(15:24:19)</span> <b>matyas:</b></span> k<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:24:34)</span> <b>bbockelm:</b></span> (but writing down the existence of technical debt is good)<br/>
<span style="color: #c386df"><span style="font-size: small">(15:24:37)</span> <b>matyas:</b></span> I mean, it's not in the default flock config but it's in what Lincoln pasted. Which one is it?<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:27:16)</span> <b>bbockelm:</b></span> I think you can leave the default.  I do see some notes in the HTCondor code comments about decreasing the value for support for pre-6.6 versions of HTCondor.<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:28:07)</span> <b>rynge:</b></span> That flock rpm will be revisited once 8.9 ships<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:29:00)</span> <b>bbockelm:</b></span> @matyas - actually, this is probably the relevant one: <a href="https://htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=1141">https://htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=1141</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(15:29:22)</span> <b>bbockelm:</b></span> Ah, bingo: <a href="https://htcondor-wiki.cs.wisc.edu/index.cgi/chngview?cn=10069">https://htcondor-wiki.cs.wisc.edu/index.cgi/chngview?cn=10069</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(15:29:54)</span> <b>bbockelm:</b></span> So you don't need to copy that forward unless pre-7.5.0 support is important<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:30:04)</span> <b>rynge:</b></span> Heh<br/>
<span style="color: #c386df"><span style="font-size: small">(15:30:32)</span> <b>matyas:</b></span> lol<br/>
<span style="color: #43761b"><span style="font-size: small">(15:37:23)</span> <b>blin:</b></span> i got the IGTF cert for <a href="http://ce1.opensciencegrid.org">ce1.opensciencegrid.org</a><br/>
<span style="color: #43761b"><span style="font-size: small">(15:37:43)</span> <b>blin:</b></span> so @lincoln just lmk what static IP we'll be using and i can set that up in the OSG DNS<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:38:16)</span> <b>bbockelm:</b></span> Alright - before I disappear back into proposal land: anything I can help with for the next 20 minutes?<br/>
<span style="color: #43761b"><span style="font-size: small">(15:38:55)</span> <b>blin:</b></span> how are we tagging these jobs in the routes? <tt>Project = ENMR</tt>? anything else?<br/>
<span style="color: #43761b"><span style="font-size: small">(15:39:55)</span> <b>blin:</b></span> also i heard through the grape vine that i'm responsible for how we tag COVID-19 jobs so that sites can filter them appropriately?<br/>
<span style="color: #e96699"><span style="font-size: small">(15:43:47)</span> <b>lincoln:</b></span> ProjectName<br/>
<span style="color: #e96699"><span style="font-size: small">(15:44:09)</span> <b>lincoln:</b></span> i think try to get an address from MetalLB and we'll make sure to re-use it a la the HostedCE chart?<br/>
<span style="color: #e96699"><span style="font-size: small">(15:44:23)</span> <b>lincoln:</b></span> I don't really do anything to assign stuff :slightly_smiling_face:<br/>
<span style="color: #c386df"><span style="font-size: small">(15:45:50)</span> <b>matyas:</b></span> @rynge can you give me a token so I can try out the submit host image?<br/>
<span style="color: #43761b"><span style="font-size: small">(15:49:25)</span> <b>blin:</b></span> the way we're going to do this is similar to the hosted CE chart where we have a requested IP. i'll let you know when we're ready so you can give us a free IP to request<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:53:22)</span> <b>bbockelm:</b></span> From their webpage, it seems <tt>ProjectName = "WeNMR"</tt> is likely good.<br/>
<span style="color: #43761b"><span style="font-size: small">(15:55:01)</span> <b>blin:</b></span> how are we going to do COVID-19 prioritization? are we going to handle it all within the OSG VO pool?<br/>
<span style="color: #9e3997"><span style="font-size: small">(15:57:53)</span> <b>bbockelm:</b></span> I thought @rynge and Frank were going to derive a plan today?<br/>
<span style="color: #674b1b"><span style="font-size: small">(15:59:17)</span> <b>rynge:</b></span> Yeah, there is a doc<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:00:00)</span> <b>rynge:</b></span> It is going to be a mini-vo (line in vo package, so sites can use local batch prios), and a special group in the OSG VO frontend<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:00:34)</span> <b>bbockelm:</b></span> ah - really honestly a VO or just a subgroup like LIGO?<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:03:08)</span> <b>rynge:</b></span> Pretty much the same these days. I think of it as a subgroup. Could be done with a voms attribute, or we could have a fully unique cert. What do you think sites would prefer?<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:03:28)</span> <b>rynge:</b></span> I know Miron and Frank wanted to talk further, so this might all change again<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:21:22)</span> <b>bbockelm:</b></span> I think I'd prefer either a VOMS attribute or an arbitrary attribute in the ClassAd.<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:21:58)</span> <b>bbockelm:</b></span> In the perfect world, an arbitrary attribute would be better.  However, I don't think that integrates with GRACC well.<br/>
<span style="color: #9e3997"><span style="font-size: small">(16:49:38)</span> <b>bbockelm:</b></span> oh hey, the current call with Miron and FKW has devolved into this topic.<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:51:26)</span> <b>rynge:</b></span> Good - let me know what gets decided<br/>
<span style="color: #9e3997"><span style="font-size: small">(17:17:34)</span> <b>bbockelm:</b></span> Ok, decision is to have these pilots include a special ClassAd attribute but not a distinct VOMS entry.  We are then going to put together a special documentation page on how to add a specific route.<br/>
<span style="color: #9e3997"><span style="font-size: small">(17:17:51)</span> <b>bbockelm:</b></span> (need to go help with dinner, will be back tonight)<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:22:47)</span> <b>rynge:</b></span> So what would a site which currently do not support OSG VO, and only want COVID19 work do?<br/>
<span style="color: #674b1b"><span style="font-size: small">(17:23:40)</span> <b>rynge:</b></span> Nevermind - got an email from Frank<br/>
<span style="color: #9e3997"><span style="font-size: small">(21:33:19)</span> <b>bbockelm:</b></span> @rynge - I didn't get the email from FKW but here's my first stab at the docs: <a href="https://github.com/opensciencegrid/docs/pull/682">https://github.com/opensciencegrid/docs/pull/682</a><br/>
<span style="color: #9e3997"><span style="font-size: small">(21:34:53)</span> <b>bbockelm:</b></span> (Is there a Slack channel for this?  We ought to get Derek involved in setting up a dashboard for sites)<br/>
</body>
</html>
