<!DOCTYPE html>
<html>
<head>
<title>Mon Apr 6, 2020 : #open-science-ce (osg)</title>
</head>
<body>
<h3>Mon Apr 6, 2020 : #open-science-ce (osg)</h3>
<span style="color: #e96699"><span style="font-size: small">(09:39:43)</span> <b>lincoln:</b></span> in the meanwhile i'm working with ITS on the mysteries of the PTR record :slightly_smiling_face: I don't think our DNS admins set many of these :smile:<br/>
<span style="color: #43761b"><span style="font-size: small">(09:40:31)</span> <b>blin:</b></span> lol<br/>
<span style="color: #e96699"><span style="font-size: small">(09:45:31)</span> <b>lincoln:</b></span> $ nslookup 192.170.236.216<br/>216.236.170.192.in-addr.arpa    name = <a href="http://ce1.opensciencegrid.org">ce1.opensciencegrid.org</a>.<br/>
<span style="color: #e96699"><span style="font-size: small">(09:45:33)</span> <b>lincoln:</b></span> ok its done<br/>
<span style="color: #43761b"><span style="font-size: small">(09:47:18)</span> <b>blin:</b></span> wooo, that looks much better!<br/>
<span style="color: #e96699"><span style="font-size: small">(11:04:49)</span> <b>lincoln:</b></span> are the F@H jobs doing something really odd? ive just seen load shoot up like a rocket on mwt2 and ther'es a lot of system and nice time in the cpu plots :thinking_face:<br/>
<span style="color: #e96699"><span style="font-size: small">(11:05:53)</span> <b>lincoln:</b></span> <pre><br/>[root@uct2-c313 ~]# uptime<br/> 11:05:10 up 249 days, 20:00,  1 user,  load average: 149.03, 148.43, 142.47</pre><br/>
<span style="color: #235e5b"><span style="font-size: small">(11:07:22)</span> <b>dweitzel:</b></span> are the F@H jobs using more than 1 core?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:07:24)</span> <b>lincoln:</b></span> yep<br/>
<span style="color: #e96699"><span style="font-size: small">(11:07:27)</span> <b>lincoln:</b></span> they're all using ~4<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:07:29)</span> <b>dweitzel:</b></span> waht's the command line?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:07:41)</span> <b>lincoln:</b></span> <pre><br/>osg      26542  0.0  0.0  98500  9504 ?        Ss   10:43   0:00      |                   \_ condor_starter -f <a href="http://login05.osgconnect.net">login05.osgconnect.net</a><br/>osg      26862  0.0  0.0   9924  1576 ?        Ss   10:43   0:00      |                       \_ /bin/bash /var/lib/condor/execute/dir_30077/glide_WfcCPu/condor_job_wrapper.sh /var/lib/condor/execute/dir_30077/glide_WfcCPu/execute/dir_26542/condor_exec.exe<br/>osg      27361  0.0  0.0 331404  7472 ?        Sl   10:43   0:00      |                           \_ Singularity runtime parent<br/>osg      27391  0.0  0.0 200164  6344 ?        Sl   10:43   0:00      |                               \_ sinit<br/>osg      27423  0.0  0.0  11888   328 ?        S    10:43   0:00      |                                   \_ /bin/sh -x /srv/condor_exec.exe<br/>osg      27542  0.2  0.0 585400  5696 ?        Sl   10:43   0:03      |                                       \_ FAHClient --user=Anonymous --team=258507 --gpu=false --smp=false --cpus=<br/>osg      30605  0.0  0.0 100200   544 ?        SNl  10:43   0:00      |                                           \_ /usr/bin/FAHCoreWrapper /srv/cores/cores.foldingathome.org/v7/lin/64bit/avx/Core_a7.fah/FahCore_a7 -dir 00 -suffix 01 -version 705 -lifeline 71 -checkpoint 15 -np 39<br/>osg      30609  173  0.3 2613876 307436 ?      RNl  10:43  41:44      |                                               \_ /srv/cores/cores.foldingathome.org/v7/lin/64bit/avx/Core_a7.fah/FahCore_a7 -dir 00 -suffix 01 -version 705 -lifeline 80 -checkpoint 15 -np 39</pre><br/>
<span style="color: #e96699"><span style="font-size: small">(11:07:54)</span> <b>lincoln:</b></span> seem to be fluctuating between 1 and 4 cpus<br/>
<span style="color: #e96699"><span style="font-size: small">(11:07:59)</span> <b>lincoln:</b></span> just eyeballing it<br/>
<span style="color: #e96699"><span style="font-size: small">(11:08:05)</span> <b>lincoln:</b></span> some of our workers are getting unhappy and rebooting<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:08:08)</span> <b>dweitzel:</b></span> ok, that's probably my bad.<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:08:10)</span> <b>dweitzel:</b></span> removing.<br/>
<span style="color: #e96699"><span style="font-size: small">(11:08:12)</span> <b>lincoln:</b></span> rgr<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:11:34)</span> <b>dweitzel:</b></span> bash logic...<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:13:32)</span> <b>dweitzel:</b></span> started jobs back up, look a bit better?<br/>
<span style="color: #e96699"><span style="font-size: small">(11:19:03)</span> <b>lincoln:</b></span> much<br/>
<span style="color: #235e5b"><span style="font-size: small">(11:22:19)</span> <b>dweitzel:</b></span> great!<br/>
<span style="color: #43761b"><span style="font-size: small">(12:29:11)</span> <b>blin:</b></span> @rynge covid19 jobs can still run in regular OSG pilots, right?<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:31:27)</span> <b>rynge:</b></span> Yes<br/>
<span style="color: #43761b"><span style="font-size: small">(12:31:56)</span> <b>blin:</b></span> do they have higher prio in the OSG pilots?<br/>
<span style="color: #674b1b"><span style="font-size: small">(12:32:05)</span> <b>rynge:</b></span> Yes, currently 10x<br/>
<span style="color: #43761b"><span style="font-size: small">(12:32:09)</span> <b>blin:</b></span> ah, right<br/>
<span style="color: #43761b"><span style="font-size: small">(12:32:10)</span> <b>blin:</b></span> thanks<br/>
<span style="color: #43761b"><span style="font-size: small">(13:13:43)</span> <b>blin:</b></span> so if a site just accepts the OSG VO and is fine leaving up prioritization to us, they should be able to just accept the OSG VO and that should be sufficient, no?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:13:57)</span> <b>blin:</b></span> @matyas how's the pool password volume going?<br/>
<span style="color: #c386df"><span style="font-size: small">(13:14:42)</span> <b>matyas:</b></span> I'm putting together a script that will create some tokens based on the pool password on startup<br/>
<span style="color: #43761b"><span style="font-size: small">(13:17:17)</span> <b>blin:</b></span> can't we just do that all manually for now?<br/>
<span style="color: #43761b"><span style="font-size: small">(13:17:41)</span> <b>blin:</b></span> getting the token to Mats is going to have to be manual anyway<br/>
<span style="color: #c386df"><span style="font-size: small">(13:20:14)</span> <b>matyas:</b></span> it's kind of a pain right now<br/>
<span style="color: #c386df"><span style="font-size: small">(13:20:32)</span> <b>matyas:</b></span> I wish you could just point condor_token_create at a file and make a token, without installing condor<br/>
<span style="color: #c386df"><span style="font-size: small">(13:21:03)</span> <b>matyas:</b></span> I'm pretty much done with the script except for whack-a-mole with path issues<br/>
<span style="color: #e85d72"><span style="font-size: small">(13:22:10)</span> <b>cnweaver:</b></span> This was my version, although it's probably too late to help much: <a href="https://github.com/slateci/slate-catalog/blob/master/incubator/condor-manager/images/condor-manager/container-files/usr/local/bin/generate_tokens">https://github.com/slateci/slate-catalog/blob/master/incubator/condor-manager/images/condor-manager/container-files/usr/local/bin/generate_tokens</a><br/>
<span style="color: #43761b"><span style="font-size: small">(13:49:25)</span> <b>blin:</b></span> @matyas this PR should give us more consistent names when we advertise: <a href="https://github.com/slateci/slate-catalog/pull/262">https://github.com/slateci/slate-catalog/pull/262</a><br/>
<span style="color: #43761b"><span style="font-size: small">(13:51:35)</span> <b>blin:</b></span> and the CE config can be updated to this:<br/><pre>HTCondorCeConfig: |+<br/>  JOB_ROUTER_DEFAULTS @=jrd<br/>  $(JOB_ROUTER_DEFAULTS)<br/>  [<br/>    set_Requirements = HAS_SINGULARITY;<br/>    set_SingularityImage = "/cvmfs/singularity.opensciencegrid.org/opensciencegrid/osgvo-el7:latest";<br/>    eval_set_AccountingGroup = strcat("opportunustic.", ProjectName, ".", "$(FULL_HOSTNAME)");<br/>  ]<br/>  @jrd<br/><br/>  JOB_ROUTER_ENTRIES @=jre<br/>  [<br/>    Name = "COVID19_Jobs";<br/>    TargetUniverse = 5;<br/>    set_IsCOVID19 = True;<br/>    set_ProjectName = "COVID19_WeNMR";<br/>  ]<br/>  [<br/>    Name = "Non_COVID19_Jobs";<br/>    TargetUniverse = 5;<br/>    set_ProjectName = "WeNMR";<br/>  ]<br/>  @jre<br/>  <br/>  JOB_ROUTER_ROUTE_NAMES = COVID19_Jobs, Non_COVID19_Jobs</pre><br/>
<span style="color: #43761b"><span style="font-size: small">(13:56:14)</span> <b>blin:</b></span> oops, i was missing some quotes around <tt>$(FULL_HOSTNAME)</tt>. updated<br/>
<span style="color: #43761b"><span style="font-size: small">(13:57:37)</span> <b>blin:</b></span> though looking at the format of the other accounting groups, maybe we should set it to<br/><tt>group_opportunistic.&lt;PROJECT NAME&gt;.&lt;USER&gt;</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(13:58:49)</span> <b>blin:</b></span> @rynge ^^<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:00:45)</span> <b>rynge:</b></span> We talked about it last week. Either way is ok - I only care that "COVID19" is in there somewhere<br/>
<span style="color: #43761b"><span style="font-size: small">(14:01:42)</span> <b>blin:</b></span> and the suffix after the <tt>@</tt> is constant, right?<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:02:26)</span> <b>rynge:</b></span> <tt>@</tt>?<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:03:06)</span> <b>rynge:</b></span> Ah yeah, you don't need to specify that part<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:03:15)</span> <b>rynge:</b></span> I think it is UID_DOMAIN, but doesn't matter<br/>
<span style="color: #43761b"><span style="font-size: small">(14:03:44)</span> <b>blin:</b></span> ah ok<br/>
<span style="color: #43761b"><span style="font-size: small">(14:03:52)</span> <b>blin:</b></span> but you wanted a consistent <tt>Machine</tt> name, right?<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:04:16)</span> <b>rynge:</b></span> We have all kinds of variations from our flocking hosts :wink:<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:04:17)</span> <b>rynge:</b></span> <a href="http://flock.opensciencegrid.org/overview/priorities.php">http://flock.opensciencegrid.org/overview/priorities.php</a><br/>
<span style="color: #43761b"><span style="font-size: small">(14:04:23)</span> <b>blin:</b></span> like<br/><pre>$ condor_status -submitter -pool <a href="http://flock.opensciencegrid.org">flock.opensciencegrid.org</a> | head<br/>Name                                                                                      Machine                              RunningJobs   IdleJobs   HeldJobs<br/><br/>analysis.bmaier@cms                                                                       <a href="http://SUBMIT.MIT.EDU">SUBMIT.MIT.EDU</a>                               123      14922        344<br/><a href="mailto:condor@cyverse.org">condor@cyverse.org</a>                                                                        <a href="http://akbul.cyverse.org">akbul.cyverse.org</a>                              0          0          0<br/><a href="mailto:mian@cyverse.org">mian@cyverse.org</a>                                                                          <a href="http://akbul.cyverse.org">akbul.cyverse.org</a>                              0          1          0<br/><a href="mailto:de.hahafengxiang@cyverse.org">de.hahafengxiang@cyverse.org</a>                                                              <a href="http://aragon.cyverse.org">aragon.cyverse.org</a>                             0          0          0<br/><a href="mailto:de.kpalos@cyverse.org">de.kpalos@cyverse.org</a>                                                                     <a href="http://aragon.cyverse.org">aragon.cyverse.org</a>                             0          0          0<br/><a href="mailto:de.smoenga55@cyverse.org">de.smoenga55@cyverse.org</a>                                                                  <a href="http://aragon.cyverse.org">aragon.cyverse.org</a>                             0          0          0<br/><a href="mailto:de.yazhou_jic@cyverse.org">de.yazhou_jic@cyverse.org</a>                                                                 <a href="http://aragon.cyverse.org">aragon.cyverse.org</a>                             0          0          0<br/><a href="mailto:daues@descmp3.cosmology.illinois.edu">daues@descmp3.cosmology.illinois.edu</a>                                                      <a href="http://descmp3.cosmology.illinois.edu">descmp3.cosmology.illinois.edu</a>                 0          1          0</pre><br/>
<span style="color: #43761b"><span style="font-size: small">(14:05:04)</span> <b>blin:</b></span> you mentioned glideinwms caring about the instance name or whatever<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:05:10)</span> <b>rynge:</b></span> We just want it to be unique per user so fairshare works, and contain "COVID19" so we can up the priorities automatically<br/>
<span style="color: #43761b"><span style="font-size: small">(14:05:50)</span> <b>blin:</b></span> ah this is what i was talking about: <a href="https://opensciencegrid.slack.com/archives/C010S0M3CSE/p1585956574341100">https://opensciencegrid.slack.com/archives/C010S0M3CSE/p1585956574341100</a><br/>
<span style="color: #674b1b"><span style="font-size: small">(14:06:20)</span> <b>rynge:</b></span> Ah<br/>
<span style="color: #43761b"><span style="font-size: small">(14:07:16)</span> <b>blin:</b></span> ok regardless, the <tt>@suffix</tt>  and schedd name should all be <tt><a href="http://ce1.opensciencegrid.org">ce1.opensciencegrid.org</a></tt>  from now on<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:07:28)</span> <b>rynge:</b></span> Great<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:07:44)</span> <b>rynge:</b></span> So the schedd name is not important when it comes to the accting groups<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:07:51)</span> <b>rynge:</b></span> But it is important in the gwms fe context<br/>
<span style="color: #674b1b"><span style="font-size: small">(14:08:56)</span> <b>rynge:</b></span> We want it to register with a consistent name. GWMS will configured to query it (a more complex version of <tt>condor_q -name [registered-name]</tt><br/>
<span style="color: #43761b"><span style="font-size: small">(14:10:04)</span> <b>blin:</b></span> ok, duly noted<br/>
<span style="color: #c386df"><span style="font-size: small">(16:34:45)</span> <b>matyas:</b></span> Looks like we got the frankenpod working - it's running on River via SLATE and condor_ce_trace reported success.<br/>
<span style="color: #c386df"><span style="font-size: small">(16:35:08)</span> <b>matyas:</b></span> It's 4:30; what's next?<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:43:31)</span> <b>rynge:</b></span> Beers?<br/>
<span style="color: #c386df"><span style="font-size: small">(16:46:35)</span> <b>matyas:</b></span> :thumbsup::skin-tone-2:<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:55:37)</span> <b>rynge:</b></span> I would eventually like to hear what WeNMR thinks about the environment, and maybe adjust requirements/images/...<br/>
<span style="color: #c386df"><span style="font-size: small">(16:57:55)</span> <b>matyas:</b></span> yeah, Edgar said that we should create a singularity image for WeNMR even if it's just a clone of the default el7 one, because they will ask for more stuff<br/>
<span style="color: #674b1b"><span style="font-size: small">(16:59:55)</span> <b>rynge:</b></span> Ok, cool<br/>
</body>
</html>
